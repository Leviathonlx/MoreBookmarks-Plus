window = {
	name = "government_administration_window"
	widgetid = "government_administration_window"
	parentanchor = top|right
	layer = windows_layer
	movable = no
	allow_outside = yes

	visible = "[And( IsGameViewOpen('government_administration'), IsDefaultGUIMode )]"

	using = Window_Size_MainTab

	datacontext = "[GovernmentAdministrationWindow.GetMeritPoolCharacterWindow]"
	datacontext = "[GovernmentAdministrationWindow.GetTitle]"
	datacontext = "[Title.GetHolder]"

	oncreate = "[BindTabsContext]"
	oncreate = "[PdxGuiTabs.ListenFor( 'administration_tabs' )]"

	state = {
		name = _show
		using = Animation_FadeIn_Quick
		using = Sound_WindowShow_Standard
		using = Window_Position_MainTab
		using = Expand_Admin_Themes
		on_start = "[SetMapMode( 'admin_vassal_types_map' )]"

		on_start = "[PdxGuiTabs.RemoveTab( 'family' )]"
		on_start = "[PdxGuiTabs.AddTabIf( 'family', GetPlayer.GetGovernment.HasRule( 'administrative' ) )]"  # Referenced in Code, don't rename`

		on_start = "[PdxGuiTabs.RemoveTab( 'families' )]"
		on_start = "[PdxGuiTabs.AddTab( 'families' )]"

		on_start = "[PdxGuiTabs.RemoveTab( 'themes' )]"
		on_start = "[PdxGuiTabs.AddTabIf( 'themes', Character.GetGovernment.HasRule( 'administrative' ) )]"

		on_start = "[GetVariableSystem.Clear( 'show_prominent_appointment' )]"
	}

	state = {
		name = _hide
		using = Animation_FadeOut_Quick
		using = Sound_WindowHide_Standard
		using = Window_Position_MainTab_Hide
		on_start = "[SetMapMode( 'realms' )]"
		on_start = "[MeritPoolWindow.Close]"
	}

	margin_widget = {
		size = { 100% 100% }
		margin_top = 30
		margin_bottom = 12
		margin_right = 13

		widget = {
			size = { 100% 100% }
			
			vbox = {
				using = Window_Margins

				header_pattern = {
					layoutpolicy_horizontal = expanding

					blockoverride "header_text"
					{
						text = "ADMINISTRATIVE_GOVERNMENT_HEADER"
					}

					blockoverride "button_close"
					{
						onclick = "[GovernmentAdministrationWindow.Close]"
					}
				}

				hbox_tab_buttons = {
					name = "administration_tabs"

					blockoverride "tab_name"
					{
						text = "[PdxGuiTabItem.LocalizeTab( 'administraction_tab' )]"
					}

					blockoverride "on_click"
					{
						onclick = "[CloseGameView( 'admin_vassal_detail_view' )]"
						onclick = "[GetVariableSystem.Clear( 'show_prominent_appointment' )]"
					}
				}

				vbox = {
					name = "your_family"
					widgetid = "your_family"
					datacontext = "[GovernmentAdministrationWindow.GetPlayerHouse]"
					visible = "[PdxGuiTabs.IsTabSet( 'family' )]"
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding

					margin_top = 10
					margin_bottom = 15

					vbox_your_family_tab = {
						visible = "[Not( GetVariableSystem.Exists( 'show_prominent_appointment' ) )]"
					}

					widget_your_family_appointments = {
						visible = "[GetVariableSystem.Exists( 'show_prominent_appointment' )]"
					}
				}

				vbox = {
					name = "themes"
					visible = "[PdxGuiTabs.IsTabSet( 'themes' )]"
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding

					margin_top = 10
					margin_bottom = 15

					state = {
						name = _show
						on_start = "[SetMapMode( 'admin_vassal_types_map' )]"
					}

					state = {
						name = _hide
						on_start = "[SetMapMode( 'realms' )]"
					}

					widget_header_state_faith = {}

					hbox_theme_sort_options = {
						blockoverride "dropdown_properties"
						{
							datamodel = "[GovernmentAdministrationWindow.GetOrderOptions]"
							onselectionchanged = "[GovernmentAdministrationWindow.SortThemes]"
							selectedindex = "[GovernmentAdministrationWindow.GetSortSelectedIndex]"
						}

						button_checkbox_label = {
							onclick = "[GovernmentAdministrationWindow.ToggleGroupByHouse]"
							blockoverride "checkbox"
							{
								checked = "[GovernmentAdministrationWindow.ShouldGroupByHouse]"
							}

							blockoverride "text"
							{
								text = "ADMIN_WINDOW_THEME_GROUP_BY_HOUSE"
							}
						}
					}

					scrollbox = {
						name = "admin_panel_province_list" # tutorial uses this
						widgetid = "admin_panel_province_list" # tutorial uses this

						size = { 560 0 }
						layoutpolicy_vertical = expanding

						blockoverride "scrollbox_content"
						{
							vbox_themes_list = {
								name = "themes_list"
								layoutpolicy_horizontal = expanding
								layoutpolicy_vertical = expanding
							}
						}
					}
				}

				vbox = {
					name = "powerful_families"
					widgetid = "powerful_families"
					visible = "[PdxGuiTabs.IsTabSet( 'families' )]"
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding

					margin_top = 5
					margin_bottom = 15

					### Top Liege
					widget = {
						size = { 560 140 }

						hbox = {
							datacontext = "[GetIllustration( 'character_view_bg' )]"
							spacing = 4
							margin = { 8 0 }

							background = {
								texture = "[Illustration.GetTexture( Character.MakeScope )]"
								alpha = 0.3
								fittype = centercrop
								margin = { 10 0 }

								using = Mask_Rough_Edges

								modify_texture = {
									texture = "gfx/interface/component_masks/mask_fade_vertical.dds"
									blend_mode = alphamultiply
									mirror = vertical
								}
							}

							vbox_featured_family_portrait_big = {
								name = "government_panel_figurehead_family" #reactive_advice_welcome_to_japan_step_emperor_and_regent uses this
								datacontext = "[GovernmentAdministrationWindow.GetFigureheadTitle]"
								datacontext = "[GovernmentAdministrationWindow.GetFigureheadTitle.GetHolder]"
								visible = "[Title.IsValid]"

								background = {
									using = Background_Area_Dark
									alpha = 0.5

									margin = { 4 4 }
								}

								blockoverride "interactions_on_click"
								{
									onclick = "[ToggleFilteredCharacterInteractionMenu(Character.Self, 'ceremonial_liege')]"

									tooltip = "ADMIN_GOVERNMENT_CEREMONIAL_LIEGE_INTERACTIONS_BUTTON_TOOLTIP"
									tooltip_visible = "[Not(IsInteractionMenuOpenForCharacterWithFilter(Character.Self, 'ceremonial_liege'))]"
								}

								blockoverride "interaction_number_text"
								{
									text = "[GetNumberOfValidInteractionsWithFilter(Character.Self, 'ceremonial_liege')]"
								}

								blockoverride "subtitle"
								{
									text = "[GetPlayer.Custom('GetCeremonialLiegeOrLiegeTitle')]"
								}
							}

							vbox_featured_family_portrait_big = {
								name = "government_panel_defacto_ruling_family" #reactive_advice_welcome_to_japan_step_emperor_and_regent uses this
								datacontext = "[GovernmentAdministrationWindow.GetTitle]"
								datacontext = "[Title.GetHolder]"

								blockoverride "interactions_on_click"
								{
									onclick = "[ToggleFilteredCharacterInteractionMenu(Character.Self, 'admin_liege')]"

									tooltip = "ADMIN_GOVERNMENT_LIEGE_INTERACTIONS_BUTTON_TOOLTIP"
									tooltip_visible = "[Not(IsInteractionMenuOpenForCharacterWithFilter(Character.Self, 'admin_liege'))]"
								}

								blockoverride "interaction_number_text"
								{
									text = "[GetNumberOfValidInteractionsWithFilter(Character.Self, 'admin_liege')]"
								}

								blockoverride "subtitle"
								{
									text = "[GetPlayer.GetTopLiege.Custom('GetImperialFamilyType')]"
								}
							}

							expand = {}
						}
					}


					scrollbox = {
						size = { 560 0 }
						layoutpolicy_vertical = expanding

						blockoverride "scrollbox_content"
						{
							layoutpolicy_horizontal = expanding
							layoutpolicy_vertical = expanding

							vbox = {
								name = "family_groups_container"

								margin = { 0 4 }

								layoutpolicy_horizontal = expanding

								datamodel = "[GovernmentAdministrationWindow.GetFamilyGroups]"

								item = {
									vbox_family_group_foldout = {}
								}
							}
						}
					}
				}
			}
		}
	}

	window_merit_pool_characters = {
		datacontext = "[GovernmentAdministrationWindow.GetMeritPoolCharacterList]"
		datacontext = "[GovernmentAdministrationWindow.GetSelectedAdminMeritPool]"
		visible = "[MeritPoolWindow.IsVisible]"
	}
}

types GovernmentAdministrationThemes
{
	type widget_empty_governor_portrait = widget
	{
		background = {
			using = Background_Area_Solid

			modify_texture = {
				texture = "gfx/interface/component_masks/mask_fade_vertical.dds"
				blend_mode = alphamultiply
				alpha = 0.2
				mirror = vertical
			}
		}

		widget = {
			size = { 100% 100% }

			background = {
				texture = "gfx/portraits/portrait_frame.dds"
				using = Color_Grey
				margin = { -4 -4 }
				alpha = 0.5
			}
		}

		button = {
			size = { 100% 100% }
			using = Placeholder_Inactive_Button	

			state = {
				name = _mouse_hierarchy_enter
				on_start = "[PdxGuiWidget.FindChild('highlight_frame').TriggerAnimation('show')]"
			}

			state = {
				name = _mouse_hierarchy_leave
				on_start = "[PdxGuiWidget.FindChild('highlight_frame').TriggerAnimation('hide')]"
			}

			highlight_icon = {
				name = "portrait_unknown_head_small_glow"
				parentanchor = center
				position = { 3 -9 }
				gfxtype = framedbuttongfx
				effectname = "NoHighlight"
				texture = "gfx/portraits/unknown_portraits/button_unknown_head.dds"
				size = { 80 100 }
				framesize = { 384 480 }
				upframe = 1
				overframe = 2
			}

			button_plus = {
				alwaystransparent = yes
				parentanchor = center
			}

			widget = {
				name = "highlight_frame"
				size = { 100% 100% }
				alwaystransparent = yes
				alpha = 0

				state = {
					name = "show"
					alpha = 1
				}

				state = {
					name = "hide"
					alpha = 0
				}

				background = {
					size = { 100% 100% }
					texture = "gfx/portraits/portrait_frame.dds"
					using = Color_Grey
					alpha = 0.7
					margin = { -4 -4 }
				}
			}
		}
	}

	type button_unassigned_county_item = button_standard_list
	{
		layoutpolicy_horizontal = expanding

		button_ignore = none

		raw_tooltip = "#X Not yet implemented button.#!"
		default_format = "#X"

		background = {
			using = Background_Area_Border
			using = Background_Frame_Gold
		}

		hbox = {
			position = { 0 -5 }
			margin = { 8 0 }

			coa_title_tiny_crown = { }

			text_single = {
				layoutpolicy_horizontal = expanding

				text = "[Title.GetNameNoTooltip]"
			}

			expand = { }

			button_plus = { }
		}
	}

	type vbox_house_theme_list = vbox
	{
		layoutpolicy_vertical = expanding
		layoutpolicy_horizontal = expanding
		spacing = 5

		oncreate = "[BindFoldOutContext]"
		oncreate = "[PdxGuiFoldOut.Unfold]"

		hbox = {
			layoutpolicy_horizontal = expanding

			coa_house_tiny = {
				visible = "[And(DynastyHouse.IsValid, GovernmentAdministrationWindow.ShouldGroupByHouse)]"
			}

			button_expandable_toggle_field = {
				layoutpolicy_horizontal = expanding
				datacontext = "[AdministrativeHouseItem.GetHouse]"

				blockoverride "onclick"
				{
					onclick = "[GetVariableSystem.Toggle( AdministrativeHouseItem.GetGroupTitle )]"
				}

				blockoverride "button_expand"
				{
					frame = "[BoolTo1And2( Not( GetVariableSystem.Exists( AdministrativeHouseItem.GetGroupTitle )  ) )]"
				}

				blockoverride "text"
				{
					text = "[AdministrativeHouseItem.GetGroupTitle]"
				}
			}
		}

		fixedgridbox = {
			name = "assigned_themes_list"
			visible = "[Not( GetVariableSystem.Exists( AdministrativeHouseItem.GetGroupTitle ) )]"
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding

			addcolumn = 525
			addrow = 95

			datamodel = "[AdministrativeHouseItem.GetControlledThemes]"

			item = {
				widget_theme_row_item = {
					datacontext = "[AdministrativeTitleItem.GetTitle]"
					visible = "[AdministrativeTitleItem.ShouldShowTitle]"
				}
			}
		}
	}

	type widget_theme_item_small_no_buttons = widget
	{
		block "outer_size"
		{
			size = { 80 80 }
		}
		allow_outside = yes

		widget = {
			parentanchor = center
			block "inner_size"
			{
				size = { 80 80 }
			}

			icon = {
				name = "crown"
				parentanchor = top|hcenter
				widgetanchor = bottom|hcenter
				position = { 0 2 }

				size = { 64% 40% }

				texture = "gfx/interface/coat_of_arms/crown_strip_115.dds"
				frame = "[Title.GetTierFrame]"
				framesize = { 128 80 }

			}

			icon = {
				size = { 100% 100% }
				texture = "gfx/interface/window_theme_administration/admin_theme_coa_title.dds"
			}

			icon = {
				size = { 100% 100% }
				parentanchor = top|hcenter
				texture = "gfx/interface/window_theme_administration/admin_theme_coa_title.dds"
			}

			coat_of_arms_icon = {
				parentanchor = top|hcenter
				size = { 100% 100% }
				coat_of_arms = "[Title.GetTitleCoA.GetTexture('(int32)256','(int32)256')]"
				coat_of_arms_slot = "[Title.GetTitleCoA.GetSlot('(int32)256','(int32)256')]"
				coat_of_arms_mask = "gfx/interface/window_theme_administration/admin_theme_mask.dds"

				modify_texture = {
					texture = "gfx/interface/coat_of_arms/coa_overlay.dds"
					blend_mode = overlay
					spritetype = corneredTiled
				}

				modify_texture = {
					texture = "gfx/interface/colors/black.dds"
					blend_mode = normal
					alpha = 1

					visible = "[Not(Title.GetHolder.IsValid)]"
				}
			}

			icon = {
				parentanchor = top
				size = { 100% 10 }
				texture = "gfx/interface/window_theme_administration/admin_theme_coa_header.dds"
			}
		}
	}

	type widget_theme_item_small = widget
	{
		block "outer_size"
		{
			size = { 80 80 }
		}
		allow_outside = yes

		state = {
			name = _mouse_hierarchy_enter
			on_start = "[PdxGuiWidget.FindChild('theme_glow').TriggerAnimation('appear')]"
		}

		state = {
			name = _mouse_hierarchy_leave
			on_start = "[PdxGuiWidget.FindChild('theme_glow').TriggerAnimation('disappear')]"
		}

		tooltip = "ADMIN_WINDOW_THEME_ADMINISTRATION_THEME_TT"
		using = tooltip_ne

		button = {
			name = "open_detail_button"
			visible = "[And(Not( GetVariableSystem.Exists( 'admin_vassal_details_refresh' ) ), IsAdministrativeRuler(Title.GetHolder))]"
			size = { 100% 100% }

			block "theme_item_onclick"
			{
				onclick = "[GetVariableSystem.Clear( 'AdminVassalDetailAppointment' )]"
				onclick = "[ToggleAdminVassalDetailView( Title.Self )]"
				down = "[IsAdminVassalDetailViewShown( Title.Self )]"
			}
		}

		button = {
			name = "refresh_detail_button"
			visible = "[And(GetVariableSystem.Exists( 'admin_vassal_details_refresh' ),IsAdministrativeRuler(Title.GetHolder))]"
			size = { 100% 100% }

			onclick = "[PdxGuiTriggerAllAnimations('admin_vassal_details_refresh')]"
			down = "[IsAdminVassalDetailViewShown( Title.Self )]"

			state = {
				name = _mouse_click
				delay = 0.2
				on_finish = "[ToggleAdminVassalDetailView( Title.Self )]"
			}
		}

		button = {
			visible = "[Or( Not(Title.GetHolder.IsValid), And( And( Not( IsAdministrativeRuler( Title.GetHolder )), Not(Title.GetHolder.IsPlayerInteractionValid('demand_admin_interaction'))), Title.GetHolder.GetLiege.IsPlayer  ) ) ]"
			size = { 100% 100% }
			onclick = "[DefaultOnCoatOfArmsClick(Title.GetID)]"
		}

		### Makes a yellow border around your coa, should we have this? ###

		#background = {
		#visible = "[Title.GetHolder.IsPlayer]"
		#using = Background_Area_Border
		#using = Background_Frame_Gold
		#}

		widget = {
			size = { 162 162}
			parentanchor = center

			block "inner_size"
			{
				size = { 80 80 }
			}

			block "crown" {
				icon = {
					name = "crown"
					parentanchor = top|hcenter
					widgetanchor = bottom|hcenter
					position = { 0 -2 }

					allow_outside = yes

					size = { 80% 56% }

					texture = "gfx/interface/coat_of_arms/crown_strip_115.dds"
					frame = "[Title.GetTierFrame]"
					framesize = { 128 80 }
				}
			}

			icon = {
				size = { 100% 100% }
				parentanchor = top|hcenter
				texture = "gfx/interface/window_theme_administration/admin_theme_coa_title.dds"
			}

			coat_of_arms_icon = { #Dynasty
				parentanchor = top|hcenter
				size = { 100% 100% }
				coat_of_arms = "[Title.GetTitleCoA.GetTexture('(int32)256','(int32)256')]"
				coat_of_arms_slot = "[Title.GetTitleCoA.GetSlot('(int32)256','(int32)256')]"
				coat_of_arms_mask = "gfx/interface/window_theme_administration/admin_theme_mask.dds"

				modify_texture = {
					texture = "gfx/interface/coat_of_arms/coa_overlay.dds"
					blend_mode = overlay
					spritetype = corneredTiled
				}

				modify_texture = {
					texture = "gfx/interface/component_masks/mask_glow.dds"
					blend_mode = alphaMultiply
					alpha = 0.6
				}

				modify_texture = {
					texture = "gfx/interface/colors/black.dds"
					blend_mode = normal
					alpha = 0.5

					visible = "[Not(Title.GetHolder.IsValid)]"
				}
			}

			icon = {
				name = "theme_glow"
				parentanchor = top|hcenter
				size = { 100% 100% }
				texture = "gfx/interface/window_theme_administration/admin_theme_glow.dds"
				alpha = 0

				state = {
					name = appear
					using = Animation_Curve_Default
					duration = 0.2
					position = { 0 0 }
					alpha = 0.7
					scale = 1.01
				}

				state = {
					name = disappear
					using = Animation_Curve_Default
					duration = 0.2
					position = { 0 0 }
					alpha = 0
					scale = 0.97
				}
			}

			icon = {
				parentanchor = top|hcenter
				size = { 100% 10 }
				position = { 0 -4}
				texture = "gfx/interface/window_theme_administration/admin_theme_coa_header.dds"
			}
		}

	}

	type button_theme_row_admin = button_standard {
		datacontext = "[AdministrativeTitleItem.GetPrimaryContractAndObligationItem]"
		datacontext = "[PrimaryContractAndObligation.GetObligationLevel]"
		size = { 476 90 }

		block "on_click" {}

		vbox = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
			allow_outside = yes

			margin_left = 70
			margin_bottom = 8

			# Non-Admin item
			widget = {
				visible = "[Not( IsAdministrativeRuler( Title.GetHolder ) )]"

				size = { 0 38 }
				layoutpolicy_horizontal = expanding
				allow_outside = yes

				highlight_icon = {
					size = { 384 36 }
					position = { -68 2 }
					mirror = horizontal

					texture = "gfx/interface/window_military/military_banner_blue.dds"
				}

				hbox = {
					parentanchor = left|vcenter
					layoutpolicy_horizontal = expanding
					margin = { 15 0 }
					spacing = 10

					# Name of non-theme
					text_single = {
						text = "ADMIN_WINDOW_THEME_NAME"
						align = nobaseline
						max_width = 350
						using = Font_Size_Medium
					}

					# Non-Admin Tag
					text_single = {
						margin_right = 10

						text = "ADMIN_WINDOW_VASSAL_GOVERNMENT_TYPE"
						align = nobaseline
					}

					expand = {}
				}
			}

			# Admin item
			widget = {
				visible = "[IsAdministrativeRuler( Title.GetHolder )]"
				datacontext = "[AdministrativeTitleItem.GetPrimaryContractAndObligationItem]"
				datacontext = "[PrimaryContractAndObligation.GetObligationLevel]"

				size = { 0 38 }
				layoutpolicy_horizontal = expanding
				allow_outside = yes

				icon = {
					size = { 384 36 }
					position = { -68 2 }
					using = Background_Obligation_Banner_Right
				}

				hbox = {
					parentanchor = left|vcenter
					layoutpolicy_horizontal = expanding
					margin = { 10 0 }
					spacing = 5

					# Admin Icon
					text_single = {
						text = "ADMIN_WINDOW_THEME_ADMINISTRATION_TYPE_TEXT_ICON"
						align = nobaseline
					}

					# Name of theme
					text_single = {
						text = "ADMIN_WINDOW_THEME_NAME"
						align = nobaseline
						max_width = 350
						using = Font_Size_Medium
					}

					expand = {}
				}
			}

			hbox = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding

				hbox = {
					margin_left = 10
					spacing = 10

					text_single = {
						datacontext = "[Title.GetHolder]"

						text = "ADMIN_WINDOW_THEME_GOVERNOR_EFFICIENCY"
						align = nobaseline
						default_format = "#low"
						max_width = 80

						tooltip = "ADMIN_WINDOW_THEME_GOVERNOR_EFFICIENCY_TT"
					}

					text_single = {
						text = "ADMIN_WINDOW_THEME_TAXES"
						align = nobaseline
						max_width = 80
					}

					text_single = {
						text = "ADMIN_WINDOW_THEME_LEVIES"
						align = nobaseline
						max_width = 80
					}

					expand = {}
				}

				hbox = {
					datacontext = "[Title.GetHolder]"
					visible = "[And( IsAdministrativeRuler( Title.GetHolder ), DataModelHasItems( AdministrativeTitleItem.GetRegiments ) )]"

					spacing = 5

					icon_soldiers = {
						size = { 25 25 }
					}

					text_single = {
						text = "ADMIN_WINDOW_THEME_TITLE_TROOPS"
						align = nobaseline
					}
				}

				expand = {}
			}
		}

		widget_theme_item_small = {
			parentanchor = vcenter
			position = { 8 6 }

			tooltip_when_disabled = "ADMIN_WINDOW_NON_ADMIN_THEME_FAIL_DEMAND_INTERACTION"
			using = tooltip_ws

			blockoverride "crown" {
				icon = {
					name = "crown"
					parentanchor = top|hcenter
					widgetanchor = bottom|hcenter
					position = { 0 -2 }

					allow_outside = yes

					size = { 60% 42% }

					texture = "gfx/interface/coat_of_arms/crown_strip_115.dds"
					frame = "[Title.GetTierFrame]"
					framesize = { 128 80 }
				}
			}

			blockoverride "outer_size"
			{
				position = { -2 20 }
				size = { 68 68 }
			}

			blockoverride "inner_size"
			{
				size = { 68 68 }
			}
		}
	}

	type widget_theme_row_item = widget
	{
		size = { 525 90 }

		button_theme_row_admin = {
			visible = "[IsAdministrativeRuler( Title.GetHolder )]"

			blockoverride "on_click"
			{
				onclick = "[CloseGameView('character_interaction_confirmation')]"
				onclick = "[GetVariableSystem.Clear( 'AdminVassalDetailAppointment' )]"
				onclick = "[ClearAdminVassalDetailCandidate]"
				onclick = "[ToggleAdminVassalDetailView( Title.Self )]"
				down = "[IsAdminVassalDetailViewShown( Title.Self )]"

				tooltip = "ADMIN_WINDOW_THEME_ADMINISTRATION_THEME_TT"
				using = tooltip_ne
			}
		}

		button_theme_row_admin = {
			datacontext = "[Title.GetHolder]"
			visible = "[Not( IsAdministrativeRuler( Character ) )]"

			blockoverride "on_click"
			{
				enabled = "[And( And( And( Not( IsAdministrativeRuler( Character ) ), Character.IsValid ), Character.GetLiege.IsPlayer ), Character.IsPlayerInteractionValid('demand_admin_interaction') )]"
				onclick = "[CloseGameView('admin_vassal_detail_view')]"
				onclick = "[Character.OpenPlayerInteraction('demand_admin_interaction')]"

				tooltip = "[Character.GetPlayerInteractionTooltip('demand_admin_interaction')]"
			}
		}

		widget = {
			datacontext = "[Title.GetHolder]"
			parentanchor = vcenter|right
			position = { 4 0 }
			size = { 48 90 }

			background = {
				using = Background_Area_Dark
				margin = { 3 2 }
			}

			vbox = {
				layoutpolicy_vertical = expanding

				coa_house_tiny = {
					datacontext = "[Character.GetHouse]"
				}

				widget = {
					visible = "[Character.IsPlayerInteractionShown('give_vassal_directive_interaction')]"
					size = { 40 40 }

					text_single = {
						parentanchor = hcenter
						position = { -1 -2 }
						text = "[Character.Custom('vassal_directive_icon')]"
						align = nobaseline
						using = Font_Size_Medium

						tooltip = "VASSAL_DIRECTIVE_ICON_TOOLTIP"
						using = tooltip_se
					}

					button_round = {
						parentanchor = bottom|right
						position = { 1 0 }
						size = { 22 22 }

						enabled = "[Character.IsPlayerInteractionValid('give_vassal_directive_interaction')]"
						onclick = "[Character.OpenPlayerInteraction('give_vassal_directive_interaction')]"

						tooltip = "[Character.GetPlayerInteractionTooltip('give_vassal_directive_interaction')]"
						using = tooltip_se

						button_give_directive = {
							alwaystransparent = yes
							parentanchor = center
							size = { 18 18 }
						}
					}
				}

				expand = {}
			}
		}
	}

	type hbox_theme_contract_obligation_result = hbox
	{
		layoutpolicy_horizontal = expanding
		spacing = 8

		text_single = {
			text = ADMIN_WINDOW_THEME_ADMINISTRATION_LEVIES
		}

		text_single = {
			text = ADMIN_WINDOW_THEME_ADMINISTRATION_TAXES
		}
	}

	type button_modify_theme = button_round {
		visible = "[Character.IsPlayerInteractionShown('admin_liege_modify_vassal_contract_interaction')]"
		enabled = "[Character.IsPlayerInteractionValid('admin_liege_modify_vassal_contract_interaction')]"

		onclick = "[Character.OpenPlayerInteraction('admin_liege_modify_vassal_contract_interaction')]"
		onclick = "[Character.PanCameraTo]"

		tooltip = "[Character.GetPlayerInteractionTooltip('admin_liege_modify_vassal_contract_interaction')]"

		block "feudal_contract_button_round" {}

		button_add_laws = {
			alwaystransparent = yes
			parentanchor = center
		}
	}

	type button_replace_governor = button_round {
		using = Placeholder_Inactive_Button

		tooltip = "REPLACE_GOVERNOR_TOOLTIP"

		button_change = {
			parentanchor = center
		}
	}

	type button_revoke_theme = button_round {
		enabled = "[Character.IsPlayerInteractionValid('revoke_title_interaction')]"

		onclick = "[Character.OpenPlayerInteraction('revoke_title_interaction')]"
		onclick = "[Character.PanCameraTo]"

		tooltip = "[Character.GetPlayerInteractionTooltip('revoke_title_interaction')]"

		button_cancel = {
			alwaystransparent = yes
			parentanchor = center
		}
	}

	type vbox_themes_list = vbox
	{
		layoutpolicy_horizontal = expanding
		layoutpolicy_vertical = expanding

		using = Animation_Tab_Switch

		vbox = {
			name = "house_list"
			datamodel = "[GovernmentAdministrationWindow.GetHousesWithThemes]"

			layoutpolicy_horizontal = expanding

			item = {
				vbox_house_theme_list = {
					datacontext = "[AdministrativeHouseItem.GetHouse]"
					layoutpolicy_horizontal = expanding
				}
			}
		}

		expand = { }
	}
}

types GovernmentAdministration
{
	type vbox_merit_examinations = vbox {
		
		
	}

	type widget_title_troop_icon = widget {
		visible = "[Not( HiredTroopRegiment.IsLevies )]"
		size = { 26 26 }
		parentanchor = center

		widget = {
			datacontext = "[HiredTroopRegiment.GetRegiment]"
			size = { 100% 100% }

			tooltipwidget = regiment_container_tooltip
			using = tooltip_se
		}

		icon = {
			size = { 26 26 }
			texture = "[HiredTroopRegiment.GetMenAtArmsType.GetIcon]"
		}
	}

	type widget_header_state_faith = widget {
		datacontext = "[Title.GetStateFaith]"
		visible = "[GetPlayer.GetGovernment.HasRule( 'state_faith' )]"
		size = { 562 50 }

		hbox = {
			layoutpolicy_horizontal = expanding
			margin = { 16 0 }
			margin_bottom = 10
			spacing = 10

			text_single = {
				text = "[state_faith|E]"
				align = nobaseline
			}

			button_standard = {
				layoutpolicy_horizontal = expanding
				minimumsize = { 200 33 }

				onclick = "[ToggleGameViewData( 'faith', Faith.GetID )]"

				hbox = {
					layoutpolicy_horizontal = expanding

					icon = {
						size = { 30 30 }
						texture = "[Title.GetStateFaith.GetIcon]"
					}

					text_single = {
						text = "[Faith.GetNameNoTooltip]"
						align = nobaseline
					}

					expand = {}
				}
			}

			hbox = {
				button_round = {
					datacontext = "[GetDecisionWithKey('change_state_faith')]"
					visible = "[Decision.IsShownForPlayer]"
					size = { 30 30 }

					onclick = "[OpenGameViewData( 'decision_detail', Decision.Self )]"
					tooltip = "[Decision.GetShortDescForPlayer]"
					using = tooltip_ne

					button_change = {
						parentanchor = center
						alwaystransparent = yes
						size = { 20 20 }
					}
				}

				button_round = {
					datacontext = "[GetDecisionWithKey('adopt_state_faith')]"
					visible = "[Decision.IsShownForPlayer]"
					size = { 30 30 }

					onclick = "[OpenGameViewData( 'decision_detail', Decision.Self )]"
					tooltip = "[Decision.GetShortDescForPlayer]"
					using = tooltip_ne

					button_plus = {
						size = { 20 20 }
						parentanchor = center
						alwaystransparent = yes
					}
				}
			}

			divider_light = {
				layoutpolicy_vertical = expanding
			}

			text_single = {
				text = "[GovernmentAdministrationWindow.GetCountiesOfStateFaith]"
				align = nobaseline
			}
		}
	}

	type widget_prominent_theme_banner = widget {
		allow_outside = yes
		layoutpolicy_horizontal = expanding
		size = { 0 34 }

		# Banner Status available
		block "background_banner"
		{
			highlight_icon = {
				position = { -2 2 }
				size = { 100% 100% }
				mirror = horizontal

				texture = "gfx/interface/window_military/military_banner_blue.dds"
			}
		}

		# Name of theme
		text_single = {
			parentanchor = left|vcenter

			text = "ADMIN_WINDOW_THEME_NAME"
			align = nobaseline
			max_width = 330
			using = Font_Size_Medium

			block "text_margin" {}
		}

		hbox = {
			block "taxes_and_levies_visiblity" {}
			layoutpolicy_horizontal = expanding
			parentanchor = right|vcenter
			margin_right = 8
			spacing = 10

			expand = {}

			text_single = {
				min_width = 52

				text = "ADMIN_WINDOW_FIND_APPOINTMENT_TAXES"
				align = nobaseline
			}

			text_single = {
				min_width = 52

				text = "ADMIN_WINDOW_FIND_APPOINTMENT_LEVIES"
				align = nobaseline
			}
		}
	}

	type widget_prominent_theme_item = widget {
		size = { 525 82 }

		button_standard = {
			size = { 525 82 }

			block "on_click" {}

			tooltip = "ADMIN_WINDOW_THEME_ADMINISTRATION_THEME_TT"
			using = tooltip_ne

			vbox = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding
				allow_outside = yes

				hbox = {
					layoutpolicy_horizontal = expanding
					margin_left = 4

					widget_prominent_theme_banner = {
						visible = "[Not( GovernmentAdministrationWindow.AllowMeritPools )]"

						blockoverride "text_margin" {
							margin_left = 75
						}
					}

					widget_prominent_theme_banner = {
						datacontext = "[GovernmentAdministrationWindow.GetSelectedAdminMeritPool]"
						visible = "[GovernmentAdministrationWindow.AllowMeritPools]"

						blockoverride "text_margin" {
							margin_left = 75
						}

						blockoverride "background_banner"
						{
							# Banner Status Military
							highlight_icon = {
								visible = "[AdminMeritPool.IsMilitary]"
								position = { -4 2 }
								size = { 100% 100% }
								mirror = horizontal

								texture = "gfx/interface/window_military/military_banner_red.dds"
							}

							# Banner Status Civilian
							highlight_icon = {
								visible = "[Not( AdminMeritPool.IsMilitary )]"
								position = { -4 2 }
								size = { 100% 100% }
								mirror = horizontal

								texture = "gfx/interface/window_military/military_banner_blue.dds"
							}
						}
					}
				}

				hbox = {
					layoutpolicy_horizontal = expanding
					margin_left = 75
					margin_top = 8

					text_single = {
						max_width = 450
						layoutpolicy_horizontal = expanding

						text = "[ProminentThemeItem.GetSuccessionLineDesc]"
						align = nobaseline
					}
					expand = {}
				}

				hbox = {
					visible = "[GovernmentAdministrationWindow.AllowMeritPools]"
					layoutpolicy_horizontal = expanding
					margin_left = 75
					spacing = 4

					tooltip = "ADMIN_WINDOW_MERIT_POOLS_TITLE_RATING_TT"
					using = tooltip_ne

					text_single = {
						text = "ADMIN_WINDOW_MERIT_POOLS_TITLE_RATING"
						align = nobaseline
					}

					text_single = {
						text = "[ProminentThemeItem.GetTitleProminence|V2]"
						align = nobaseline
					}

					expand = {}
				}
				expand = {}
			}

			widget_theme_item_small = {
				parentanchor = left|vcenter
				position = { 6 3 }

				blockoverride "crown" {}

				blockoverride "outer_size"
				{
					size = { 64 64 }
				}
				blockoverride "inner_size"
				{
					size = { 64 64 }
				}
			}

		}
	}

	type vbox_prominent_theme_group_foldout = vbox {
		spacing = 4

		layoutpolicy_horizontal = expanding

		oncreate = "[BindFoldOutContext]"
		oncreate = "[PdxGuiFoldOut.Unfold]"

		button_expandable_toggle_field = {
			blockoverride "text"
			{
				text = "[ProminentThemeGroupItem.GetGroupTitle]"
			}
		}

		vbox = {
			visible = "[PdxGuiFoldOut.IsUnfolded]"

			layoutpolicy_horizontal = expanding

			fixedgridbox = {
				name = "themes_in_group"
				datamodel = "[ProminentThemeGroupItem.GetItems]"

				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding

				addcolumn = 507
				addrow = 87

				item = {
					container = {
						datacontext = "[ProminentThemeItem.GetTitle]"
						datacontext = "[ProminentThemeItem.GetCandidate]"

						# Top Liege Title
						widget_prominent_theme_item = {
							visible = "[ObjectsEqual( Title.GetHolder, Character.GetTopLiege )]"

							blockoverride "on_click"{
								onclick = "[DefaultOnCoatOfArmsClick(Title.GetID)]"
							}

							blockoverride "taxes_and_levies_visiblity"
							{
								visible = no
							}
						}

						# All other titles
						widget_prominent_theme_item = {
							visible = "[Not( ObjectsEqual( Title.GetHolder, Character.GetTopLiege ) )]"

							blockoverride "on_click"{
								onclick = "[CloseGameView( 'character_interaction_confirmation' )]"
								onclick = "[GetVariableSystem.Set( 'AdminVassalDetailAppointment', 'true' )]"
								onclick = "[SetAdminVassalDetailCandidate( Character.Self )]"
								onclick = "[ToggleAdminVassalDetailView( Title.Self )]"
								down = "[IsAdminVassalDetailViewShown( Title.Self )]"
							}
						}
					}
				}
			}
		}
	}

	type button_promote_candidate_scheme = button_standard {
		visible = "[Character.IsValid]"
		minimumsize = { 100 33 }

		enabled = "[Character.IsPlayerInteractionValid( 'start_promote_interaction' )]"
		onclick = "[Character.OpenPlayerInteraction( 'start_promote_interaction' )]"
		tooltip = "[Character.GetPlayerInteractionTooltip( 'start_promote_interaction' )]"
		tooltip_when_disabled = "[Character.GetPlayerInteractionValidBlockers( 'start_promote_interaction' )]"

		hbox = {
			layoutpolicy_horizontal = expanding
			spacing = 5

			expand = {}

			button_promote_candidate = { 
				alwaystransparent = yes 
			}

			text_single = {
				max_width = 320

				text = "ADMIN_VASSAL_DETAILS_PROMOTE_BUTTON"
				default_format = "#clickable"
				align = nobaseline|center
			}

			expand = {}
		}
	}

	type button_influence_career = button_standard {
		visible = "[Character.IsValid]"
		minimumsize = { 100 33 }

		enabled = "[Character.IsPlayerInteractionValid( 'influence_meritorious_career_interaction' )]"
		onclick = "[Character.OpenPlayerInteraction( 'influence_meritorious_career_interaction' )]"
		tooltip = "[Character.GetPlayerInteractionTooltip( 'influence_meritorious_career_interaction' )]"
		tooltip_when_disabled = "[Character.GetPlayerInteractionValidBlockers( 'influence_meritorious_career_interaction' )]"

		hbox = {
			layoutpolicy_horizontal = expanding
			spacing = 5

			expand = {}

			button_promote_candidate = { 
				alwaystransparent = yes 
			}

			text_single = {
				max_width = 320

				text = "influence_meritorious_career_interaction"
				default_format = "#clickable"
				align = nobaseline|center
			}

			expand = {}
		}
	}

	type widget_your_family_appointments = vbox {
		datacontext = "[GovernmentAdministrationWindow.GetSelectedProminentHouseMember]"
		layoutpolicy_horizontal = expanding
		layoutpolicy_vertical = expanding
		allow_outside = yes

		hbox = {
			datacontext = "[Title.GetProvince.GetHolding]"
			layoutpolicy_horizontal = expanding
			margin = { 10 0 }
			margin_bottom = 10
			spacing = 10

			background = {
				using = Background_Area_Holding
				margin_bottom = 40

				mirror = horizontal
			}

			portrait_head = {
				visible = "[Not( Character.HasMerit )]"
				allow_outside = yes
			}

			portrait_shoulders = {
				visible = "[Character.HasMerit]"
				allow_outside = yes
			}

			# Content, except widgets
			vbox = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding

				# Top Section (not dropdowns)
				# Character name
				hbox = {
					layoutpolicy_horizontal = expanding

					text_label_left = {
						layoutpolicy_horizontal = expanding
						text = "[Character.GetUINameNotMeNoTooltip]"
						align = nobaseline
						max_width = 380
						using = Font_Size_Medium
					}

					expand = {}

					### MERIT - Your Family - Selected Prominent House Member
					hbox_merit_with_label = {
						datacontext = "[GovernmentAdministrationWindow.GetMeritItem]"
					}
				}

				# Relation to you
				hbox = {
					layoutpolicy_horizontal = expanding

					text_single = {
						max_width = 380

						text = "[Character.GetRelationToString( GetPlayer )]"
						align = nobaseline

						tooltip = "EXTENDED_RELATIONS_TOOLTIP"
						using = tooltip_se
					}
					expand = {}
				}

				text_single = {
					visible = "[Character.HasMerit]"
					margin_top = 10
					margin_bottom = 4
					layoutpolicy_horizontal = expanding

					text = "ADMIN_WINDOW_MERIT_POOLS"
					align = nobaseline
				}

				expand = {}
			}

			vbox = {
				layoutpolicy_vertical = expanding
				margin_top = 5
				margin_right = 5

				button_round = {
					allow_outside = yes

					clicksound = "event:/SFX/UI/Generic/sfx_ui_generic_close"
					onclick = "[CloseGameView('admin_vassal_detail_view')]"
					onclick = "[GetVariableSystem.Clear( 'show_prominent_appointment' )]"

					shortcut = "go_back"
					shortcut = "go_back_2"
					shortcut = "go_back_3"

					tooltip = "ADMIN_WINDOW_FIND_APPOINTMENT_BACK_BUTTON_TT"

					button_back = {
						parentanchor = center
						position = { -2 0 }
						alwaystransparent = yes
						size = { 28 28 }
					}
				}

				expand = {}
			}
		}

		hbox_theme_sort_options = {
			datacontext = "[GovernmentAdministrationWindow.GetTitle]"

			blockoverride "dropdown_properties"
			{
				datamodel = "[GovernmentAdministrationWindow.GetAppointmentOrderOptions]"
				onselectionchanged = "[GovernmentAdministrationWindow.SortAppointmentThemes]"
				selectedindex = "[GovernmentAdministrationWindow.GetAppointmentSortSelectedIndex]"
			}

			blockoverride "sort_order_onclick"
			{
				onclick = "[GovernmentAdministrationWindow.ReverseAppointmentSortOrder]"
			}

			blockoverride "sort_order_frame"
			{
				frame = "[BoolTo1And2(GovernmentAdministrationWindow.GetAppointmentSortOrder)]"
			}
		}

		# Prominent Theme Items
		scrollbox = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding

			blockoverride "scrollbox_content"
			{
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding

				vbox = {
					datamodel = "[GovernmentAdministrationWindow.GetProminentThemeGroups]"
					layoutpolicy_horizontal = expanding
					spacing = 2

					item = {
						vbox_prominent_theme_group_foldout = {}
					}
				}
			}
			blockoverride "scrollbox_expand" {
				expand = {}
			}
		}



		expand = {}
	}

	type vbox_your_family_tab = vbox {
		layoutpolicy_horizontal = expanding
		layoutpolicy_vertical = expanding

		## Top info
		hbox = {
			margin = { 15 0 }
			margin_top = 10
			margin_bottom = 24
			layoutpolicy_horizontal = expanding

			using = Background_Area_Family_Decoration

			## Left Side
			vbox = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding
				spacing = 6
				margin_top = 6

				hbox = {
					layoutpolicy_horizontal = expanding
					spacing = 12

					# House Name
					text_single = {
						text = "HOUSE_VIEW_NAME_WITH_HOUSE"
						using = Font_Size_Medium
						default_format = "#high"
						align = nobaseline
					}

					text_single = {
						text = "[DynastyHouse.GetFamilyStatusConcept]"
						align = nobaseline
					}

					expand = {}

				}

				# House Land Share %
				hbox = {
					visible = "[And(Or(DynastyHouse.IsDominant,DynastyHouse.IsPowerful), Not( Character.HasMerit ))]"
					layoutpolicy_horizontal = expanding
					margin_left = -5 #Ugly solution to offset icon

					text_single = {
						layoutpolicy_horizontal = expanding

						text = "ADMIN_WINDOW_HOUSE_LAND_SHARE"
						tooltip = "ADMIN_WINDOW_HOUSE_LAND_SHARE_TOOLTIP"
						align = nobaseline
						max_width = 320
					}

					expand = {}
				}


				expand = {}

				# House Attribute
				hbox = {
					visible = "[DynastyHouse.UsesHouseAspirations]"
					datacontext = "[DynastyHouse.GetHouseAspiration]"
					layoutpolicy_horizontal = expanding

					spacing = 5

					button_standard = {
						size = { 230 33 }
						onclick = "[ToggleGameViewData( 'house_aspiration_window', DynastyHouse.Self )]"

						tooltip = "HOUSE_VIEW_CHANGE_HOUSE_POWER"

						hbox = {
							margin = { 5 0 }
							spacing = 5

							expand = {}

							button_icon = {
								visible = "[GetPlayer.GetGovernment.IsType( 'administrative_government' )]"
								size = { 28 28 }
								texture = "[HouseAspiration.GetSmallIcon]"
							}

							icon = {
								visible = "[Not(GetPlayer.GetGovernment.IsType( 'administrative_government' ))]"
								size = { 28 28 }
								texture = "[HouseAspiration.GetSmallIcon]"
							}

							text_single = {
								text = "[HouseAspiration.GetName]"
								align = nobaseline|center
								default_format = "#clickable"
								max_width = 190
							}

							expand = {}
						}
					}
					
					warning_icon = {
						size = { 32 32 }
						visible = "[And(GreaterThan_int32( GetDataModelSize( HouseAspiration.GetLevels ), '(int32)1' ), DynastyHouse.IsHouseAttributeInactive)]"
						tooltip = "FAMILY_ATTRIBUTE_WINDOW_HOUSE_ASPIRATION_ALERT"
						using = tooltip_se
					}

					warning_icon = {
						size = { 32 32 }
						visible = "[And(Not(GreaterThan_int32( GetDataModelSize( HouseAspiration.GetLevels ), '(int32)1' )), DynastyHouse.IsHouseAttributeInactive)]"
						tooltip = "FAMILY_ATTRIBUTE_WINDOW_ALERT"
						using = tooltip_se
					}

					expand = {}
				}


			}

			expand = {}

			## Right Side
			vbox = {
				background = {
					using = Background_Area
					margin = { 6 12}
					margin_top = 2
				}

				allow_outside = yes

				dynamicgridbox = {

					allow_outside = yes

					flipdirection = yes
					maxverticalslots = 1

					datamodel = "[GovernmentAdministrationWindow.AccessRankedNeighborFamilies]"

					item = {
						widget_ranked_family_neighbor = {
							datacontext = "[RankedHouseItem.GetHouse]"
						}

					}
				}
			}
		}

		#exams
		vbox = {
			name = "government_panel_exam_area" #lesson_china_exam uses this
			widgetid = "government_panel_exam_area" #lesson_china_exam uses this

			visible = "[GetPlayer.GetTopLiege.GetGovernment.HasRule( 'merit' )]"
			layoutpolicy_horizontal = expanding
			spacing = 10

			# non-joinable-now examinations
			vbox = {
				layoutpolicy_horizontal = expanding
				margin = { 15 2 }
				margin_bottom = 5

				background = {
					using = Background_Area
				}

				text_label_left = {
					layoutpolicy_horizontal = expanding
					text = "[examinations|E]"
					using = Font_Size_Medium
				}

				### Local Examination
				hbox = {
					datacontext = "[GetActivityType( 'activity_local_examination' )]"
					datacontext = "[ActivityType.FindJoinableOpenActivityOfType]"
					visible = "[Not( Activity.IsValid )]"

					layoutpolicy_horizontal = expanding
					spacing = 5

					tooltip = activity_local_examination_not_available_tt

					text_single = {
						layoutpolicy_horizontal = expanding
						min_width = 180

						text = "activity_local_examination_with_icon"
						align = nobaseline
					}

					expand = {}

					text_single = {
						text = "[ActivityType.GetLastSeenDateOfOpenActivityType]"
						align = nobaseline
						default_format = "#weak"
					}

					button_round = {
						onclick = "[ActivityType.ToggleShouldNotifyCanJoinOpenActivity]"
						size = { 36 36 }

						button_icon = {
							visible = "[ActivityType.ShouldNotifyCanJoinOpenActivity]"
							parentanchor = center
							alwaystransparent = yes
							texture = "gfx/interface/icons/flat_icons/notifications_on.dds"
							size = { 24 24 }

							tooltip = "LOCAL_EXAMINATIONS_NOTIFY_TOGGLE_TT"
						}

						button_icon = {
							visible = "[Not(ActivityType.ShouldNotifyCanJoinOpenActivity)]"
							parentanchor = center
							alwaystransparent = yes
							texture = "gfx/interface/icons/flat_icons/notifications_off.dds"
							size = { 24 24 }

							tooltip = "LOCAL_EXAMINATIONS_NOTIFY_TOGGLE_TT"
						}
					}
				}

				divider_light = {
					layoutpolicy_horizontal = expanding

					modify_texture = {
						texture = "gfx/interface/component_masks/mask_fade_horizontal_extended.dds"
						blend_mode = alphamultiply
					}
				}

				### Imperial Examination
				hbox = {
					datacontext = "[GetActivityType( 'activity_imperial_examination' )]"
					datacontext = "[ActivityType.FindJoinableOpenActivityOfType]"
					visible = "[Not( Activity.IsValid )]"

					layoutpolicy_horizontal = expanding
					spacing = 5

					tooltip = activity_imperial_examination_not_available_tt

					text_single = {
						layoutpolicy_horizontal = expanding
						min_width = 180
						text = "activity_imperial_examination_with_icon"
						align = nobaseline
					}

					expand = {}

					text_single = {
						text = "[ActivityType.GetLastSeenDateOfOpenActivityType]"
						align = nobaseline
						default_format = "#weak"
					}

					button_round = {
						onclick = "[ActivityType.ToggleShouldNotifyCanJoinOpenActivity]"
						size = { 36 36  }

						button_icon = {
							visible = "[ActivityType.ShouldNotifyCanJoinOpenActivity]"
							parentanchor = center
							alwaystransparent = yes
							texture = "gfx/interface/icons/flat_icons/notifications_on.dds"
							size = { 24 24 }

							tooltip = "CAPITAL_EXAMINATIONS_NOTIFY_TOGGLE_TT"
						}

						button_icon = {
							visible = "[Not(ActivityType.ShouldNotifyCanJoinOpenActivity)]"
							parentanchor = center
							alwaystransparent = yes
							texture = "gfx/interface/icons/flat_icons/notifications_off.dds"
							size = { 24 24 }

							tooltip = "CAPITAL_EXAMINATIONS_NOTIFY_TOGGLE_TT"
						}
					}
				}
			}

			# joinable activities
			vbox = {
				margin = { 15 0 }
				layoutpolicy_horizontal = expanding
				visible = "[Or( GetActivityType( 'activity_local_examination' ).FindJoinableOpenActivityOfType.IsValid, GetActivityType( 'activity_imperial_examination' ).FindJoinableOpenActivityOfType.IsValid )]"

				hbox = {
					layoutpolicy_horizontal = expanding
					datacontext = "[GetActivityType( 'activity_local_examination' )]"
					datacontext = "[ActivityType.FindJoinableOpenActivityOfType]"
					visible = "[Activity.IsValid]"
					spacing = 10

					button_standard = {
						layoutpolicy_horizontal = expanding
						visible = "[Activity.IsValid]"

						onclick = "[ToggleGameViewData( 'activity_list_detail_invite_window', Activity.Self )]"
						down = "[IsGameViewDataShown( 'activity_list_detail_invite_window', Activity.Self )]"
						tooltip = JOIN_ACTIVITY_TOOLTIP

						text = "ACTIVITY_LIST_JOIN_GENERIC"
					}

					button_round = {
						size = { 36 36 }
						onclick = "[ActivityType.ToggleShouldNotifyCanJoinOpenActivity]"

						button_icon = {
							visible = "[ActivityType.ShouldNotifyCanJoinOpenActivity]"
							parentanchor = center
							alwaystransparent = yes
							texture = "gfx/interface/icons/flat_icons/notifications_on.dds"
							size = { 24 24 }

							tooltip = "LOCAL_EXAMINATIONS_NOTIFY_TOGGLE_TT"
						}

						button_icon = {
							visible = "[Not(ActivityType.ShouldNotifyCanJoinOpenActivity)]"
							parentanchor = center
							alwaystransparent = yes
							texture = "gfx/interface/icons/flat_icons/notifications_off.dds"
							size = { 24 24 }

							tooltip = "LOCAL_EXAMINATIONS_NOTIFY_TOGGLE_TT"
						}
					}
				}

				hbox = {
					layoutpolicy_horizontal = expanding
					datacontext = "[GetActivityType( 'activity_imperial_examination' )]"
					datacontext = "[ActivityType.FindJoinableActivityOfType]"
					visible = "[Activity.IsValid]"
					spacing = 10

					button_standard = {
						layoutpolicy_horizontal = expanding
						visible = "[Activity.IsValid]"

						onclick = "[ToggleGameViewData( 'activity_list_detail_invite_window', Activity.Self )]"
						down = "[IsGameViewDataShown( 'activity_list_detail_invite_window', Activity.Self )]"
						tooltip = JOIN_ACTIVITY_TOOLTIP

						text = "ACTIVITY_LIST_JOIN_GENERIC"
					}

					button_round = {
						size = { 36 36 }
						onclick = "[ActivityType.ToggleShouldNotifyCanJoinOpenActivity]"

						button_icon = {
							visible = "[ActivityType.ShouldNotifyCanJoinOpenActivity]"
							parentanchor = center
							alwaystransparent = yes
							texture = "gfx/interface/icons/flat_icons/notifications_on.dds"
							size = { 24 24 }

							tooltip = "CAPITAL_EXAMINATIONS_NOTIFY_TOGGLE_TT"
						}

						button_icon = {
							visible = "[Not(ActivityType.ShouldNotifyCanJoinOpenActivity)]"
							parentanchor = center
							alwaystransparent = yes
							texture = "gfx/interface/icons/flat_icons/notifications_off.dds"
							size = { 24 24 }

							tooltip = "CAPITAL_EXAMINATIONS_NOTIFY_TOGGLE_TT"
						}
					}
				}
			}

			# hostable activities
			vbox = {
				visible = "[Or( GetActivityType( 'activity_local_examination' ).CanPlanActivity( GetPlayer.Self ), GetActivityType( 'activity_imperial_examination' ).CanPlanActivity( GetPlayer.Self ) )]"
				layoutpolicy_horizontal = expanding
				margin = { 15 0 }

				hbox = {
					datacontext = "[GetActivityType( 'activity_local_examination' )]"
					visible = "[ActivityType.CanPlanActivity( GetPlayer.Self )]"
					layoutpolicy_horizontal = expanding
					spacing = 10

					button_standard = {
						layoutpolicy_horizontal = expanding
						text = "ACTIVITY_LIST_HOST_GENERIC"

						enabled = "[ActivityType.CanStartActivity( GetPlayer.Self )]"
						onclick = "[ToggleGameViewData( 'activity_list_detail_host_window', ActivityType.Self )]"
						down = "[IsGameViewDataShown( 'activity_list_detail_host_window', ActivityType.Self )]"

						tooltip = SHOW_ACTIVITY_TOOLTIP
					}

					button_round = {
						onclick = "[ActivityType.ToggleShouldNotifyCanHost]"
						size = { 36 36 }

						button_icon = {
							visible = "[ActivityType.ShouldNotifyCanHost]"
							parentanchor = center
							alwaystransparent = yes
							texture = "gfx/interface/icons/flat_icons/notifications_on.dds"
							size = { 24 24 }

							tooltip = "ACTIVITY_LIST_NOTIFY_ME_ABOUT_HOSTING_EXAMINATIONS_LOCAL_TT"
						}

						button_icon = {
							visible = "[Not(ActivityType.ShouldNotifyCanHost)]"
							parentanchor = center
							alwaystransparent = yes
							texture = "gfx/interface/icons/flat_icons/notifications_off.dds"
							size = { 24 24 }

							tooltip = "ACTIVITY_LIST_NOTIFY_ME_ABOUT_HOSTING_EXAMINATIONS_LOCAL_TT"
						}
					}
				}

				hbox = {
					layoutpolicy_horizontal = expanding
					datacontext = "[GetActivityType( 'activity_imperial_examination' )]"
					visible = "[ActivityType.CanPlanActivity( GetPlayer.Self )]"
					spacing = 10

					button_standard = {
						layoutpolicy_horizontal = expanding

						enabled = "[ActivityType.CanStartActivity( GetPlayer.Self )]"
						onclick = "[ToggleGameViewData( 'activity_list_detail_host_window', ActivityType.Self )]"
						down = "[IsGameViewDataShown( 'activity_list_detail_host_window', ActivityType.Self )]"
						tooltip = SHOW_ACTIVITY_TOOLTIP

						text = "ACTIVITY_LIST_HOST_GENERIC"
					}

					button_round = {
						onclick = "[ActivityType.ToggleShouldNotifyCanHost]"
						size = { 36 36 }

						button_icon = {
							visible = "[ActivityType.ShouldNotifyCanHost]"
							parentanchor = center
							alwaystransparent = yes
							texture = "gfx/interface/icons/flat_icons/notifications_on.dds"
							size = { 24 24 }

							tooltip = "ACTIVITY_LIST_NOTIFY_ME_ABOUT_HOSTING_EXAMINATIONS_IMPERIAL_TT"
						}

						button_icon = {
							visible = "[Not(ActivityType.ShouldNotifyCanHost)]"
							parentanchor = center
							alwaystransparent = yes
							texture = "gfx/interface/icons/flat_icons/notifications_off.dds"
							size = { 24 24 }

							tooltip = "ACTIVITY_LIST_NOTIFY_ME_ABOUT_HOSTING_EXAMINATIONS_IMPERIAL_TT"
						}
					}
				}
			}
		}
		
		vbox = {
			visible = "[And( GetPlayer.GetTopLiege.GetGovernment.HasRule( 'administrative' ), Not( GetPlayer.GetTopLiege.GetGovernment.HasRule( 'merit' ) ) )]"
			datacontext = "[GetPlayer]"
			layoutpolicy_horizontal = expanding
			margin_top = 7
			margin_left = 5
			
			hbox = {
				layoutpolicy_horizontal = expanding
				
				text_label_left = {
					margin_left = 10
					max_width = 250
					#using = Font_Size_Medium

					layoutpolicy_horizontal = expanding

					text = "ADMINISTRATIVE_GOVERNMENT_INVESTMENT_CAP"

					tooltipwidget = {
						widget_value_breakdown_tooltip = {
							datacontext = "[GovernmentAdministrationWindow.GetInvestmentCapTooltip( Character.Self )]"
						}
					}
				}
				expand = {}
			}
		}

		spacer = {
			size = { 0 10 }
		}

		## Prominent House Member Character List
		vbox_character_list = {
			name = "admin_panel_your_family_character_list" #ra_merit_candidacy_house_members uses this
			datacontext = "[GovernmentAdministrationWindow.AccessProminentHouseMemberList]"
			datacontext = "[GovernmentAdministrationWindow.AccessProminentHouseMemberCharacterList]"
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding

			blockoverride "sort_buttons"
			{
				hbox_list_sort_buttons = {
					layoutpolicy_horizontal = expanding

					blockoverride "margins" {
						margin_left = 15
						margin_right = -38 #-margin to offset an expand in the hbox_list_sort_buttons type. This was an easier solution that going into the base type and fix since we use it in so many places.
						margin_top = 5
						spacing = 5
					}

					blockoverride "filters_visible" {
						visible = no
					}

					blockoverride "sort_prefix" {
						text_single = {
							text = "ADMIN_WINDOW_PROMINENT_MEMBERS"
							align = nobaseline
							max_width = 240
						}
						expand = {}
					}

					blockoverride "sort_dropdown" {
						dropdown_sort_characterlist = {
							name = "prominent_house_member_sort_options"
						}
					}
				}
			}

			blockoverride "skill_sort_buttons" {}
			blockoverride "character_count" {}

			blockoverride "scrollbox_empty_visibility"
			{
				layoutpolicy_vertical = expanding
				visible = "[Not( CharacterSelectionList.HasItems )]"

				text = "ADMIN_WINDOW_NO_FAMILY_MEMBERS"
			}

			blockoverride "container_implementation"
			{
				### CHARACTER LIST ITEM - MERIT ###
				fixedgridbox = {
					datamodel = "[CharacterSelectionList.GetList]"
					visible = "[And( Not( CharacterSelectionList.IsBuildingList ), GetPlayer.GetTopLiege.GetGovernment.HasRule( 'merit' ) )]"

					addcolumn = 530
					addrow = 187

					item = {
						widget_prominent_house_member_item_celestial = {}
					}
				}

				### CHARACTER LIST ITEM - OTHER ADMIN ###
				fixedgridbox = {
					datamodel = "[CharacterSelectionList.GetList]"
					visible = "[And( Not( CharacterSelectionList.IsBuildingList ), Not( GetPlayer.GetTopLiege.GetGovernment.HasRule( 'merit' ) ) )]"

					addcolumn = 530
					addrow = 130

					item = {
						widget_prominent_house_member_item = {}
					}
				}
			}
		}
	}

	type widget_prominent_house_member_item_celestial = widget {
		datacontext = "[CharacterListItem.GetCharacter]"
		size = { 530 182 }

		background = {
			using = Background_Area_Dark

			alpha = 0.6
			margin = { -2 -2 }
			margin_bottom = -120
		}

		background = {
			using = Background_Frame
		}

		vbox = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding

			margin = { 10 9 }
			spacing = 5

			hbox = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding

				vbox = {
					layoutpolicy_vertical = expanding

					### LEFT PORTRAIT
					portrait_head = {}

					expand = {}
				}

				vbox = {
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding

					hbox = {
						layoutpolicy_horizontal = expanding

						vbox = {
							layoutpolicy_horizontal = expanding

							### NAME
							hbox = {
								margin_left = 5
								layoutpolicy_horizontal = expanding

								text_single = {
									max_width = 310

									text = "[Character.GetUINameNotMeNoTooltip]"
									using = Font_Size_Medium
									align = nobaseline
								}

								expand = {}
							}

							### RELATION
							hbox = {
								margin_left = 5
								layoutpolicy_horizontal = expanding

								tooltip = "EXTENDED_RELATIONS_TOOLTIP"
								using = tooltip_se

								text_single = {
									max_width = 310

									text = "[Character.GetRelationToString( GetPlayer )]"
									align = nobaseline
								}

								expand = {}
							}
						}

						expand = {}

						vbox = {
							layoutpolicy_vertical = expanding
							allow_outside = yes

							hbox = {
								allow_outside = yes
								margin_right = 5

								widget = {
									datacontext = "[ProminentHouseMemberCharacterList.GetMeritItem( CharacterListItem.GetIndex )]"
									visible = "[GreaterThanOrEqualTo_int32( Character.GetMeritLevel, '(int32)1' )]"
									size = { 76 46 }
									allow_outside = yes

									### MERIT - Your Family - Character List Selection
									hbox_merit_with_label = {
										name = "admin_panel_character_item_merit_rank"

										blockoverride "icon_size"
										{
											size = { 42 42 }
										}

										blockoverride "hbox_merit_with_label_background" {}
									}

									warning_icon = {
										visible = "[And(Character.IsMeritCapped, Not( EqualTo_int32( Character.GetMeritLevel, '(int32)9' ) ) )]"
										position = { -5 0 }
										size = { 25 25 }
										allow_outside = yes

										tooltip = "ADMIN_WINDOW_MERIT_CAPPED_TT"
										using = tooltip_se
									}
								}

								widget = {
									datacontext = "[ProminentHouseMemberCharacterList.GetMeritItem( CharacterListItem.GetIndex )]"
									visible = "[EqualTo_int32( Character.GetMeritLevel, '(int32)0' )]"
									size = { 90 46 }
									allow_outside = yes

									### MERIT - Your Family - Character List Selection
									hbox_merit_with_label = {
										name = "admin_panel_character_item_merit_rank"

										blockoverride "icon_size"
										{
											size = { 42 42 }
										}

										blockoverride "hbox_merit_with_label_background" {}
									}
								}

								expand = {}
							}
						}
					}

					### MERIT and EXAMINATIONS (adults)
					hbox = {
						visible = "[And(Character.IsAdult, Character.ShouldShowMerit)]"
						layoutpolicy_horizontal = expanding
						layoutpolicy_vertical = expanding
						margin_left = 5
						spacing = 16

						### MERIT POOLS
						hbox = {
							datamodel = "[ProminentHouseMemberCharacterList.GetMeritPools( CharacterListItem.GetIndex )]"
							visible = "[Not(IsDataModelEmpty( ProminentHouseMemberCharacterList.GetMeritPools( CharacterListItem.GetIndex )))]"
							margin_top = 10
							spacing = 10

							item = {
								button_merit_pool_item = {
									blockoverride "default_format" {}
								}
							}
						}

						expand = {}

						hbox = {
							layoutpolicy_vertical = expanding
							margin_top = 5

							expand = {}

							### EXAMINATIONS (all 3 adult exams, if there is space)
							hbox = {
								name = "admin_panel_character_item_exams" #ra_merit_candidacy_exams uses this
								
								visible = "[LessThanOrEqualTo_int32( GetDataModelSize(ProminentHouseMemberCharacterList.GetMeritPools( CharacterListItem.GetIndex )) , '(int32)3' )]"

								spacing = 5
								layoutpolicy_horizontal = expanding

								widget_provincial_exam_status = {
									
									size = { 40 40 }
								}

								widget_metropolitan_exam_status = {
									size = { 40 40 }
								}

								widget_palace_exam_status = {
									size = { 40 40 }
								}
							}

							### PALACE EXAM (if there is little space)

							widget_palace_exam_status = {
								visible = "[GreaterThanOrEqualTo_int32( GetDataModelSize(ProminentHouseMemberCharacterList.GetMeritPools( CharacterListItem.GetIndex )) , '(int32)4' )]"
							}
						}
					}

					### MERIT and EXAMINATIONS (children)

					hbox = {
						layoutpolicy_horizontal = expanding
						layoutpolicy_vertical = expanding
						visible = "[And(Not(Character.IsAdult), Character.ShouldShowMerit)]"

						spacing = 4
						margin = { 4 4 }

						widget_childrens_exam_status = { }

						vbox = {
							layoutpolicy_horizontal = expanding

							text_single = {
								layoutpolicy_horizontal = expanding
								text = "game_concept_childrens_examination"
								align = nobaseline
							}

							text_single = {
								layoutpolicy_horizontal = expanding
								visible = "[HasPassedChildrenExamination(Character)]"
								text = "EXAMINATION_PASSED"
								align = nobaseline
							}

							text_single = {
								layoutpolicy_horizontal = expanding
								visible = "[Not(HasPassedChildrenExamination(Character))]"
								text = "EXAMINATION_NOT_TAKEN"
								align = nobaseline
							}
						}
					}
					
				}
			}

			### BUTTONS BOTTOM ROW
			hbox = {
				layoutpolicy_horizontal = expanding

				margin = { 5 0 }
				margin_bottom = 5
				spacing = 10

				# Scheme 'influence_candidacy_interaction'
				button_standard = {
					datacontext = "[GetNullLandedTitle]"
					visible = "[Character.IsPlayerInteractionShown( 'influence_candidacy_interaction' )]"
					layoutpolicy_horizontal = expanding
					minimumsize = { 0 33 }

					onclick = "[Character.OpenPlayerInteractionWithTargetTitle( 'influence_candidacy_interaction', Title.Self )]"

					tooltip = "[Character.GetPlayerInteractionTooltip( 'influence_candidacy_interaction' )]"
					tooltip_when_disabled = "[Character.GetPlayerInteractionValidBlockers( 'influence_candidacy_interaction' )]"

					hbox = {
						layoutpolicy_horizontal = expanding
						margin = { 8 4 }
						spacing = 4

						button_promote_candidate = {
							alwaystransparent = yes
						}

						text_single = {
							max_width = 430

							text = "ADMIN_VASSAL_DETAILS_VOTE_FOR_SUCCESSOR_BUTTON"
							default_format = "#clickable"
							align = nobaseline
						}

						expand = {}
					}
				}

				button_influence_career = {
					name = "admin_panel_character_item_influence_career" #ra_merit_candidacy_score uses this
					visible = "[Not(Character.IsPlayerInteractionShown( 'send_child_to_examination_interaction' ))]"
					layoutpolicy_horizontal = expanding
				}

				button_promote_candidate_scheme = {
					name = "admin_panel_character_item_promote_scheme" #ra_merit_candidacy_score uses this

					# hide invalid interaction to save space
					visible = "[And(Character.IsValid,Character.IsPlayerInteractionValid( 'start_promote_interaction' ))]"
					layoutpolicy_horizontal = expanding
				}

				### Interaction Button - Child Exam
				button_standard = {
					name = "admin_panel_character_item_child_exam" #ra_merit_candidacy_child_exams uses this
					visible = "[Character.IsPlayerInteractionShown( 'send_child_to_examination_interaction' )]"
					layoutpolicy_horizontal = expanding
					minimumsize = { 0 33 }

					enabled = "[Character.IsPlayerInteractionValid( 'send_child_to_examination_interaction' )]"
					onclick = "[Character.OpenPlayerInteraction( 'send_child_to_examination_interaction' )]"

					tooltip = "[Character.GetPlayerInteractionTooltip( 'send_child_to_examination_interaction' )]"
					tooltip_when_disabled = "[Character.GetPlayerInteractionValidBlockers( 'send_child_to_examination_interaction' )]"

					text = "send_child_to_examination_interaction"
				}

				### Decision Button - Attend Child Exam
				button_decision_entry = {
					datacontext = "[GetDecisionWithKey( 'tgp_china_attend_child_exam_decision' )]"
					visible = "[And( Not( Character.IsPlayerInteractionShown( 'send_child_to_examination_interaction' ) ), Decision.IsShownForPlayer )]"

					blockoverride "button_size"
					{
						minimumsize = { 300 33 }
					}

					onclick = "[OpenGameViewData( 'decision_detail', Decision.Self )]"
				}
			}
		}
	}

	type widget_prominent_house_member_item = widget {
		datacontext = "[CharacterListItem.GetCharacter]"
		size = { 530 124 }
		allow_outside = yes

		background = {
			using = Background_Area
		}

		# Container
		hbox = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
			allow_outside = yes

			background = {
				using = Background_Area_Dark
				alpha = 0.8

				margin_bottom = -65
			}

			vbox = {
				layoutpolicy_vertical = expanding

				portrait_head = {}

				expand = {}
			}

			vbox = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding
				allow_outside = yes

				margin = { 5 5 }
				margin_top = 4

				hbox = {
					layoutpolicy_horizontal = expanding
					allow_outside = yes

					vbox = {
						layoutpolicy_horizontal = expanding

						hbox = {
							layoutpolicy_horizontal = expanding

							# Character name
							text_single = {
								layoutpolicy_horizontal = expanding
								max_width = 340

								text = "[Character.GetUINameNotMeNoTooltip]"
								using = Font_Size_Medium
								align = nobaseline
							}

							expand = {}
						}

						# Relation to you
						hbox = {
							layoutpolicy_horizontal = expanding

							text_single = {
								layoutpolicy_horizontal = expanding
								max_width = 340

								text = "[Character.GetRelationToString( GetPlayer )]"
								align = nobaseline

								tooltip = "EXTENDED_RELATIONS_TOOLTIP"
								using = tooltip_se
							}

							expand = {}
						}
					}

					expand = {}

					# CoA Theme
					vbox = {
						layoutpolicy_vertical = expanding
						margin_top = 2
						margin_right = 14
						allow_outside = yes


						widget = {
							size = { 50 50 }
							allow_outside = yes

							widget_theme_item_small = {
								datacontext = "[Character.GetPrimaryTitle]"
								visible = "[Title.IsValid]"
								parentanchor = center
								allow_outside = yes

								blockoverride "crown" {}

								blockoverride "outer_size"
								{
									size = { 62 62 }
								}
								blockoverride "inner_size"
								{
									size = { 62 62 }
								}
							}
						}

						expand = {}
					}
				}

				vbox = {
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding
					visible = "[Character.IsAdult]"

					expand = {}

					# Button Options
					hbox = {

						layoutpolicy_horizontal = expanding
						margin_bottom = 10
						spacing = 10

						button_promote_candidate_scheme = {
							layoutpolicy_horizontal = expanding
						}

						button_standard = {
							layoutpolicy_horizontal = expanding

							text = "ADMIN_WINDOW_BUTTON_FIND_APPOINTMENT"
							enabled = "[Character.IsPlayerInteractionValid( 'start_promote_interaction' )]"
							tooltip_when_disabled = "[Character.GetPlayerInteractionValidBlockers( 'start_promote_interaction' )]"
							onclick = "[GovernmentAdministrationWindow.SelectProminentHouseMember( Character.Self )]"
							onclick = "[GetVariableSystem.Set( 'show_prominent_appointment', 'true' )]"
						}

						expand = {}
					}
				}

				text_single = {
					visible = "[Not(Character.IsAdult)]"
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding

					# added after loc freeze, text could be better
					text = "NOT_IS_ADULT_TRIGGER"

					default_format = "#weak"
					align = hcenter|nobaseline
				}
			}
		}
	}

	type vbox_family_group_foldout = vbox {
		layoutpolicy_horizontal = expanding

		spacing = 6

		oncreate = "[BindFoldOutContext]"
		oncreate = "[PdxGuiFoldOut.Unfold]"

		button_expandable_toggle_field = {
			blockoverride "text"
			{
				text = "[AdminFamilyGroupItem.GetName]"
			}
		}

		vbox = {
			visible = "[PdxGuiFoldOut.IsUnfolded]"

			layoutpolicy_horizontal = expanding

			fixedgridbox = {
				name = "families_in_group"
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding

				addcolumn = 520
				addrow = 124

				datamodel = "[AdminFamilyGroupItem.GetFamilyItems]"

				item = {
					vbox = {
						layoutpolicy_horizontal = expanding

						button_family_group_item = {
							datacontext = "[AdminFamilyItem.GetHouse]"
						}
						expand = {}
					}
				}
			}
		}
	}

	type widget_house_power_banner_small = widget
	{
		size = { 92% 32 }
		parentanchor = bottom|hcenter
		position = { 0 -14 }

		background = {
			texture = "gfx/interface/window_theme_administration/rating_banner.dds"
		}

		tooltipwidget = {
			widget_value_breakdown_tooltip = {
				datacontext = "[GovernmentAdministrationWindow.GetHousePowerTooltip( DynastyHouse.Self )]"

				blockoverride "header"
				{
					text_label_left = {
						layoutpolicy_horizontal = expanding
						text = "game_concept_powerful_family_rating"
						default_format = "#T"
					}
				}
			}
		}

		text_single = {
			parentanchor = center
			position = { 0 -1 }
			max_width = 250

			text = "[DynastyHouse.GetHousePower]"
			default_format = "#light_background"
			align = nobaseline
		}
	}

	type widget_house_power_banner_medium = widget
	{
		size = { 100 32 }
		parentanchor = bottom|hcenter
		position = { 0 -4 }

		background = {
			texture = "gfx/interface/window_theme_administration/rating_banner.dds"
		}

		tooltipwidget = {
			widget_value_breakdown_tooltip = {
				datacontext = "[GovernmentAdministrationWindow.GetHousePowerTooltip( DynastyHouse.Self )]"
			}
		}

		text_single = {
			parentanchor = center
			position = { 5 -1 }
			max_width = 200

			text = "[AdminFamilyItem.GetRankAndPower]"
			default_format = "#light_background"
			using = Font_Size_Tiny
			align = nobaseline
		}
	}

	type widget_ranked_family_neighbor = widget
	{
		minimumsize = "[Select_CVector2f( RankedHouseItem.IsPlayerHouse, '(CVector2f)88,110', '(CVector2f)64,110' )]"
		layoutpolicy_horizontal = expanding
		allow_outside = yes

		vbox = {

			spacing = -4

			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
			allow_outside = yes

			hbox = {
				layoutpolicy_horizontal = expanding
				text_single = {
					text = "[RankedHouseItem.GetRank]"
					tooltip = "ADMIN_WINDOW_FAMILY_RANK_TOOLTIP"
					default_format = "#high"
					align = nobaseline
				}
			}

			coa_house_medium = {
				visible = "[RankedHouseItem.IsPlayerHouse]"
				allow_outside = yes

				widget_house_power_banner_small = {
					position = { 0 22 }
					allow_outside = yes
				}
			}

			coa_house_small = {
				visible = "[Not( RankedHouseItem.IsPlayerHouse )]"
				allow_outside = yes

				widget_house_power_banner_small = {
					position = { 0 22 }
					allow_outside = yes
				}
			}

			expand = {}
		}
	}

	type hbox_featured_family_head_portrait = hbox
	{
		background = {
			using = Background_Area
			alpha = 1.2

			margin = { 8 4 }
		}

		vbox = {
			spacing = 2
			layoutpolicy_vertical = expanding


			expand = {}

			widget_access_domicile_button = {
				datacontext = "[DynastyHouse.GetHeadOfHouse]"
				datacontext = "[Character.GetDomicile]"
				visible = "[Character.HasDomicile]"
			}

			button_round = {
				visible = "[Not( Character.IsPlayer )]"

				tooltip = "ADMIN_GOVERNMENT_HOUSE_HEAD_INTERACTIONS_BUTTON_TOOLTIP"
				tooltip_visible = "[Not(IsInteractionMenuOpenForCharacterWithFilter(Character.Self, 'admin_house_head'))]"

				onclick = "[ToggleFilteredCharacterInteractionMenu(Character.Self, 'admin_house_head')]"

				button_icon = {
					alwaystransparent = yes
					parentanchor = center
					size = { 30 30 }
					texture = "gfx/interface/icons/flat_icons/character_interactions.dds"
				}

				text_single = {
					parentanchor = bottom|hcenter
					position = { 0 3 }
					text = "[GetNumberOfValidInteractionsWithFilter(Character.Self, 'admin_house_head')]"
					default_format = "#glow_color:{0.1,0.1,0.1,1.0}"

					background = {
						margin = { 5 0 }
						margin_top = -5
						using = Background_Area_Dark
					}
				}

			}

			expand = {}
		}

		block "portrait_head"
		{
			portrait_head_small = {}
		}
	}

	type vbox_featured_family_portrait_big = hbox
	{
		layoutpolicy_horizontal = expanding

		vbox = {
			margin_top = 12

			# House CoA
			widget = {
				size = { 120 120 }

				allow_outside = yes

				datacontext = "[Character.GetHouse]"

				coa_house_big = {
					datacontext = "[Character.GetHouse]"
					parentanchor = top|hcenter
					allow_outside = yes

					powerful_family_bonus = {
						parentanchor = top|right
						size = { 36 36 }
					}
				}
			}
		}

		expand = {}

		vbox = {
			layoutpolicy_vertical = expanding
			margin = { 4 0 }

			text_single = {
				layoutpolicy_horizontal = expanding
				max_width = 160
				margin_left = 8
				align = nobaseline
				using = Font_Size_Medium
				block "subtitle" {}
			}

			hbox = {
				spacing = 2
				layoutpolicy_vertical = expanding

				vbox = {
					layoutpolicy_vertical = expanding
					spacing = 2

					expand = {}

					widget_access_domicile_button = {
						datacontext = "[Character.GetDomicile]"
						visible = "[Character.HasDomicile]"
					}

					button_round = {
						visible = "[Not( Character.IsPlayer )]"

						block "interactions_on_click" {}

						button_icon = {
							alwaystransparent = yes
							parentanchor = center
							size = { 30 30 }
							texture = "gfx/interface/icons/flat_icons/character_interactions.dds"
						}

						text_single = {
							parentanchor = bottom|hcenter
							position = { 0 3 }

							block "interaction_number_text" {}

							default_format = "#glow_color:{0.1,0.1,0.1,1.0}"

							background = {
								margin = { 5 0 }
								margin_top = -5
								using = Background_Area_Dark
							}
						}
					}

					expand = {}
				}
				portrait_head_small = {}
			}
		}

	}

	type button_family_group_item = widget
	{
		size = { 520 118 }

		using = Background_Area_Administrative_Decoration

		hbox = {
			layoutpolicy_horizontal = expanding
			layoutpolicy_vertical = expanding
			margin_top = 6
			margin_left = 5
			spacing = 8

			# House CoA
			widget = {
				size = { 84 110 }
				layoutpolicy_vertical = expanding
				allow_outside = yes

				vbox = {
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding
					allow_outside = yes

					coa_house_medium = {
						allow_outside = yes

						powerful_family_bonus = {
							parentanchor = top|right
							position = { 2 0 }
							size = { 32 32 }
							blockoverride "level_icons" {}
						}
					}

					expand = {}
				}

				widget = {
					parentanchor = vcenter|right
					position = { 2 -15 }
					size = { 20 20 }

					icon_house_relation = {
						size = { 20 20 }

						datacontext = "[DynastyHouse.GetHouseRelationWith( GetPlayer.GetHouse )]"
						tooltipwidget = {
							house_relation_item_tooltip_no_progressbar = {
								blockoverride "description_prefix" {
									text_single = {
										layoutpolicy_horizontal = expanding
										text = "house_relation_your_relation_with"
										default_format = "#weak"
										align = left
									}
								}
							}
						}
					}
				}

				widget_house_power_banner_medium = {}
			}

			hbox = {
				datacontext = "[DynastyHouse.GetHeadOfHouse]"
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding

				margin = { 5 5 }

				vbox = {
					layoutpolicy_horizontal = expanding
					layoutpolicy_vertical = expanding

					ignoreinvisible = no

					hbox = {
						layoutpolicy_horizontal = expanding

						text_single = {
							layoutpolicy_horizontal = expanding

							text = "ADMINISTRATIVE_GOVERNMENT_HOUSE_WITH_NAME"
							align = nobaseline
							max_width = 270
							using = Font_Size_Medium
						}

						expand = {}
					}

					hbox_house_bloc_info = {
						layoutpolicy_horizontal = expanding
					}

					# House County Control in Realm
					hbox = {
						layoutpolicy_horizontal = expanding
						margin_left = -5 #Ugly solution to offset icon

						text_single = {
							visible = "[And(Or(DynastyHouse.IsDominant,DynastyHouse.IsPowerful), Not( Character.HasMerit ))]"
							layoutpolicy_horizontal = expanding

							text = "ADMIN_WINDOW_HOUSE_LAND_SHARE"
							tooltip = "ADMIN_WINDOW_HOUSE_LAND_SHARE_TOOLTIP"
							align = nobaseline
							max_width = 270


						}

						expand = {}
					}

					expand = {}
				}

				vbox = {

					margin = { 5 2 }

					layoutpolicy_vertical = expanding

					hbox_featured_family_head_portrait = {}

					expand = {}
				}

				expand = {}
			}
		}
	}

	type widget_special_ruler = widget
	{
		size = { 110 149 }

		portrait_head = {
			visible = "[Not( Title.MakeScope.Var( 'administrative_ui_special_title' ).Title.IsValid )]"
			parentanchor = hcenter

			blockoverride "coa" {}
			blockoverride "portrait_button_template_tooltip" {}
		}

		widget = {
			visible = "[Title.MakeScope.Var( 'administrative_ui_special_title' ).Title.IsValid]"
			datacontext = "[Title.MakeScope.Var( 'administrative_ui_special_title' ).Title.GetHolder]"
			size = { 110 149 }

			portrait_head = {
				blockoverride "portrait_button_template_tooltip" {}
			}

			text_single = {
				widgetanchor = bottom|hcenter
				parentanchor = bottom|hcenter
				text = "[Character.GetTitledFirstName]"
			}
		}
	}

	type button_merit_pool_item = widget {
		size = { 56 56 }
		allow_outside = yes

		button = {
			parentanchor = bottom|hcenter
			size = { 56 56 }
			allow_outside = yes
			texture = "gfx/interface/buttons/button_lifestyles_base.dds"

			block "button_onclick"
			{
				onclick = "[GovernmentAdministrationWindow.SelectProminentHouseMember( Character.Self )]"
				onclick = "[GovernmentAdministrationWindow.SetMeritPoolCharacterList( AdminMeritPool.Self )]"
				onclick = "[MeritPoolWindow.ScrollToCandidate( Character.Self, '(int32)15' )]"
				down = "[ObjectsEqual( AdminMeritPool.Self, GovernmentAdministrationWindow.GetSelectedAdminMeritPool )]"
			}

			tooltip = "[AdminMeritPool.GetCandidateTooltip( Character.Self )]"
			using = tooltip_se

			text_single = {
				visible = "[Not( AdminMeritPool.IsMilitary )]"
				parentanchor = center
				position = { 0 -5 }

				text = "celestial_province_standard_text_icon"
				align = nobaseline
			}

			text_single = {
				visible = "[AdminMeritPool.IsMilitary]"
				parentanchor = center
				position = { 0 -5 }

				text = "celestial_province_military_text_icon"
				align = nobaseline
			}

			button_round = {
				parentanchor = top|right
				position = { 11 -6 }
				size = { 30 30 }

				onclick = "[GovernmentAdministrationWindow.SelectProminentHouseMember( Character.Self )]"
				onclick = "[GovernmentAdministrationWindow.SetMeritPoolCharacterList( AdminMeritPool.Self )]"
				onclick = "[MeritPoolWindow.ScrollToCandidate( Character.Self, '(int32)15' )]"

				icon = {
					name = "crown"
					parentanchor = center
					texture = "gfx/interface/coat_of_arms/crown_strip_28.dds"
					frame = "[AdminMeritPool.GetTierFrame]"
					framesize = { 32 22 }
					scale = 0.8
					position = { 0 -3 }
				}
			}
		}

		widget_succession_candidate_banner_small = {
			parentanchor = bottom|hcenter
			position = { 0 -3 }
			size = { 60 24 }

			blockoverride "background_texture"
			{
				texture = "gfx/interface/hud/tgp_widget_button_banner.dds"
			}

			blockoverride "banner_text"
			{
				parentanchor = center|vcenter
				widgetanchor = center
				position = { 0 2 }

				text = "TITLE_APPOINTMENT_RANK_SMALL"
			}
		}

		icon = {
			visible = "[And( Not(Character.HasNewAppointmentCooldown), AdminMeritPool.HasCareerScorePotential( Character.Self ) )]"
			parentanchor = bottom|hcenter
			allow_outside = yes

			position = { 26 -3 }
			size = { 20 20 }
			texture = "gfx/interface/icons/appointment_score.dds"
		}

		icon = {
			visible = "[Character.HasNewAppointmentCooldown]"
			parentanchor = bottom|hcenter
			allow_outside = yes

			position = { 24 -2 }
			size = { 25 25 }
			texture = "gfx/interface/icons/icon_time.dds"
		}
	}

	type vbox_merit_pool_character_item = vbox {
		margin_top = 2
		layoutpolicy_horizontal = expanding
		layoutpolicy_vertical = expanding

		### NAME and GOVERNOR EFFICIENCY ###
		hbox = {
			margin = { 5 5 }
			margin_right = 10
			layoutpolicy_horizontal = expanding

			background = {
				using = Background_Area_Dark
				alpha = 0.6
				margin_left = 7
				margin_right = -2
			}

			text_single = {
				layoutpolicy_horizontal = expanding

				text = "[Character.GetUINameNoTooltip|U]"
				using = Font_Size_Medium
				align = nobaseline

				max_width = 330
				min_height = 32
			}

			expand = {}

			### MERIT ###
			hbox_merit_with_label = {
				datacontext = "[MeritPoolWindow.GetMeritItem( CharacterListItem.GetIndex )]"

				blockoverride "hbox_merit_with_label_background" {}
			}

			### APPOINTMENT SCORE ###
			hbox = {
				datacontext = "[CharacterListItem]"
				margin_left = 10

				text_single = {
					layoutpolicy_horizontal = expanding
					min_width = 50

					text = "ADMIN_WINDOW_MERIT_POOLS_APPOINTMENT_SCORE"
					align = nobaseline
				}

				using = tooltip_se
				tooltipwidget = {
					widget_value_breakdown_tooltip = {
						block "score_breakdown" {
							datacontext = "[MeritPoolWindow.GetSuccessionScoreBreakdown( CharacterListItem.GetCharacter )]"
						}
					}
				}
			}

		}

		### RELATION TO YOU ###
		vbox = {
			layoutpolicy_horizontal = expanding
			margin_left = 5

			text_single = {
				layoutpolicy_horizontal = expanding
				max_width = 470

				text = "[Character.GetRelationToString( GetPlayer )]"
				align = nobaseline

				tooltip = "EXTENDED_RELATIONS_TOOLTIP"
				using = tooltip_se
			}

			expand = {}
		}

		### HOUSE, SCORE and MERIT
		hbox = {
			layoutpolicy_horizontal = expanding
			margin_right = 5

			### House Coat of Arms
			vbox = {
				datacontext = "[Character.GetHouse]"

				coa_house_small = {
					powerful_family_bonus = {
						parentanchor = bottom|right
						position = { 7 1 }
						size = { 29 29 }
						blockoverride "level_icons" {}
					}
				}
			}

			# Currently held Primary Title, if not a Noble Family title
			widget = {
				size = { 50 64 }
				visible = "[Not( Character.GetPrimaryTitle.IsNobleFamilyTitle )]"

				coa_realm_tiny_crown = {
					position = { 10 6 }

					blockoverride "coa_button"
					{
						tooltip = "[Character.GetDefaultRealmFlagTooltipPrimaryTitleClickInfo]"
						onclick = "[DefaultOnCoatOfArmsClick(Character.GetPrimaryTitle.GetID)]"
					}
				}
			}

			expand = {}

			vbox = {
				layoutpolicy_vertical = expanding
				visible = "[Character.HasNewAppointmentCooldown]"

				expand = {}

				hbox = {
					margin = { 10 0 }
					spacing = 10
					min_height = 32

					background = {
						using = Background_Area
						margin_top = 5
						margin_bottom = 2
						margin_right = 5
					}

					### APPOINTMENT TIMEOUT ###
					hbox = {
						visible = "[Character.HasNewAppointmentCooldown]"
						tooltip = "ADMIN_WINDOW_APPOINTMENT_COOLDOWN_TT"

						alert_icon = {
							size = { 30 30 }

							texture = "gfx/interface/icons/icon_time.dds"
						}

						text_single = {
							layoutpolicy_horizontal = expanding
							margin_left = 5

							text = "[Character.GetNewAppointmentCooldownDate.GetTimeDiffFromNow]"
							align = nobaseline
						}
					}

					# GOVERNOR EFFICIENCY
#					hbox = {
#						tooltip = "ADMIN_WINDOW_THEME_GOVERNOR_EFFICIENCY_TT"
#						using = tooltip_ne
#
#						icon = {
#							name = "char_governor_efficiency_icon"
#							size = { 32 32 }
#							texture = "gfx/interface/icons/icon_skill_governor_efficiency.dds"
#						}
#
#						text_single = {
#							name = "char_governor_efficiency_value"
#							text = "ADMIN_WINDOW_THEME_GOVERNOR_EFFICIENCY_VALUE"
#							align = nobaseline
#						}
#					}
				}
			}
		}

		expand = {}
	}

	type window_merit_pool_characters = window {
		name = "merit_pool_characters_window" # Referenced in Code, don't rename
		widgetanchor = right
		position = { 20 90 }
		size = { 700 82% }

		layer = middle
		movable = yes

		using = Window_Background
		using = Window_Decoration_Spike
		using = Window_Size_CharacterList

		state = {
			name = _show
			using = Animation_FadeIn_Quick
		}

		state = {
			name = _hide
			using = Animation_FadeOut_Quick
		}

		vbox = {
			using = Window_Margins

			header_pattern = {
				layoutpolicy_horizontal = expanding

				blockoverride "header_text"
				{
					text = "[AdminMeritPool.GetTitle]"
				}

				blockoverride "button_close"
				{
					onclick = "[MeritPoolWindow.Close]"
					onclick = "[GovernmentAdministrationWindow.ClearMeritPoolCharacterList]"
				}
			}

			vbox = {
				margin = { 20 5 }
				margin_bottom = 15
				layoutpolicy_horizontal = expanding
				visible = no

				background = {
					using = Background_Area

					modify_texture = {
						texture = "gfx/interface/component_masks/mask_fade_vertical_up.dds"
						blend_mode = alphamultiply
					}
				}

				# Leaving this commented out just in case
				#text_single = {
				#	layoutpolicy_horizontal = expanding
				#	margin_bottom = 5
				#
				#	text = "ADMIN_WINDOW_MERIT_POOLS_PARTICIPANT_INFO"
				#	default_format = "#weak"
				#	align = center|nobaseline
				#	max_width = 580
				#}

				text_multi = {
					layoutpolicy_horizontal = expanding
					margin_top = 15
					margin_bottom = 5
					max_width = 580
					autoresize = yes

					text = "[AdminMeritPool.GetRequiredMeritLevel]"
					default_format = "#weak"
					align = center|nobaseline
				}

			}

			vbox = {
				layoutpolicy_horizontal = expanding
				margin = { 0 10 }
				margin_top = 0

				text_multi = {
					autoresize = yes
					max_width = 580

					text = "ADMIN_WINDOW_MERIT_POOLS_CANDIDATE_RANKING_DESC"
				}

				tooltipwidget = {
					container = {
						using = GeneralTooltipSetup
						alwaystransparent = no

						widget = {
							name = "background"
							using = DefaultTooltipBackground
							size = { 100% 100% }
							alwaystransparent = no
						}

						flowcontainer = {
							margin = { 20 10 }
							margin_bottom = 15
							direction = vertical

							background = {
								using = Background_Area

								modify_texture = {
									texture = "gfx/interface/component_masks/mask_fade_vertical_up.dds"
									blend_mode = alphamultiply
								}
							}

							text_multi = {
								margin_bottom = 5
								max_width = 580
								autoresize = yes

								text = "[AdminMeritPool.GetRequiredMeritLevel]"
							}

							### Valid Obligation Level Types
							flowcontainer = {
								datamodel = "[GovernmentAdministrationWindow.GetAdminPoolTypeObligations]"
								ignoreinvisible = yes
								direction = vertical

								item = {
									flowcontainer = {
										visible = "[ObligationLevel.HasTag( AdminMeritPool.GetPoolTypeTag )]"
										ignoreinvisible = yes
										spacing = 5

										text_single = {
											raw_text = ""
										}

										text_single = {
											text = "[ObligationLevel.GetName]"
											align = center|nobaseline
										}
									}
								}
							}
						}
					}

				}
			}

			vbox_character_list = {
				layoutpolicy_horizontal = expanding
				layoutpolicy_vertical = expanding

				blockoverride "sort_buttons"
				{
					hbox_list_sort_buttons = {
						layoutpolicy_horizontal = expanding

						blockoverride "filters_visible" {
							visible = no
						}

						blockoverride "sort_dropdown" {
							dropdown_sort_characterlist = {
								name = "merit_pools_sort_options"
							}
						}
					}
				}

				blockoverride "skill_sort_buttons" {}

				blockoverride "scrollbox_empty_visibility"
				{
					layoutpolicy_vertical = expanding
					visible = "[Not( CharacterSelectionList.HasItems )]"
					text = "ADMIN_WINDOW_MERIT_POOLS_EMPTY"
				}

				blockoverride "container_implementation"
				{
					fixedgridbox = {
						name = "characters_grid"
						addcolumn = 580
						addrow = 140
						datamodel_reuse_widgets = yes
						datamodel = "[CharacterSelectionList.GetList]"
						visible = "[Not(CharacterSelectionList.IsBuildingList)]"

						item = {
							widget_character_list_item_finder = {
								size = { 580 135 }
								blockoverride "character_relation" {}

								background = {
									using = Background_Frame
								}

								background = {
									visible = "[ObjectsEqual( Character.Self, GovernmentAdministrationWindow.GetSelectedProminentHouseMember.Self )]"

									using = Background_Frame_Gold
								}
							}
						}
					}
				}

				blockoverride "portrait_head_margin"
				{
					margin_left = 5

					widget_succession_candidate_banner = {
						blockoverride "banner_text"
						{
							text = "[Add_int32( CharacterListItem.GetIndex, '(int32)1' )|O]"
						}
					}
				}

				blockoverride "button_content"
				{
					vbox_merit_pool_character_item = {}
				}
			}
		}
	}

	type hbox_theme_sort_options = hbox {
		layoutpolicy_horizontal = expanding
		margin = { 16 0 }
		margin_bottom = 8
		spacing = 4

		hbox = {
			spacing = 2

			text_single = {
				text = "SORT_BY"
				align = nobaseline
			}

			dropdown_menu_standard = {
				blockoverride "dropdown_active_item_properties"
				{
					text = "[ThemeOrderOption.GetName]"
				}

				blockoverride "dropdown_item_properties"
				{
					text = "[ThemeOrderOption.GetName]"
				}
			}
		}

		button_standard = {
			name = "sort_order"
			size = { 25 25 }

			block "sort_order_onclick"
			{
				onclick = "[GovernmentAdministrationWindow.ReverseSortOrder]"
			}

			tooltip = "ADMIN_WINDOW_THEME_SORT_BY"
			using = tooltip_nw

			button_icon = {
				alwaystransparent = yes
				parentanchor = center
				size = { 25 25 }
				texture = "gfx/interface/icons/flat_icons/sort_icon.dds"
				framesize = { 66 66 }

				block "sort_order_frame"
				{
					frame = "[BoolTo1And2(GovernmentAdministrationWindow.GetSortOrder)]"
				}

				blockoverride "button_frames"
				{
					effectname = "NoHighlight"
				}
			}
		}
		expand = {}
	}

	type widget_childrens_exam_status = widget {
		size = { 60 60 }
		
		datacontext = "[Character.MakeScope]"

		tooltip = "MERIT_TOOLTIP_EXAMINATION_PASSED_CHILD_EXAM"
		using = tooltip_se

		icon = {
			size = { 100% 100% }
			texture = "gfx/interface/icons/character_interactions/tgp_send_to_childrens_examination_interaction.dds"
			enabled = "[HasPassedChildrenExamination(Character)]"
		}

		passed_examination_icon = {
			visible = "[HasPassedChildrenExamination(Character)]"

			size = { 50% 50% }
			parentanchor = bottom|right
		}

		failed_examination_icon = {
			visible = "[HasFailedChildrenExamination(Character)]"

			size = { 50% 50% }
			parentanchor = bottom|right
		}
	}

	type widget_provincial_exam_status = widget {
		size = { 60 60 }

		datacontext = "[Character.MakeScope]"

		tooltip = "MERIT_TOOLTIP_EXAMINATION_PASSED_PROVINCIAL_EXAM"
		using = tooltip_se

		icon = {
			size = { 100% 100% }
			texture = "gfx/interface/icons/character_interactions/provincial_examination.dds"
			enabled = "[HasPassedProvincialExamination(Character)]"

			glow = {
				visible = "[And(And(Not(HasPassedProvincialExamination(Character)), Character.IsMeritCapped), Or(ObjectsEqual(GetPlayer, Character.GetWarden.Self), Character.IsLocalPlayer))]"
				using = Color_Bright_Yellow
				glow_radius = 5
				using = Glow_Standard
				alpha = 0.8
			}
		}

		passed_examination_icon = {
			visible = "[HasPassedProvincialExamination(Character)]"

			size = { 50% 50% }
			parentanchor = bottom|right
		}

		failed_examination_icon = {
			visible = "[HasFailedProvincialExamination(Character)]"

			size = { 50% 50% }
			parentanchor = bottom|right
		}
	}


	type widget_metropolitan_exam_status = widget {
		size = { 60 60 }
		
		datacontext = "[Character.MakeScope]"

		tooltip = "MERIT_TOOLTIP_EXAMINATION_PASSED_METROPOLITAN_EXAM"
		using = tooltip_se

		icon = {
			size = { 100% 100% }
			texture = "gfx/interface/icons/character_interactions/imperial_examination.dds"
			enabled = "[HasPassedMetropolitanExamination(Character)]"

			glow = {
				visible = "[And(And(Not(HasPassedMetropolitanExamination(Character)), Character.IsMeritCapped), Or(ObjectsEqual(GetPlayer, Character.GetWarden.Self), Character.IsLocalPlayer))]"
				using = Color_Bright_Yellow
				glow_radius = 5
				using = Glow_Standard
				alpha = 0.8
			}
		}

		passed_examination_icon = {
			visible = "[HasPassedMetropolitanExamination(Character)]"

			size = { 50% 50% }
			parentanchor = bottom|right
		}

		failed_examination_icon = {
			visible = "[HasFailedMetropolitanExamination(Character)]"

			size = { 50% 50% }
			parentanchor = bottom|right
		}
	}

	type widget_palace_exam_status = widget {
		size = { 60 60 }

		datacontext = "[Character.MakeScope]"

		tooltip = "MERIT_TOOLTIP_EXAMINATION_PASSED_PALACE_EXAM"
		using = tooltip_se

		icon = {
			size = { 100% 100% }
			texture = "gfx/interface/icons/character_interactions/palace_examination.dds"
			enabled = "[HasPassedPalaceExamination(Character)]"

			glow = {
				visible = "[And(And(Not(HasPassedPalaceExamination(Character)), Character.IsMeritCapped), Or(ObjectsEqual(GetPlayer, Character.GetWarden.Self), Character.IsLocalPlayer))]"
				using = Color_Bright_Yellow
				glow_radius = 5
				using = Glow_Standard
				alpha = 0.8
			}
		}
		
		passed_examination_icon = {
			visible = "[HasPassedPalaceExamination(Character)]"

			size = { 50% 50% }
			parentanchor = bottom|right
		}

		# no failed stamp, you cannot fail palace exam
	}
}

template Background_Obligation_Banner_Right {
	highlight_icon = {
		visible = "[ObligationLevel.HasTag( 'byzantine_purple' )]"
		size = { 100% 100% }
		mirror = horizontal
		spritetype = corneredTiled
		spriteborder = { 0 8 }
		texture_density = 2

		texture = "gfx/interface/window_military/military_banner_gray.dds"
		color = { 0.89 0.5 0.89 1 }
	}

	highlight_icon = {
		visible = "[ObligationLevel.HasTag( 'military' )]"
		size = { 100% 100% }
		mirror = horizontal
		spritetype = corneredTiled
		spriteborder = { 0 8 }
		texture_density = 2

		texture = "gfx/interface/window_military/military_banner_red.dds"
	}

	highlight_icon = {
		visible = "[And( Not( ObligationLevel.HasTag( 'byzantine_purple' ) ), Not( ObligationLevel.HasTag( 'military' ) ) )]"
		size = { 100% 100% }
		mirror = horizontal
		spritetype = corneredTiled
		spriteborder = { 2 8 }
		texture_density = 2

		texture = "gfx/interface/window_military/military_banner_blue.dds"
	}
}

template Background_Area_Administrative_Decoration {
	background = {
		visible = "[DynastyHouse.IsImperial]"
		margin = { 4 4 }
		using = Background_Area_Admin_Purple
		alpha = 1
	}

	background = {
		visible = "[DynastyHouse.IsDominant]"
		margin = { 4 4 }
		using = Background_Area_Admin_Orange
		alpha = 1
	}

	background = {
		visible = "[DynastyHouse.IsPowerful]"
		margin = { 4 4 }
		using = Background_Area_Admin_Blue
		alpha = 1
	}

	background = {
		texture = "gfx/interface/window_administrative_government/family_decoration.dds"
		spriteType = Corneredtiled
		margin_bottom = 2
		spriteborder_bottom = 14
		texture_density = 1.5
		alpha = 0.1
		using = Mask_Rough_Edges
	}

	background = {
		texture = "gfx/interface/window_administrative_government/family_decoration.dds"
		spriteType = Corneredtiled
		margin_top = 2
		spriteborder_top = 14
		texture_density = 1.5
		alpha = 0.1
		using = Mask_Rough_Edges
	}

	background = {
		texture = "gfx/interface/skinned/mask_pattern.dds"
		texture_density = 3
		spriteType = corneredtiled
		color = { 0.1 0.1 0.12 1 }
		margin = { 0 -10 }
		alpha = 0.2

		using = Mask_Rough_Edges

		modify_texture = {
			texture = "gfx/interface/component_masks/mask_clouds.dds"
			blend_mode = alphamultiply
			spriteType = corneredTiled
			alpha = 0.5
		}

		modify_texture = {
			texture = "gfx/interface/component_masks/mask_scratches.dds"
			blend_mode = alphamultiply
			spriteType = corneredTiled
		}
	}

	background = {
		visible = "[DynastyHouse.GetHeadOfHouse.IsPlayer]"
		using = Background_Area_Border
		using = Background_Frame_Gold
	}

	background = {
		visible = "[And(Not(DynastyHouse.IsImperial),Not(DynastyHouse.IsPowerful))]"
		texture = "gfx/interface/window_administrative_government/powerful_family_decoration.dds"
		using = Mask_Rough_Edges
		fittype = start
		alpha = 1
		tintcolor = { 0.7 0.7 0.7 0.8 }

		modify_texture = {
			texture = "gfx/interface/component_masks/mask_fade_horizontal_right.dds"
			blend_mode = alphaMultiply
		}

	}

	background = {
		visible = "[DynastyHouse.IsPowerful]"
		texture = "gfx/interface/window_administrative_government/powerful_family_decoration.dds"
		using = Mask_Rough_Edges
		fittype = start
		alpha = 1

		modify_texture = {
			texture = "gfx/interface/component_masks/mask_fade_horizontal_right.dds"
			blend_mode = alphaMultiply
		}
	}

	background = {
		visible = "[DynastyHouse.IsImperial]"
		texture = "gfx/interface/window_administrative_government/imperial_family_decoration.dds"
		using = Mask_Rough_Edges
		fittype = start
		alpha = 1

		modify_texture = {
			texture = "gfx/interface/component_masks/mask_fade_horizontal_right.dds"
			blend_mode = alphaMultiply
		}
	}
}

template Background_Area_Family_Decoration {
	background = {
		visible = "[DynastyHouse.IsImperial]"
		margin = { 4 4 }
		using = Background_Area_Admin_Purple
		alpha = 1
	}

	background = {
		visible = "[DynastyHouse.IsDominant]"
		margin = { 4 4 }
		using = Background_Area_Admin_Orange
		alpha = 1
	}

	background = {
		visible = "[DynastyHouse.IsPowerful]"
		margin = { 4 4 }
		using = Background_Area_Admin_Blue
		alpha = 1
	}

	background = {
		texture = "gfx/interface/window_administrative_government/family_decoration.dds"
		spriteType = Corneredtiled
		margin_bottom = 2
		spriteborder_bottom = 14
		texture_density = 1.5
		alpha = 0.1
		using = Mask_Rough_Edges
	}

	background = {
		texture = "gfx/interface/window_administrative_government/family_decoration.dds"
		spriteType = Corneredtiled
		margin_top = 2
		spriteborder_top = 14
		texture_density = 1.5
		alpha = 0.1
		using = Mask_Rough_Edges
	}

	background = {
		texture = "gfx/interface/skinned/mask_pattern.dds"
		texture_density = 3
		spriteType = corneredtiled
		color = { 0.1 0.1 0.12 1 }
		margin = { 0 -10 }
		alpha = 0.2

		using = Mask_Rough_Edges

		modify_texture = {
			texture = "gfx/interface/component_masks/mask_clouds.dds"
			blend_mode = alphamultiply
			spriteType = corneredTiled
			alpha = 0.5
		}

		modify_texture = {
			texture = "gfx/interface/component_masks/mask_scratches.dds"
			blend_mode = alphamultiply
			spriteType = corneredTiled
		}
	}

	#background = {
	#visible = "[DynastyHouse.GetHeadOfHouse.IsPlayer]"
	#using = Background_Area_Border
	#using = Background_Frame_Gold
	#}
}

template Background_Area_Admin_Purple {
	texture = "gfx/interface/colors/grey.dds"

	using = Mask_Rough_Edges
	color = { 0.5 0.1 0.5 0.6 }

	modify_texture = {
		blend_mode = alphaMultiply
		texture = "gfx/interface/component_masks/mask_fade_horizontal_extended.dds"
		alpha = 0.5
	}
	modify_texture = {
		texture = "gfx/interface/component_masks/mask_clouds.dds"
		blend_mode = alphamultiply
		spriteType = corneredTiled
		alpha = 0.5
	}

	modify_texture = {
		texture = "gfx/interface/component_masks/mask_scratches.dds"
		blend_mode = alphamultiply
		spriteType = corneredTiled
	}
}

template Background_Area_Admin_Blue {
	texture = "gfx/interface/colors/grey.dds"

	using = Mask_Rough_Edges
	color = { 0 0.635 0.9 0.3 }

	modify_texture = {
		blend_mode = alphaMultiply
		texture = "gfx/interface/component_masks/mask_fade_horizontal_extended.dds"
		alpha = 0.5
	}
	modify_texture = {
		texture = "gfx/interface/component_masks/mask_clouds.dds"
		blend_mode = alphamultiply
		spriteType = corneredTiled
		alpha = 0.5
	}

	modify_texture = {
		texture = "gfx/interface/component_masks/mask_scratches.dds"
		blend_mode = alphamultiply
		spriteType = corneredTiled
	}
}

template Background_Area_Admin_Orange {
	texture = "gfx/interface/colors/grey.dds"

	using = Mask_Rough_Edges
	color = { 1 0.5 0.1 0.6 }

	modify_texture = {
		blend_mode = alphaMultiply
		texture = "gfx/interface/component_masks/mask_fade_horizontal_extended.dds"
		alpha = 0.5
	}

	modify_texture = {
		texture = "gfx/interface/component_masks/mask_clouds.dds"
		blend_mode = alphamultiply
		spriteType = corneredTiled
		alpha = 0.5
	}

	modify_texture = {
		texture = "gfx/interface/component_masks/mask_scratches.dds"
		blend_mode = alphamultiply
		spriteType = corneredTiled
	}
}

template Expand_Admin_Themes {
	on_start = "[GetVariableSystem.Set( 'admin_gov_unassigned_counties_list', 'true' )]"
	on_start = "[GetVariableSystem.Set( 'admin_gov_assigned_duchy_themes_list', 'true' )]"
	on_start = "[GetVariableSystem.Set( 'admin_gov_unassigned_duchy_themes_list', 'true' )]"
}
