##########################################
# Family Attributes for Powerful Families
# Celestial Government
##########################################
# Attributes appear in-game in script order
# So we group them in rough categories

@celestial_aspiration_level_1_cost = 250
@celestial_aspiration_level_2_cost = 750
@celestial_aspiration_level_3_cost = 1500
@celestial_aspiration_level_4_cost = 2500
@celestial_aspiration_level_5_cost = 5000

@celestial_aspiration_cooldown_duration = 0

##########################################

# Ritual
celestial_traditional = {
	show_in_main_hud = yes
	is_shown = {
		house_head ?= {
			government_has_flag = government_uses_merit_family_aspirations
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_1_cost
		}

		powerful_family_member_modifier = {
			domicile_monthly_gold_mult = 0.04
		}

		any_house_member_modifier = {
			confucian_education_xp_gain_mult = 0.02
			monthly_piety_gain_mult = 0.02
		}

		parameters = {
			feasts_costs_treasury = yes
			movement_power_per_piety_level_1 = yes
		}

		ai_score = {
			value = 0
			
			# Base AI
			if = {
				limit = {
					ai_has_cautious_personality = yes
				}
				add = 25
			}
			
			# Traits
			if = {
				limit = { has_trait = education_learning }
				add = 10
			}
			if = {
				limit = { has_trait = confucian_education }
				add = 10
			}
			if = {
				limit = { has_trait = stubborn }
				add = 5
			}
			if = {
				limit = { has_trait = humble }
				add = 5
			}
			
			# AI Values
			if = {
				limit = { ai_boldness > 0 }
				add = {
					value = ai_zeal
					multiply = 0.5
				}
			}
			if = {
				limit = { ai_vengefulness < 0 }
				add = {
					value = ai_vengefulness
					multiply = -0.3
				}
			}
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_2_cost
		}

		powerful_family_member_modifier = {
			domicile_monthly_gold_mult = 0.08
		}

		any_house_member_modifier = {
			confucian_education_xp_gain_mult = 0.04
			monthly_piety_gain_mult = 0.04
		}

		parameters = {
			feasts_costs_treasury = yes
			movement_power_per_piety_level_2 = yes
			inherit_merit_bonus_1 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_3_cost
		}

		powerful_family_member_modifier = {
			domicile_monthly_gold_mult = 0.12
			owned_political_scheme_success_chance_growth_add = 1
		}

		any_house_member_modifier = {
			confucian_education_xp_gain_mult = 0.06
			monthly_piety_gain_mult = 0.06
		}

		parameters = {
			feasts_costs_treasury = yes
			movement_power_per_piety_level_3 = yes
			inherit_merit_bonus_2 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_4_cost
		}

		powerful_family_member_modifier = {
			domicile_monthly_gold_mult = 0.16
			owned_political_scheme_success_chance_growth_add = 3
		}

		any_house_member_modifier = {
			confucian_education_xp_gain_mult = 0.08
			monthly_piety_gain_mult = 0.08
		}

		parameters = {
			feasts_costs_treasury = yes
			movement_power_per_piety_level_4 = yes
			inherit_merit_bonus_3 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_5_cost
		}

		powerful_family_member_modifier = {
			domicile_monthly_gold_mult = 0.2
			owned_political_scheme_success_chance_growth_add = 5
		}

		any_house_member_modifier = {
			confucian_education_xp_gain_mult = 0.1
			monthly_piety_gain_mult = 0.1
		}

		parameters = {
			feasts_costs_treasury = yes
			movement_power_per_piety_level_5 = yes
			inherit_merit_bonus_4 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	cooldown = { days = @celestial_aspiration_cooldown_duration }

	on_upgraded = {
		update_character_movement_power_effect = yes # Make sure to update movement power
	}

	on_changed = {
		update_character_movement_power_effect = yes # Make sure to update movement power
	}

	illustration = "gfx/interface/icons/culture_pillars/ethos_courtly.dds"
}

# Righteousness
celestial_family = {
	show_in_main_hud = yes
	is_shown = {
		house_head ?= {
			government_has_flag = government_uses_merit_family_aspirations
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_1_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_salary_budget_mult = 0.02
		}

		any_house_member_modifier = {
			monthly_merit = 0.05
		}

		parameters = {
			examination_success_bonus = yes
			inspection_activity_merit_bonus_1 = yes
		}

		ai_score = {
			value = 0
			
			# Traits
			if = {
				limit = { has_trait = education_diplomacy }
				add = 10
			}
			if = {
				limit = { has_trait = compassionate }
				add = 5
			}
			if = {
				limit = { has_trait = gregarious }
				add = 5
			}
			if = {
				limit = { has_trait = honest }
				add = 5
			}
			
			# AI Values
			if = {
				limit = { ai_compassion > 0 }
				add = {
					value = ai_compassion
					multiply = 0.7
				}
			}
			if = {
				limit = { ai_sociability > 0 }
				add = {
					value = ai_sociability
					multiply = 0.25
				}
			}
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_2_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_salary_budget_mult = 0.04
		}

		any_house_member_modifier = {
			monthly_merit = 0.1
			personal_scheme_phase_duration_add = -3
		}

		parameters = {
			examination_success_bonus = yes
			inspection_activity_merit_bonus_2 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_3_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_salary_budget_mult = 0.06
			monthly_merit_mult = 0.05
		}

		any_house_member_modifier = {
			monthly_merit = 0.15
			personal_scheme_phase_duration_add = -6
		}

		parameters = {
			examination_success_bonus = yes
			inspection_activity_merit_bonus_3 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_4_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_salary_budget_mult = 0.08
			monthly_merit_mult = 0.1
		}

		any_house_member_modifier = {
			monthly_merit = 0.2
			personal_scheme_phase_duration_add = -9
		}

		parameters = {
			examination_success_bonus = yes
			inspection_activity_merit_bonus_4 = yes
			influence_career_bonus_1 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_5_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_salary_budget_mult = 0.1
			monthly_merit_mult = 0.15
		}

		any_house_member_modifier = {
			monthly_merit = 0.25
			personal_scheme_phase_duration_add = -12
		}

		parameters = {
			examination_success_bonus = yes
			inspection_activity_merit_bonus_5 = yes
			influence_career_bonus_2 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	cooldown = { days = @celestial_aspiration_cooldown_duration }

	on_upgraded = {
		update_character_movement_power_effect = yes # Make sure to update movement power
	}

	on_changed = {
		update_character_movement_power_effect = yes # Make sure to update movement power
	}

	illustration = "gfx/interface/icons/culture_pillars/ethos_courtly.dds"
}

# Integrity
celestial_governor = {
	show_in_main_hud = yes
	is_shown = {
		house_head ?= {
			government_has_flag = government_uses_merit_family_aspirations
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_1_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_liege_mult = 0.02
			hostile_scheme_phase_duration_add = -5
		}

		any_house_member_modifier = {
			lifestyle_poet_xp_gain_mult = 0.02
		}

		parameters = {
			inspection_activity_increases_salary = yes
		}

		ai_score = {
			value = 0
			
			# Base AI
			if = {
				limit = {
					OR = {
						ai_has_economical_boom_personality = yes
						ai_has_pious_builder_personality = yes
					}
				}
				add = 20
			}
			
			# Traits
			if = {
				limit = { has_trait = education_stewardship }
				add = 5
			}
			if = {
				limit = { has_trait = lifestyle_poet }
				add = 5
			}
			if = {
				limit = { has_trait = diligent }
				add = 5
			}
			if = {
				limit = { has_trait = just }
				add = 5
			}
			
			# AI Values
			if = {
				limit = { ai_rationality > 0 }
				add = {
					value = ai_rationality
					multiply = 0.4
				}
			}
			if = {
				limit = { ai_greed < 0 }
				add = {
					value = ai_greed
					multiply = -0.5
				}
			}
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_2_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_liege_mult = 0.04
			hostile_scheme_phase_duration_add = -10
		}

		any_house_member_modifier = {
			lifestyle_poet_xp_gain_mult = 0.04
			monthly_merit_per_liege_tax = 0.03
		}

		parameters = {
			inspection_activity_increases_salary = yes
			poet_trait_provides_candidate_score_1 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_3_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_liege_mult = 0.06
			hostile_scheme_phase_duration_add = -15
		}

		any_house_member_modifier = {
			lifestyle_poet_xp_gain_mult = 0.06
			monthly_merit_per_liege_tax = 0.06
		}

		parameters = {
			inspection_activity_increases_salary = yes
			governance_improved_governor_efficiency_bonus = yes
			poet_trait_provides_candidate_score_2 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_4_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_liege_mult = 0.08
			hostile_scheme_phase_duration_add = -20
		}

		any_house_member_modifier = {
			lifestyle_poet_xp_gain_mult = 0.08
			monthly_merit_per_liege_tax = 0.09
		}

		parameters = {
			inspection_activity_increases_salary = yes
			governance_improved_governor_efficiency_bonus = yes
			poet_trait_provides_candidate_score_3 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_5_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_liege_mult = 0.1
			hostile_scheme_phase_duration_add = -25
		}

		any_house_member_modifier = {
			lifestyle_poet_xp_gain_mult = 0.1
			monthly_merit_per_liege_tax = 0.12
		}

		parameters = {
			inspection_activity_increases_salary = yes
			governance_improved_governor_efficiency_bonus = yes
			poet_trait_provides_candidate_score_4 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	cooldown = { days = @celestial_aspiration_cooldown_duration }

	on_upgraded = {
		update_character_movement_power_effect = yes # Make sure to update movement power
	}

	on_changed = {
		update_character_movement_power_effect = yes # Make sure to update movement power
	}

	illustration = "gfx/interface/icons/culture_pillars/ethos_courtly.dds"
}

# Honor
celestial_warlord = {
	show_in_main_hud = yes
	is_shown = {
		house_head ?= {
			government_has_flag = government_uses_merit_family_aspirations
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_1_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_military_budget_mult = 0.02
		}

		any_house_member_modifier = {
			advantage = 1
		}

		parameters = {
			hunts_costs_treasury = yes
			movement_power_per_prestige_level_1 = yes
		}

		ai_score = {
			value = 0
			
			# Base AI
			if = {
				limit = { ai_has_warlike_personality = yes }
				add = 25
			}
			
			# Traits
			if = {
				limit = { has_trait = education_martial }
				add = 5
			}
			if = {
				limit = { has_trait = arrogant }
				add = 5
			}
			if = {
				limit = { has_trait = wrathful }
				add = 5
			}
			
			# AI Values
			if = {
				limit = { ai_boldness > 0 }
				add = {
					value = ai_boldness
					multiply = 0.4
				}
			}
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_2_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_military_budget_mult = 0.04
		}

		any_house_member_modifier = {
			advantage = 2
			men_at_arms_maintenance = -0.025
		}

		parameters = {
			hunts_costs_treasury = yes
			movement_power_per_prestige_level_2 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_3_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_military_budget_mult = 0.06
		}

		any_house_member_modifier = {
			advantage = 3
			men_at_arms_maintenance = -0.05
		}

		parameters = {
			hunts_costs_treasury = yes
			hunts_provides_merit = yes
			movement_power_per_prestige_level_3 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_4_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_military_budget_mult = 0.08
			men_at_arms_limit = 1
		}

		any_house_member_modifier = {
			advantage = 4
			men_at_arms_maintenance = -0.075
			men_at_arms_cap = 1
		}

		parameters = {
			hunts_costs_treasury = yes
			hunts_provides_merit = yes
			movement_power_per_prestige_level_4 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	level = {
		cost = {
			influence = @celestial_aspiration_level_5_cost
		}

		powerful_family_member_modifier = {
			monthly_treasury_from_military_budget_mult = 0.1
			men_at_arms_limit = 2
		}

		any_house_member_modifier = {
			advantage = 5
			men_at_arms_maintenance = -0.1
			men_at_arms_cap = 2
		}

		parameters = {
			hunts_costs_treasury = yes
			hunts_provides_merit = yes
			movement_power_per_prestige_level_5 = yes
		}

		ai_score = {
			value = 500 # AI always wants to upgrade - No switching!
		}
	}

	cooldown = { days = @celestial_aspiration_cooldown_duration }

	on_upgraded = {
		update_character_movement_power_effect = yes # Make sure to update movement power
	}

	on_changed = {
		update_character_movement_power_effect = yes # Make sure to update movement power
	}

	illustration = "gfx/interface/icons/culture_pillars/ethos_courtly.dds"
}
