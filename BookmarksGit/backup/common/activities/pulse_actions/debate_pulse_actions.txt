apa_movement_ridiculed = {
	icon = social
	is_valid = {
		is_current_phase_active = yes
		any_attending_character = {
			learning < 5
			is_ai = yes
			this != scope:host
			this != scope:activity.var:challenged_movement_leader
			top_participant_group:dynastic_cycle ?= {
				NOT = {
					participant_group_type = undecided_movement
				}
			}
			save_temporary_scope_as = temp_char
		}
		any_attending_character = {
			learning > scope:temp_char.learning
			is_ai = yes
			this != scope:host
			this != scope:activity.var:challenged_movement_leader
			this != scope:temp_char
			exists = top_participant_group:dynastic_cycle
			top_participant_group:dynastic_cycle != scope:temp_char.top_participant_group:dynastic_cycle
		}
	}

	weight = {
		value = 1
	}

	effect = {
		random_attending_character = {
			limit = {
				learning < 5
				is_ai = yes
				this != scope:host
				this != scope:activity.var:challenged_movement_leader
				top_participant_group:dynastic_cycle ?= {
					NOT = {
						participant_group_type = undecided_movement
					}
				}
			}
			save_scope_as = first
		}
		random_attending_character = {
			limit = {
				learning > scope:first.learning
				is_ai = yes
				this != scope:host
				this != scope:activity.var:challenged_movement_leader
				this != scope:first
				exists = top_participant_group:dynastic_cycle
				top_participant_group:dynastic_cycle != scope:first.top_participant_group:dynastic_cycle
			}
			save_scope_as = second
		}

		scope:first = {
	        top_participant_group:dynastic_cycle ?= { 
	            save_scope_as = first_movement
	        }
		}

		add_activity_log_entry = {
			key = apa_movement_ridiculed
			tags = { pulse_action }
			character = scope:second
			target = scope:first
            scope:first_movement = {
                event_change_movement_power_effect = {
                    VALUE = event_increase_movement_power_medium_value
                }
            }
            scope:first = {
            	change_influence = minor_influence_loss
            }
		}
	}
}

apa_debate_brought_huangdi_gift = {
	icon = positive
	is_valid = {
		is_current_phase_active = yes
		any_attending_character = {
			this != scope:activity.var:challenged_movement_leader
			this != scope:host
			is_ai = yes
			short_term_gold >= minor_gold_value
			NOT = { has_trait = greedy }
			OR = {
				has_trait = generous
				has_trait = ambitious
			}
		}
	}

	weight = {
		value = 1
	}

	effect = {
		random_attending_character = {
			limit = {
				this != scope:activity.var:challenged_movement_leader
				this != scope:host
				is_ai = yes
				short_term_gold >= minor_gold_value
				NOT = { has_trait = greedy }
				OR = {
					has_trait = generous
					has_trait = ambitious
				}
			}
			save_scope_as = first
		}
		random_attending_character = {
			limit = {	
				trigger_if = {
					limit = {
						scope:activity = {
							any_attending_character = { this = title:h_china.holder }
						}
					}
					primary_title = title:h_china
				}
				trigger_else = { this = scope:host }
			}
			save_scope_as = second
		}

		scope:first = {
			remove_short_term_gold = minor_gold_value
		}

		add_activity_log_entry = {
			key = apa_brought_huangdi_gift
			tags = { pulse_action }
			character = scope:first
			target = scope:second

			scope:first = {
				change_influence = minor_influence_gain
			}
		}
	}
}

apa_debate_entrant_disagreement = {
	icon = social
	is_valid = {
		is_current_phase_active = yes
		any_attending_character = {
			is_ai = yes
			this != scope:host
			this != scope:activity.var:challenged_movement_leader
			top_participant_group:dynastic_cycle ?= {
				NOT = { participant_group_type = undecided_movement }
			}
			save_temporary_scope_as = temp_char
		}
		any_attending_character = {
			is_ai = yes
			this != scope:host
			this != scope:activity.var:challenged_movement_leader
			exists = top_participant_group:dynastic_cycle
			top_participant_group:dynastic_cycle != scope:temp_char.top_participant_group:dynastic_cycle
		}
	}

	weight = {	
		value = 1
	}

	effect = {
		random_attending_character = {
			limit = {
				is_ai = yes
				this != scope:host
				this != scope:activity.var:challenged_movement_leader
				top_participant_group:dynastic_cycle ?= {
					NOT = { participant_group_type = undecided_movement }
				}
			}
			save_scope_as = first
		}
		random_attending_character = {
			limit = {
				is_ai = yes
				this != scope:host
				this != scope:activity.var:challenged_movement_leader
				exists = top_participant_group:dynastic_cycle
				top_participant_group:dynastic_cycle != scope:first.top_participant_group:dynastic_cycle
			}
			save_scope_as = second
		}

		add_activity_log_entry = {
			key = apa_entrant_disagreement
			tags = { pulse_action }
			character = scope:first
			target = scope:second

			scope:first = {
				if = {
					limit = {
						can_set_relation_rival_trigger = { CHARACTER = scope:second }
					}
					progress_towards_rival_effect = {
						REASON = rival_at_university
						CHARACTER = scope:second
						OPINION = default_rival_opinion
					}
				}
				else_if = {
					limit = {
						is_ai = yes
					}
					add_opinion = {
						target = scope:second
						modifier = annoyed_opinion
						opinion = -10
					}
				}
				else = {
					scope:second = {
						add_opinion = {
							target = scope:first
							modifier = annoyed_opinion
							opinion = -10
						}
					}
				}
			}
		}
	}
}

apa_debate_found_disciple = {
	icon = social
	is_valid = {
		is_current_phase_active = yes
		any_attending_character = {
			is_ai = yes
			has_activity_intent = debate_gain_elder_intent
            trigger_if = {
                limit = {
                    any_relation = { type = elder }
                }
                any_relation = {
                    type = elder
                    is_ai = yes
                }
            }
            save_temporary_scope_as = temp_char
		}
		any_attending_character = {
			is_ai = yes
			has_activity_intent = debate_gain_disciples_intent
            eligible_for_elder_trigger = { DISCIPLE = scope:temp_char }
		}
	}

	weight = {
		value = 1
	}

	effect = {
		random_attending_character = {
			limit = {
				is_ai = yes
				has_activity_intent = debate_gain_elder_intent
	            trigger_if = {
	                limit = {
	                    any_relation = { type = elder }
	                }
	                any_relation = {
	                    type = elder
	                    is_ai = yes
	                }
	            }
			}
			save_scope_as = first
		}
		random_attending_character = {
			limit = {
				is_ai = yes
				has_activity_intent = debate_gain_disciples_intent
	            eligible_for_elder_trigger = { DISCIPLE = scope:first }
			}
			save_scope_as = second
		}

		add_activity_log_entry = {
			key = apa_found_disciple
			tags = { pulse_action }
			character = scope:first
			target = scope:second
			set_elder_relation_effect = {
				ELDER = scope:second
				DISCIPLE = scope:first
				MERIT = minor_merit_gain
			}
		}
	}
}

apa_debate_fruitful_debate = {
	icon = learning
	is_valid = {
		is_current_phase_active = yes
		any_attending_character = {
			is_ai = yes
			this != scope:host
			this != scope:activity.var:challenged_movement_leader
			top_participant_group:dynastic_cycle ?= {
				NOT = { participant_group_type = undecided_movement }
			}
			save_temporary_scope_as = temp_char
		}
		any_attending_character = {
			is_ai = yes
			this != scope:host
			this != scope:activity.var:challenged_movement_leader
			this != scope:temp_char
			exists = top_participant_group:dynastic_cycle
			is_in_same_movement_as = { TARGET = scope:temp_char }
		}
	}

	weight = {
		value = 1
	}

	effect = {
		random_attending_character = {
			limit = {
				is_ai = yes
				this != scope:host
				this != scope:activity.var:challenged_movement_leader
				top_participant_group:dynastic_cycle ?= {
					NOT = { participant_group_type = undecided_movement }
				}
			}
			save_scope_as = first
		}
		random_attending_character = {
			limit = {
				is_ai = yes
				this != scope:host
				this != scope:activity.var:challenged_movement_leader
				this != scope:first
				exists = top_participant_group:dynastic_cycle
				is_in_same_movement_as = { TARGET = scope:first }
			}
		}
		add_activity_log_entry = {
			key = apa_fruitful_debate
			tags = { pulse_action }
			character = scope:first
			target = scope:second

			scope:second = {
				bp2_lifestyle_xp_gain_per_type_effect = { VALUE = medium }
			}
		}
	}
}