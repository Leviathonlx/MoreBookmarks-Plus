grand_guardian_court_position_task_guard_the_capital = {
	court_position_types = { grand_guardian_court_position }

	# Monthly cost for the task
	cost = {
		round = no
		gold = {
			value = 0
			if = {
				limit = {
					scope:liege = {
						has_treasury = no
					}
				}
				add = {
					value = monthly_court_position_task_cost
					multiply = 2
					desc = COURT_POSITION_TASK_COST_BREAKDOWN_BASE
					format = "BASE_VALUE_FORMAT_DECIMALS_PLUS_NEGATIVE"
				}
			}
		}
		treasury = {
			value = 0
			if = {
				limit = {
					scope:liege = {
						has_treasury = yes
					}
				}
				add = {
					value = monthly_court_position_task_cost
					multiply = 2
					desc = COURT_POSITION_TASK_COST_BREAKDOWN_BASE
					format = "BASE_VALUE_FORMAT_DECIMALS_PLUS_NEGATIVE"
				}
			}
		}
	}

	scaling_employer_modifiers = {
		terrible = {
			character_capital_county_monthly_control_add = 0.1
		 	enemy_hostile_scheme_success_chance_growth_add = -0.1
		}
		poor = {
			character_capital_county_monthly_control_add = 0.15
		 	enemy_hostile_scheme_success_chance_growth_add = -0.2
		}
		average = {
			character_capital_county_monthly_control_add = 0.2
		 	enemy_hostile_scheme_success_chance_growth_add = -0.4
		}
		good = {
			character_capital_county_monthly_control_add = 0.25
		 	enemy_hostile_scheme_success_chance_growth_add = -0.6
		}
		excellent = {
			character_capital_county_monthly_control_add = 0.3
		 	enemy_hostile_scheme_success_chance_growth_add = -1
		}
	}

	on_start = {
		remove_other_grand_guardian_modifiers_effect = yes
		scope:liege ?= {
			capital_province = {
				add_province_modifier = grand_guardian_guard_the_capital_modifier
			}
		}
	}

	on_end = {
		scope:liege ?= {
			# We check and scope to all counties to make sure we remove any stray modifiers in case the capital is moved, etc.
			if = {
				limit = {
					any_realm_county = {
						any_county_province = {
							has_province_modifier = grand_guardian_guard_the_capital_modifier
						}
					}
				}
				every_realm_county = {
					limit = {
						any_county_province = {
							has_province_modifier = grand_guardian_guard_the_capital_modifier
						}
					}
					every_county_province = {
						limit = {
							has_province_modifier = grand_guardian_guard_the_capital_modifier
						}
						remove_province_modifier = grand_guardian_guard_the_capital_modifier
					}
				}
			}
		}
	}

	ai_will_do = {
		value = 25
		if = {
			limit = {
				has_trait = paranoid
			}
			add = 50
		}
	}
}

grand_guardian_court_position_task_shield_the_realm = {
	court_position_types = { grand_guardian_court_position }

	# Monthly cost for the task
	cost = {
		round = no
		gold = {
			value = 0
			if = {
				limit = {
					scope:liege = {
						has_treasury = no
					}
				}
				add = {
					value = monthly_court_position_task_cost
					multiply = 2
					desc = COURT_POSITION_TASK_COST_BREAKDOWN_BASE
					format = "BASE_VALUE_FORMAT_DECIMALS_PLUS_NEGATIVE"
				}
			}
		}
		treasury = {
			value = 0
			if = {
				limit = {
					scope:liege = {
						has_treasury = yes
					}
				}
				add = {
					value = monthly_court_position_task_cost
					multiply = 2
					desc = COURT_POSITION_TASK_COST_BREAKDOWN_BASE
					format = "BASE_VALUE_FORMAT_DECIMALS_PLUS_NEGATIVE"
				}
			}
		}
	}

	scaling_employer_modifiers = {
		terrible = {
			defender_advantage = 1
			controlled_province_advantage = 1
			retreat_losses = -0.1
		}
		poor = {
			defender_advantage = 3
			controlled_province_advantage = 3
			retreat_losses = -0.2
		}
		average = {
			defender_advantage = 5
			controlled_province_advantage = 5
			retreat_losses = -0.3
		}
		good = {
			defender_advantage = 7
			controlled_province_advantage = 7
			retreat_losses = -0.4
		}
		excellent = {
			defender_advantage = 9
			controlled_province_advantage = 9
			retreat_losses = -0.5
		}
	}

	ai_will_do = {
		value = 25
		if = {
			limit = {
				has_trait = craven
			}
			add = 50
		}
	}
}

grand_guardian_court_position_task_instill_martial_discipline = {
	court_position_types = { grand_guardian_court_position }

	# Monthly cost for the task
	cost = {
		round = no
		gold = {
			value = 0
			if = {
				limit = {
					scope:liege = {
						has_treasury = no
					}
				}
				add = {
					value = monthly_court_position_task_cost
					multiply = 2
					desc = COURT_POSITION_TASK_COST_BREAKDOWN_BASE
					format = "BASE_VALUE_FORMAT_DECIMALS_PLUS_NEGATIVE"
				}
			}
		}
		treasury = {
			value = 0
			if = {
				limit = {
					scope:liege = {
						has_treasury = yes
					}
				}
				add = {
					value = monthly_court_position_task_cost
					multiply = 2
					desc = COURT_POSITION_TASK_COST_BREAKDOWN_BASE
					format = "BASE_VALUE_FORMAT_DECIMALS_PLUS_NEGATIVE"
				}
			}
		}
	}

	scaling_employer_modifiers = {
		terrible = {
			levy_reinforcement_rate = 0.1
			knight_effectiveness_mult = 0.05
			monthly_martial_lifestyle_xp_gain_mult = 0.05
		}
		poor = {
			levy_reinforcement_rate = 0.15
			knight_effectiveness_mult = 0.1
			monthly_martial_lifestyle_xp_gain_mult = 0.1
		}
		average = {
			levy_reinforcement_rate = 0.2
			knight_effectiveness_mult = 0.15
			monthly_martial_lifestyle_xp_gain_mult = 0.15
		}
		good = {
			levy_reinforcement_rate = 0.25
			knight_effectiveness_mult = 0.2
			monthly_martial_lifestyle_xp_gain_mult = 0.2
		}
		excellent = {
			levy_reinforcement_rate = 0.3
			knight_effectiveness_mult = 0.3
			monthly_martial_lifestyle_xp_gain_mult = 0.3
		}
	}

	ai_will_do = {
		value = 25
		add = {
			value = ai_boldness
		}
	}
}
