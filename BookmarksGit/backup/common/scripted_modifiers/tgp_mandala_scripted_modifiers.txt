
#High stats makes bad thing less likely
#Devaraja Piety Level
mandala_devaraja_piety_level_remove_weight_modifier = {
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			has_mandala_capital_trigger = no
			piety_level > scope:recipient.piety_level
		}
		add = -10
		desc = devaraja_actor_piety_level
	}
}

#High stats makes good thing more likely
#Mandala Ruler Piety Level
mandala_devaraja_piety_level_add_weight_modifier = {
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			has_mandala_capital_trigger = no
			piety_level > scope:recipient.piety_level
		}
		add = 10
		desc = devaraja_actor_piety_level
	}
}


#Tributary Relative Size
subject_realm_size_add_weight_modifier = {
	modifier = {
		$DEVARAJA$ = { government_has_flag = government_is_mandala }
		$SUBJECT$ = { realm_size > 2 }
		add = {
			add = 10
			multiply = $SUBJECT$.realm_size
		}
		desc = tributary_actor_realm_size
	}
}

#Tributary Relative Size
subject_realm_size_lose_weight_modifier = {
	modifier = {
		$DEVARAJA$ = { government_has_flag = government_is_mandala }
		$SUBJECT$ = { realm_size > 2 }
		add = {
			add = -10
			multiply = $SUBJECT$.realm_size
		}
		desc = tributary_recipient_realm_size
	}
}


mandala_devaraja_capital_remove_weight_modifier = {
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = first_tier_mandala_capital_building }
		}
		$TRIBUTARY$ = { government_has_flag = government_is_mandala }
		add = -10
		desc = devaraja_capital_01
	}
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = second_tier_mandala_capital_building }
		}
		$TRIBUTARY$ = { government_has_flag = government_is_mandala }
		add = -25
		desc = devaraja_capital_02
	}
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = third_tier_mandala_capital_building }
		}
		$TRIBUTARY$ = { government_has_flag = government_is_mandala }
		add = -50
		desc = devaraja_capital_03
	}
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = fourth_tier_mandala_capital_building }
		}
		add = -75
		desc = devaraja_capital_04
	}
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = final_tier_mandala_capital_building }
		}
		add = -100
		desc = devaraja_capital_05
	}
}

#Only from the third Capital tier and up
mandala_devaraja_capital_min_third_remove_weight_modifier = {
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = third_tier_mandala_capital_building }
		}
		$TRIBUTARY$ = { government_has_flag = government_is_mandala }
		add = -15
		desc = devaraja_capital_03
	}
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = fourth_tier_mandala_capital_building }
		}
		add = -25
		desc = devaraja_capital_04
	}
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = final_tier_mandala_capital_building }
		}
		add = -50
		desc = devaraja_capital_05
	}
}

mandala_devaraja_capital_add_weight_modifier = {
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = first_tier_mandala_capital_building }
		}
		$TRIBUTARY$ = { government_has_flag = government_is_mandala }
		add = 10
		desc = devaraja_capital_01
	}
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = second_tier_mandala_capital_building }
		}
		$TRIBUTARY$ = { government_has_flag = government_is_mandala }
		add = 25
		desc = devaraja_capital_02
	}
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = third_tier_mandala_capital_building }
		}
		$TRIBUTARY$ = { government_has_flag = government_is_mandala }
		add = 50
		desc = devaraja_capital_03
	}
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = fourth_tier_mandala_capital_building }
		}
		add = 75
		desc = devaraja_capital_04
	}
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = final_tier_mandala_capital_building }
		}
		add = 100
		desc = devaraja_capital_05
	}
}

#Only from the third Capital tier and up
mandala_devaraja_capital_min_third_add_weight_modifier = {
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = third_tier_mandala_capital_building }
		}
		$TRIBUTARY$ = { government_has_flag = government_is_mandala }
		add = 15
		desc = devaraja_capital_03
	}
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = fourth_tier_mandala_capital_building }
		}
		add = 25
		desc = devaraja_capital_04
	}
	modifier = {
		$DEVARAJA$ = { 
			government_has_flag = government_is_mandala
			capital_province = { has_building_with_flag = final_tier_mandala_capital_building }
		}
		add = 50
		desc = devaraja_capital_05
	}
}


mandala_devaraja_actor_amount_of_subjects_add_weight_modifier = {
	#Mandala subject
	modifier = {
		$DEVARAJA$ = { government_has_flag = government_is_mandala }
		government_has_flag = government_is_mandala
		add = {
			add = mandala_subject_value
			multiply = $DEVARAJA$.mandala_subject_value
			if = {
				limit = { $DEVARAJA$.mandala_subject_value = 0 }
				subtract = mandala_subject_value
			}
		}
		desc = devaraja_actor_amount_of_subjects
	}
	#Non-Mandala subject
	modifier = {
		$DEVARAJA$ = { government_has_flag = government_is_mandala }
		$TRIBUTARY$ = { 
			NOT = { government_has_flag = government_is_mandala } 
		}
		add = {
			add = regular_subject_value
			multiply = $DEVARAJA$.mandala_subject_value
			if = {
				limit = { $DEVARAJA$.mandala_subject_value = 0 }
				subtract = mandala_subject_value
			}
		}
		desc = devaraja_actor_amount_of_subjects
	}
}

mandala_devaraja_actor_amount_of_subjects_remove_weight_modifier = {
	#Mandala subject
	modifier = {
		$DEVARAJA$ = { government_has_flag = government_is_mandala }
		government_has_flag = government_is_mandala
		add = {
			subtract = mandala_subject_value
			multiply = $DEVARAJA$.mandala_subject_value
			if = {
				limit = { $DEVARAJA$.mandala_subject_value = 0 }
				add = mandala_subject_value
			}
		}
		desc = devaraja_actor_amount_of_subjects
	}
	#Non-Mandala subject
	modifier = {
		$DEVARAJA$ = { government_has_flag = government_is_mandala }
		$TRIBUTARY$ = { 
			NOT = { government_has_flag = government_is_mandala } 
		}
		add = {
			subtract = regular_subject_value
			multiply = $DEVARAJA$.mandala_subject_value
			if = {
				limit = { $DEVARAJA$.mandala_subject_value = 0 }
				add = mandala_subject_value
			}
		}
		desc = devaraja_actor_amount_of_subjects
	}
}

mandala_devaraja_recipient_amount_of_subjects_add_weight_modifier = {
	#Mandala subject
	modifier = {
		$DEVARAJA$ = { government_has_flag = government_is_mandala }
		government_has_flag = government_is_mandala
		add = {
			add = mandala_subject_value
			multiply = $DEVARAJA$.mandala_subject_value
			if = {
				limit = { $DEVARAJA$.mandala_subject_value = 0 }
				subtract = mandala_subject_value
			}
		}
		desc = devaraja_recipient_amount_of_subjects
	}
	#Non-Mandala subject
	modifier = {
		$DEVARAJA$ = { government_has_flag = government_is_mandala }
		$TRIBUTARY$ = { 
			NOT = { government_has_flag = government_is_mandala } 
		}
		add = {
			add = regular_subject_value
			multiply = $DEVARAJA$.mandala_subject_value
			if = {
				limit = { $DEVARAJA$.mandala_subject_value = 0 }
				subtract = mandala_subject_value
			}
		}
		desc = devaraja_recipient_amount_of_subjects
	}
}

mandala_devaraja_recipient_amount_of_subjects_remove_weight_modifier = {
	#Mandala subject
	modifier = {
		$DEVARAJA$ = { government_has_flag = government_is_mandala }
		government_has_flag = government_is_mandala
		add = {
			subtract = mandala_subject_value
			multiply = $DEVARAJA$.mandala_subject_value
			if = {
				limit = { $DEVARAJA$.mandala_subject_value = 0 }
				add = mandala_subject_value
			}
		}
		desc = devaraja_recipient_amount_of_subjects
	}
	#Non-Mandala subject
	modifier = {
		$DEVARAJA$ = { government_has_flag = government_is_mandala }
		$TRIBUTARY$ = { 
			NOT = { government_has_flag = government_is_mandala } 
		}
		add = {
			subtract = regular_subject_value
			multiply = $DEVARAJA$.mandala_subject_value
			if = {
				limit = { $DEVARAJA$.mandala_subject_value = 0 }
				add = mandala_subject_value
			}
		}
		desc = devaraja_recipient_amount_of_subjects
	}
}

turn_subject_into_mandala_acceptance_modifier = {
	# Mandala Radiance
	modifier = {
		scope:actor = { has_mandala_capital_trigger = yes }
		add = scope:actor.mandala_radiance_value
		desc = actor_positive_mandala_radiance
	}
	opinion_modifier = { # Opinion Factor
		who = scope:recipient
		opinion_target = scope:actor
		multiplier = 0.5
		desc = AI_OPINION_REASON
	}
	ai_value_modifier = {
		ai_rationality = 0.5 	#It's practical
		ai_energy = 1 			#It's a change
		ai_boldness = -0.25		#They might defy you
		ai_sociability = 0.25 	#They wanna please you
	}
	# They are afraid of you
	modifier = {
		scope:recipient = {
			has_dread_level_towards = {
				target = scope:actor
				level = 1
			}
		}
		add = 30
	}
	modifier = {
		scope:recipient = {
			has_dread_level_towards = {
				target = scope:actor
				level = 2
			}
		}
		add = 60
	}
	# Faith hostility
	modifier = {
		faith = {
			faith_hostility_level = {
				target = scope:actor.faith
				value >= faith_astray_level
			}
		}
		add = {
			value = "faith.faith_hostility_level(scope:actor.faith)"
			multiply = -10
		}
		desc = FAITH_HOSTILITY_LEVEL
	}
	# Cultural acceptance
	modifier = {
		culture != scope:actor.culture
		"scope:recipient.culture.cultural_acceptance(scope:actor.culture)" < 50
		add = {
			value = 50
			subtract = "scope:recipient.culture.cultural_acceptance(scope:actor.culture)"
			multiply = -0.25
			round = yes
		}
		desc = CULTURAL_ACCEPTANCE
	}
	# Cultural acceptance
	modifier = {
		culture = { has_cultural_pillar = ethos_spiritual }
		add = 20
		desc = SPIRITUAL_ETHOS_REASON
	}
	# Spend Piety
	modifier = {
		desc = PIETY_REASON
		scope:piety = yes
		add = {
			value = 30
			multiply = scope:actor.piety_level
			min = 5
		}
	}
	modifier = {
		desc = ASK_FOR_CONVERSION_ACTOR_HAS_REVERENCE_DECREE
		scope:recipient = { is_independent_ruler = no }
		scope:actor = {
			has_realm_law_flag = can_convert_all_subjects_to_mandalas #Unlocks interaction vs tributaries, and boost acceptance for vassals
		}
		add = 25
	}
	
	# Warning
	modifier = {
		desc = might_ask_for_something_in_return_warning_line_break
		add = 0
	}
}
