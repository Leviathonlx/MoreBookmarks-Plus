#####################
# IMPERIAL POLICIES #
#####################

@imperial_policy_laws_cooldown_value = 10
@imperial_policy_cost_value = 500

imperial_policy_laws = {
	default = manor_reform_law
	cumulative = no
	flag = imperial_policy

	defense_mobilization_law = {
		flag = defense_mobilization_law

		can_keep = {
			realm_law_use_imperial_policy_trigger = yes
			trigger_if = {
				limit = { is_independent_ruler = no }
				liege = { has_realm_law = defense_mobilization_law }
			}
		}

		can_pass = {
			trigger_if = {
				limit = {
					top_liege = this
				}
				custom_tooltip = {
					text = imperial_policy_laws_cooldown_desc
					NOT = { has_variable = imperial_policy_laws_cooldown }
				}
			}
			tgp_japan_defense_mobilization_valid_trigger = yes
		}

		on_pass = {
			## Set cooldown
			set_variable = {
				name = imperial_policy_laws_cooldown
				years = @imperial_policy_laws_cooldown_value
			}
			tgp_imperial_policy_event_effect = yes
		}

		modifier = {
			same_heritage_county_advantage_add = 5
			men_at_arms_maintenance = -0.15
			fort_level = 1
			hostile_raid_time = 0.15
		}
		flag = governors_may_recruit_japanese_horse_archers
		flag = cheaper_japanese_domicile_military_buildings

		pass_cost = {
			prestige = @imperial_policy_cost_value
		}

		ai_will_do = {
			value = 250
		}
	}

	disarmament_law = {
		flag = disarmament_law
		flag = vassal_internal_wars_cost_doubled
		flag = japan_administrative_can_build_castles

		can_keep = {
			realm_law_use_imperial_policy_trigger = yes
			trigger_if = {
				limit = { is_independent_ruler = no }
				liege = { has_realm_law = disarmament_law }
			}
		}
		
		can_pass = {
			trigger_if = {
				limit = {
					top_liege = this
				}
				custom_tooltip = {
					text = imperial_policy_laws_cooldown_desc
					NOT = { has_variable = imperial_policy_laws_cooldown }
				}
			}
		}

		on_pass = {
			## Set cooldown
			set_variable = {
				name = imperial_policy_laws_cooldown
				years = @imperial_policy_laws_cooldown_value
			}
			tgp_imperial_policy_event_effect = yes
		}

		modifier = {
			men_at_arms_recruitment_cost = 0.25
			japan_feudal_government_vassal_opinion = -15
			development_growth_factor = 0.15
		}

		pass_cost = {
			prestige = @imperial_policy_cost_value
		}

		ai_will_do = {
			value = 200
			if = {
				limit = {
					ai_has_warlike_personality = yes
				}
				value = -50
			}
			if = {
				limit = { government_has_flag = government_is_japan_feudal }
				add = -1000
			}
		}
	}

	isolation_law = {
		flag = isolation_law
		flag = better_physician_treatments

		can_keep = {
			realm_law_use_imperial_policy_trigger = yes
			trigger_if = {
				limit = { is_independent_ruler = no }
				liege = { has_realm_law = isolation_law }
			}
		}
		
		can_pass = {
			trigger_if = {
				limit = {
					top_liege = this
				}
				custom_tooltip = {
					text = imperial_policy_laws_cooldown_desc
					NOT = { has_variable = imperial_policy_laws_cooldown }
				}
			}
		}

		on_pass = {
			## Set cooldown
			set_variable = {
				name = imperial_policy_laws_cooldown
				years = @imperial_policy_laws_cooldown_value
			}
			tgp_imperial_policy_event_effect = yes
		}

		modifier = {
			development_growth_factor = -0.15
			epidemic_resistance = 15
			diplomatic_range_mult = -0.15
		}

		pass_cost = {
			prestige = @imperial_policy_cost_value
		}

		ai_will_do = {
			value = 0
			if = {
				limit = {
					any_realm_county = {
						any_county_province = {
							any_province_epidemic = {
								count >= 1
								outbreak_intensity >= apocalyptic
							}
						}
					}
				}
				add = 200
			}
		}
	}

	imperial_expansion_law = {
		flag = imperial_expansion_law
		flag = cheaper_japanese_domicile_military_buildings

		can_keep = {
			realm_law_use_imperial_policy_trigger = yes
			trigger_if = {
				limit = { is_independent_ruler = no }
				liege = { has_realm_law = imperial_expansion_law }
			}
		}

		can_pass = { 
			trigger_if = {
				limit = {
					top_liege = this
				}
				custom_tooltip = {
					text = imperial_policy_laws_cooldown_desc
					NOT = { has_variable = imperial_policy_laws_cooldown }
				}
				# Filtered with 'trigger_if' to make nicer tooltips
				trigger_if = {
					limit = {
						NOR = {
							has_realm_law = japanese_bureaucracy_2
							has_realm_law = japanese_bureaucracy_3
						}
					}
					has_realm_law = japanese_bureaucracy_2
				}
				trigger_if = {
					limit = {
						NOR = {
							has_realm_law = japanese_bureaucracy_2
							has_realm_law = japanese_bureaucracy_3
						}
					}
					has_realm_law = japanese_bureaucracy_3
				}
				is_at_war = no
			}
		}

		on_pass = {
			## Set cooldown
			set_variable = {
				name = imperial_policy_laws_cooldown
				years = @imperial_policy_laws_cooldown_value
			}
			tgp_imperial_policy_event_effect = yes
		}

		modifier = {
			mercenary_hire_cost_mult = -0.15
			men_at_arms_recruitment_cost = -0.15
			japan_administrative_government_vassal_opinion = -35
			travel_danger = 20
		}

		pass_cost = {
			prestige = @imperial_policy_cost_value
		}

		ai_will_do = {
			value = 80
			if = {
				limit = {
					ai_has_warlike_personality = yes
				}
				add = 50
			}
			if = {
				limit = { government_has_flag = government_is_japan_administrative }
				add = -1000
			}
		}
	}

	manor_reform_law = {
		flag = manor_reform_law

		can_keep = {
			realm_law_use_imperial_policy_trigger = yes
			trigger_if = {
				limit = { is_independent_ruler = no }
				liege = { has_realm_law = manor_reform_law }
			}
		}
		
		can_pass = {
			trigger_if = {
				limit = {
					top_liege = this
				}
				custom_tooltip = {
					text = imperial_policy_laws_cooldown_desc
					NOT = { has_variable = imperial_policy_laws_cooldown }
				}
			}
		}

		on_pass = {
			## Set cooldown
			set_variable = {
				name = imperial_policy_laws_cooldown
				years = @imperial_policy_laws_cooldown_value
			}
			tgp_imperial_policy_event_effect = yes
		}
		
		should_start_with = {
			realm_law_use_imperial_policy_trigger = yes
		}

		modifier = {
			domicile_build_gold_cost = 0.25
			domicile_monthly_influence_mult = -0.25
			domicile_build_speed = 0.25
			build_gold_cost = -0.15
			build_speed = -0.15
			japan_administrative_government_vassal_opinion = -15
		}

		pass_cost = {
			prestige = @imperial_policy_cost_value
		}

		ai_will_do = {
			value = 100
			if = {
				limit = {
					ai_has_builder_or_pious_builder_personality = yes
				}
				add = 25
			}
			if = {
				limit = { government_has_flag = government_is_japan_administrative }
				add = -100
			}
		}
	}

	bandit_crackdown_law = {
		flag = bandit_crackdown_law

		can_keep = {
			realm_law_use_imperial_policy_trigger = yes
			trigger_if = {
				limit = { is_independent_ruler = no }
				liege = { has_realm_law = bandit_crackdown_law }
			}
		}
		
		can_pass = {
			trigger_if = {
				limit = {
					top_liege = this
				}
				custom_tooltip = {
					text = imperial_policy_laws_cooldown_desc
					NOT = { has_variable = imperial_policy_laws_cooldown }
				}
			}
		}

		on_pass = {
			## Set cooldown
			set_variable = {
				name = imperial_policy_laws_cooldown
				years = @imperial_policy_laws_cooldown_value
			}
			tgp_imperial_policy_event_effect = yes
		}

		modifier = {
			city_holding_build_gold_cost = -0.1
			barons_and_minor_landholders_opinion = 15
			monthly_county_control_growth_factor = 0.05
			monthly_county_control_growth_add = 0.2
			development_growth_factor = -0.15
			travel_danger = -10
		}

		pass_cost = {
			prestige = @imperial_policy_cost_value
		}

		ai_will_do = {
			value = 0
			if = {
				limit = { capital_county.county_control <= low_county_control }
				add = 150
			}
		}
	}
}
