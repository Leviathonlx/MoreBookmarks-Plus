##############################################
#
# CULTURE
#
##############################################

make_socotra_culture_effect = {
	#Convert your, and your whole family's, culture
	set_culture = culture:soqotri
	if = {
		limit = {
			knows_language = language_arabic
		}
		unlearn_language = language_arabic
	}
	if = {
		limit = {
			is_married = yes
			any_spouse = { is_landed = no }
		}
		every_spouse = {
			set_culture = culture:soqotri
			if = {
				limit = {
					knows_language = language_arabic
				}
				unlearn_language = language_arabic
			}
		}
	}
	if = {
		limit = {
			any_close_family_member = {
				is_landed = no
			}
		}
		every_close_family_member = {
			custom = all_family_members
			limit = {
				is_landed = no
			}
			set_culture = culture:soqotri
			if = {
				limit = {
					knows_language = language_arabic
				}
				unlearn_language = language_arabic
			}
		}
	}

	#Convert appropriate vassals, and their family
	if = {
		limit = {
			OR = {
				any_vassal = {
					is_ai = yes
				}
				any_courtier = {
					is_ai = yes
				}			
			}
		}
		every_vassal = {
			limit = {
				is_ai = yes
			}
			set_culture = culture:soqotri
			unlearn_language = language_arabic
			hidden_effect = {
				if = {
					limit = { any_spouse = { is_landed = no } }
					every_spouse = {
						set_culture = culture:soqotri
						if = {
							limit = {
								knows_language = language_arabic
							}
							unlearn_language = language_arabic
						}
					}
				}
				if = {
					limit = {
						any_close_family_member = {
							is_landed = no
						}
					}
					every_close_family_member = {
						limit = {
							is_landed = no
						}
						set_culture = culture:soqotri
						if = {
							limit = {
								knows_language = language_arabic
							}
							unlearn_language = language_arabic
						}
					}
				}
			}
		}
		every_courtier = {
			limit = {
				is_ai = yes
			}
			set_culture = culture:soqotri
			if = {
				limit = {
					knows_language = language_arabic
				}
				unlearn_language = language_arabic
			}
			hidden_effect = {
				if = {
					limit = { any_spouse = { is_landed = no } }
					every_spouse = {
						set_culture = culture:soqotri
						if = {
							limit = {
								knows_language = language_arabic
							}
							unlearn_language = language_arabic
						}
					}
				}
				if = {
					limit = {
						any_close_family_member = {
							is_landed = no
						}
					}
					every_close_family_member = {
						limit = {
							is_landed = no
						}
						set_culture = culture:soqotri
						if = {
							limit = {
								knows_language = language_arabic
							}
							unlearn_language = language_arabic
						}
					}
				}
			}
		}
	}
}

# Recursively changes cultural acceptance from a list
# Scope: VARIABLE, VALUE
setup_cultural_friends = {
	every_in_global_list = {
		variable = $VARIABLE$
		every_in_global_list = {
			limit = {
				NOT = { this = prev }
			}
			variable = $VARIABLE$
			change_cultural_acceptance = {
				target = prev
				value = $VALUE$
				desc = cultural_acceptance_historical_relations
			}
		}
		remove_list_global_variable = {
			name = $VARIABLE$
			target = this
		}
	}
}

setup_german_friendship = {
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:bavarian
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:saxon
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:westphalian
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:east_elbian
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:german_pommeranian
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:prussian_g
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:ripuarian
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:franconian
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:szasz
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:thuringian
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:german_silesian
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:swabian
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:high_alemannic
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:alsatian
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:frisian
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:low_frankish
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:brabantian
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:dutch
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:walloon
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:flemish
	}
	add_to_global_variable_list = {
		name = mb_german_culture_friendship
		target = culture:czech
	}
	setup_cultural_friends = { VARIABLE = mb_german_culture_friendship VALUE = 20 }
}

setup_italian_friendship = {
	add_to_global_variable_list = {
		name = mb_italian_culture_friendship
		target = culture:friulian
	}
	add_to_global_variable_list = {
		name = mb_italian_culture_friendship
		target = culture:romansh
	}
	add_to_global_variable_list = {
		name = mb_italian_culture_friendship
		target = culture:ligurian
	}
	add_to_global_variable_list = {
		name = mb_italian_culture_friendship
		target = culture:italian
	}
	add_to_global_variable_list = {
		name = mb_italian_culture_friendship
		target = culture:tuscan_ce
	}
	add_to_global_variable_list = {
		name = mb_italian_culture_friendship
		target = culture:cisalpine
	}
	add_to_global_variable_list = {
		name = mb_italian_culture_friendship
		target = culture:venetian_ce
	}
	setup_cultural_friends = { VARIABLE = mb_italian_culture_friendship VALUE = 20 }
}
