##########################################SUCCESSION EXPANDED COMPATCH##########################################
#DECISIONS WILL NOT SHOW WITHOUT IT LOADED

adopt_co_kingship = {
	picture = "gfx/interface/illustrations/decisions/decision_dynasty_house.dds"

	ai_check_interval = 60
	selection_tooltip = adopt_co_kingship_selection_tooltip
	desc = adopt_co_kingship_desc
	confirm_text = adopt_co_kingship_confirm_text
	is_shown = {
	
		AND = { exists = global_var:SE_is_loaded }
		
		any_held_title = {
			has_title_law = feudal_elective_succession_law
			tier > 3
			NOT = {
				is_target_in_global_variable_list = {
					name = cokingship_list
					target = this
				}
			}
		}
		culture = {
			has_innovation = innovation_hereditary_rule
		}
	}
	is_valid_showing_failures_only = {
		custom_description = {
			OR = {
				is_ai = no
				AND = {
					is_ai = yes
					any_child = {
						exists = this
					}
				}
			}
			text = coking_ai_restrictions_loc
		}
	}
	is_valid = {
		custom_description = {
			any_held_title = {
				has_title_law = feudal_elective_succession_law
				tier > 3
				NOT = {
					is_target_in_global_variable_list = {
						name = cokingship_list
						target = this
					}
				}
			}
			text = cokingship_doesnt_exist_loc
		}
		dynasty = {
			dynasty_prestige_level >= 4
		}
		culture = {
			has_innovation = innovation_hereditary_rule
		}
		can_change_title_law_trigger = yes
	}
	cost = {
		prestige = 1000
	}
	effect = {
		custom_description = {
			every_held_title = {
				limit = {
					has_title_law = feudal_elective_succession_law
					tier > 3
					NOT = {
						is_target_in_global_variable_list = {
							name = cokingship_list
							target = this
						}
					}
				}
				add_to_global_variable_list = {
					name = cokingship_list
					target = this
				}
			}
			text = cokingship_effect_title_loc
		}
		custom_description = {
			every_held_title = {
				limit = {
					has_title_law = feudal_elective_succession_law
					tier > 3
				}
				every_de_jure_county_holder = {
					limit = {
						this.liege = root
						NOT = {
							this.dynasty = root.dynasty
						}
					}
					add_opinion = {
						target = root
						modifier = subverted_election
						opinion = -30
					}
				}
			}
			text = cokingship_effect_vassal_loc
		}
	}
	ai_potential = {
		any_held_title = {
			has_title_law = feudal_elective_succession_law
			tier > 3
			NOT = {
				is_target_in_global_variable_list = {
					name = cokingship_list
					target = this
				}
				this.current_heir.dynasty = root.dynasty
			}
		}
	}
	ai_will_do = {
		base = 50
	}
}
saxon_elective_ai = {
	ai_goal = yes
	is_shown = {
		
		AND = { exists = global_var:SE_is_loaded }
		
		is_ai = yes
	}
	is_valid = {
		is_ai = yes
		OR = {
			government_has_flag = government_is_feudal
			government_has_flag = government_is_tribal
		}
		OR = {
			highest_held_title_tier >= tier_kingdom
			AND = {
				highest_held_title_tier = 3
				is_independent_ruler = yes
			}
		}
		can_change_title_law_trigger = yes
		culture = { 
			has_cultural_parameter = witenagemot_succession_enabled 
			has_cultural_pillar = heritage_west_germanic
		}
		NOT = {
			primary_title = {
				has_title_law = saxon_elective_succession_law
			}
		}
		any_held_title = {
			NOR = {
				has_title_law = gaelic_elective_succession_law
				has_title_law = imperial_elective_succession_law
				has_title_law = scandinavian_elective_succession_law
				has_title_law = eldership_elective_succession_law
				has_title_law = princely_elective_succession_law
				has_title_law = feudal_elective_succession_law
				has_title_law = outremer_elective_succession_law
				has_title_law = mahestan_elective_succession_law
				has_title_law = royal_elective_succession_law
				has_title_law = kurultai_elective_succession_law
			}
		}
	}
	effect = {
		every_held_title = {
			limit = { has_title_law = saxon_elective_succession_law }
			clear_title_laws = yes
		}
		primary_title = {
			add_title_law = saxon_elective_succession_law
		}
	}
	ai_will_do = {
		base = 100
	}
}
scandinavian_elective_ai = {
	ai_goal = yes
	is_shown = {
	
		AND = { exists = global_var:SE_is_loaded }
		
		is_ai = yes
	}
	is_valid = {
		is_ai = yes
		OR = {
			government_has_flag = government_is_feudal
			government_has_flag = government_is_tribal
		}
		OR = {
			highest_held_title_tier >= tier_kingdom
			AND = {
				highest_held_title_tier = 3
				is_independent_ruler = yes
			}
		}
		can_change_title_law_trigger = yes
		culture = { 
			has_cultural_parameter = scandinavian_elective_enabled 
			has_cultural_pillar = heritage_north_germanic
		}
		NOT = {
			primary_title = {
				has_title_law = scandinavian_elective_succession_law
			}
		}
		any_held_title = {
			NOR = {
				has_title_law = saxon_elective_succession_law
				has_title_law = gaelic_elective_succession_law
				has_title_law = imperial_elective_succession_law
				has_title_law = eldership_elective_succession_law
				has_title_law = princely_elective_succession_law
				has_title_law = feudal_elective_succession_law
				has_title_law = outremer_elective_succession_law
				has_title_law = mahestan_elective_succession_law
				has_title_law = royal_elective_succession_law
				has_title_law = kurultai_elective_succession_law
			}
		}
	}
	effect = {
		every_held_title = {
			limit = {
				has_title_law = scandinavian_elective_succession_law 
			}
			clear_title_laws = yes
		}
		primary_title = {
			add_title_law = scandinavian_elective_succession_law
		}
	}
	ai_will_do = {
		base = 100
	}
}
gaelic_elective_ai = {
	ai_goal = yes
	is_shown = {
	
		AND = { exists = global_var:SE_is_loaded }
		
		is_ai = yes
	}
	is_valid = {
		is_ai = yes
		OR = {
			government_has_flag = government_is_feudal
			government_has_flag = government_is_tribal
		}
		highest_held_title_tier >= tier_duchy
		can_change_title_law_trigger = yes
		OR = {
			has_culture = culture:irish
			AND = {
				has_culture = culture:gaelic
				current_date < 1050.1.1
			}
		}
		NOT = {
			primary_title = {
				has_title_law = gaelic_elective_succession_law
			}
		}
		any_held_title = {
			NOR = {
				has_title_law = saxon_elective_succession_law
				has_title_law = imperial_elective_succession_law
				has_title_law = scandinavian_elective_succession_law
				has_title_law = eldership_elective_succession_law
				has_title_law = princely_elective_succession_law
				has_title_law = feudal_elective_succession_law
				has_title_law = outremer_elective_succession_law
				has_title_law = mahestan_elective_succession_law
				has_title_law = royal_elective_succession_law
				has_title_law = kurultai_elective_succession_law
			}
		}
	}
	effect = {
		every_held_title = {
			limit = { has_title_law = gaelic_elective_succession_law }
			clear_title_laws = yes
		}
		primary_title = {
			add_title_law = gaelic_elective_succession_law
		}
	}
	ai_will_do = {
		base = 100
	}
}
eldership_elective_ai = {
	ai_goal = yes
	is_shown = {
	
		AND = { exists = global_var:SE_is_loaded }
		
		is_ai = yes
	}
	is_valid = {
		is_ai = yes
		OR = {
			government_has_flag = government_is_feudal
			government_has_flag = government_is_tribal
		}
		OR = {
			this.religion = religion:baltic_religion
			this.religion = religion:west_african_religion
			this.religion = religion:akom_religion
			this.religion = religion:west_african_roog_religion
			this.religion = religion:west_african_orisha_religion
		}
		highest_held_title_tier >= tier_duchy
		can_change_title_law_trigger = yes
		faith = {
			has_doctrine = tenet_ancestor_worship
		}
		NOT = {
			primary_title = {
				has_title_law = eldership_elective_succession_law
			}
		}
		any_held_title = {
			NOR = {
				has_title_law = saxon_elective_succession_law
				has_title_law = gaelic_elective_succession_law
				has_title_law = imperial_elective_succession_law
				has_title_law = scandinavian_elective_succession_law
				has_title_law = princely_elective_succession_law
				has_title_law = feudal_elective_succession_law
				has_title_law = outremer_elective_succession_law
				has_title_law = mahestan_elective_succession_law
				has_title_law = royal_elective_succession_law
				has_title_law = kurultai_elective_succession_law
			}
		}
	}
	effect = {
		every_held_title = {
			limit = { has_title_law = eldership_elective_succession_law }
			clear_title_laws = yes
		}
		primary_title = {
			add_title_law = eldership_elective_succession_law
		}
	}
	ai_will_do = {
		base = 100
	}
}
mahestan_elective_ai = {
	ai_goal = yes
	is_shown = {
	
		AND = { exists = global_var:SE_is_loaded }
		
		is_ai = yes
	}
	is_valid = {
		is_ai = yes
		OR = {
			government_has_flag = government_is_feudal
		}
		highest_held_title_tier >= tier_kingdom
		is_independent_ruler = yes
		can_change_title_law_trigger = yes
		has_religion = religion:zoroastrianism_religion
		any_in_global_list = {
			variable = unavailable_unique_decisions
			this = flag:flag_became_saoshyant
		}
		NOT = {
			primary_title = {
				has_title_law = mahestan_elective_succession_law
			}
		}
		any_held_title = {
			NOR = {
				has_title_law = gaelic_elective_succession_law
				has_title_law = imperial_elective_succession_law
				has_title_law = scandinavian_elective_succession_law
				has_title_law = eldership_elective_succession_law
				has_title_law = princely_elective_succession_law
				has_title_law = feudal_elective_succession_law
				has_title_law = outremer_elective_succession_law
				has_title_law = royal_elective_succession_law
				has_title_law = saxon_elective_succession_law
				has_title_law = kurultai_elective_succession_law
			}
		}
	}
	effect = {
		every_held_title = {
			limit = { has_title_law = mahestan_elective_succession_law }
			clear_title_laws = yes
		}
		primary_title = {
			add_title_law = mahestan_elective_succession_law
		}
	}
	ai_will_do = {
		base = 100
	}
}
kurultai_elective_ai = {
	ai_goal = yes
	is_shown = {
	
		AND = { exists = global_var:SE_is_loaded }
		
		is_ai = yes
	}
	is_valid = {
		is_ai = yes
		highest_held_title_tier >= tier_kingdom
		can_change_title_law_trigger = yes
		culture = {
			has_innovation = innovation_kurultai
			has_cultural_pillar = heritage_mongolic
		}
        government_has_flag = government_is_tribal
		NOT = {
			primary_title = {
				has_title_law = kurultai_elective_succession_law
			}
		}
		any_held_title = {
			NOR = {
				has_title_law = gaelic_elective_succession_law
				has_title_law = imperial_elective_succession_law
				has_title_law = scandinavian_elective_succession_law
				has_title_law = eldership_elective_succession_law
				has_title_law = princely_elective_succession_law
				has_title_law = feudal_elective_succession_law
				has_title_law = outremer_elective_succession_law
				has_title_law = royal_elective_succession_law
				has_title_law = saxon_elective_succession_law
				has_title_law = mahestan_elective_succession_law
			}
		}
	}
	effect = {
		every_held_title = {
			limit = { has_title_law = kurultai_elective_succession_law }
			clear_title_laws = yes
		}
		primary_title = {
			add_title_law = kurultai_elective_succession_law
		}
	}
	ai_will_do = {
		base = 100
	}
}
feudal_elective_diet = {
	picture = "gfx/interface/illustrations/decisions/decision_dynasty_house.dds"
	major = yes
	ai_goal = yes
	is_shown = {
		#Not really needed for my mod when Bavaria is already given to the son as a Kingdom title
		#character:90107 = {
		#	is_alive = no
		#}
		primary_title = {
			OR = {
				this = title:k_bavaria
				this = title:k_east_francia
				this = title:k_lotharingia
				this = title:k_frisia
				this = title:k_france
				this = title:k_aquitaine
				this = title:k_alemania		   
			}
		}
		NOT = {
			#Not needed for my mod
			#AND = {
			#	title:k_bavaria.holder = title:k_east_francia.holder
			#	character:90107 = {
			#		any_child = {
			#			OR = {
			#				this = title:k_bavaria.holder
			#				this = title:k_east_francia.holder
			#			}
			#		}
			#	}
			#}
			primary_title = {
				has_title_law = feudal_elective_succession_law
			}
		}
		OR = {
			has_game_rule = all_succexp_his_events
			AND = {
				has_game_rule = ai_succexp_his_events
				is_ai = yes
			}
		}
		
		game_start_date >= 867.1.1
		AND = { exists = global_var:SE_is_loaded }
			
	}
	is_valid = {
		custom_description = {
			any_vassal = {
				is_powerful_vassal_of = root
				opinion = {
					target = root
					value < 0
				}
			}
			text = powerfull_vassl_has_neg_opin_loc
		}
		can_change_title_law_trigger = yes
		custom_description = {
			any_held_title = {
				NOR = {
					has_title_law = gaelic_elective_succession_law
					has_title_law = imperial_elective_succession_law
					has_title_law = scandinavian_elective_succession_law
					has_title_law = eldership_elective_succession_law
					has_title_law = princely_elective_succession_law
					has_title_law = feudal_elective_succession_law
					has_title_law = outremer_elective_succession_law
					has_title_law = mahestan_elective_succession_law
					has_title_law = royal_elective_succession_law
					has_title_law = kurultai_elective_succession_law
				}
			}
			text = no_special_succ_loc
		}
	}
	cost = {
		prestige = 1000
	}
	effect = {
		primary_title = {
			add_title_law = feudal_elective_succession_law
		}
		every_vassal = {
			limit = {
				is_powerful_vassal_of = root
			}
			add_opinion = {
				target = root
				modifier = favorable_succession
				opinion = 30
			}
		}
	}
	ai_will_do = {
		base = 100
	}
}