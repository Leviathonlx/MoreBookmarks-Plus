#00_major_decisions_scripted_effects

form_switzerland_scripted_effect = {
	save_scope_as = scoped_ruler
	title:e_hre.holder = { save_scope_as = scoped_emperor }
	title:d_savoie = { save_scope_as = savoy }
	title:k_switzerland = { save_scope_as = switzerland }
	#De jure shifts.
	title:c_como = { set_de_jure_liege_title = title:d_currezia }
	title:d_currezia = { set_de_jure_liege_title = title:k_switzerland }
	title:c_aosta = { set_de_jure_liege_title = title:d_transjurania }
	title:c_geneva = { set_de_jure_liege_title = title:d_transjurania }
	title:d_transjurania = { set_de_jure_liege_title = title:k_switzerland }
	if = {
		limit = { is_independent_ruler = no }
		title:k_switzerland = { set_de_jure_liege_title = root.top_liege.primary_title }
	}
	else_if = {
		limit = { title:e_hre = { any_in_de_jure_hierarchy = { tier = tier_kingdom } } }
		title:k_switzerland = { set_de_jure_liege_title = title:e_hre }
	}
	else_if = {
		limit = { title:e_germany = { any_in_de_jure_hierarchy = { tier = tier_kingdom } } }
		title:k_switzerland = { set_de_jure_liege_title = title:e_germany }
	}
	else_if = { custom_tooltip = form_switzerland_kingdom_decision_effect_tooltip }
	create_title_and_vassal_change = {
		type = created
		save_scope_as = change
		add_claim_on_loss = no
	}
	title:k_switzerland = {
		change_title_holder = {
			holder = root
			change = scope:change
		}
	}
	resolve_title_and_vassal_change = scope:change
	hidden_effect = { set_primary_title_to = title:k_switzerland }
	add_prestige = major_prestige_gain
	if = {
		limit = {
			OR = {
				has_realm_law = crown_authority_0
				has_realm_law = crown_authority_1
				has_realm_law = crown_authority_2
			}
		}
		add_realm_law_skip_effects = crown_authority_3
	}
}

promote_hungarian_settlement_decision_scripted_effect = {
	if = {
		limit = { is_ai = yes }
		set_character_faith_with_conversion = faith:catholic
		hidden_effect = {
			every_close_family_member = {
				set_character_faith_with_conversion = faith:catholic
			}
		}
	}
	hidden_effect = {
		title:d_nyitra = { set_de_jure_liege_title = title:k_hungary }
		if = {
			limit = { exists = title:k_moravia.holder }
			destroy_title = title:k_moravia
		}
	}
	if = {
		limit = {
			culture = culture:mogyer
		}

		# Convert my culture to Hungarian Culture
		set_culture = culture:hungarian
		culture:hungarian = {
			reset_culture_creation_date = yes
			get_all_innovations_from = culture:mogyer
		}

		# Convert my courtiers to Hungarian 
		hidden_effect = {
			every_courtier = {
				limit = { culture = culture:mogyer }
				set_culture = culture:hungarian
			}
			every_close_family_member = {
				set_culture = culture:hungarian
			}
		}
	}

	# Convert my vassals to Hungarian
	every_vassal_or_below = {
		limit = {
			primary_title = {
				OR = {
					de_jure_liege = title:k_hungary
					de_jure_liege.de_jure_liege = title:k_hungary
					de_jure_liege.de_jure_liege.de_jure_liege = title:k_hungary
				}
			}
		}

		custom = promote_hungarian_settlement_decision_every_vassal_custom
		set_culture = culture:hungarian

		# Convert their courtiers as well
		hidden_effect = {
			every_close_family_member = {
				set_culture = culture:hungarian
			}
			every_courtier = {
				limit = {
					culture = culture:mogyer
				}
				set_culture = culture:hungarian
			}
			set_character_faith_with_conversion = faith:catholic
			every_close_family_member = {
				set_character_faith_with_conversion = faith:catholic
			}
		}
	}
	hidden_effect = {
		#Flip Counties
		every_county_in_region = {
			region = west_hungary_areas
			random = {
				chance = 60
				set_county_culture = culture:hungarian
			}
		}

		every_living_character = {
			limit = { 
				is_landed = yes
				OR = {
					has_primary_title = title:d_gyor
					has_primary_title = title:d_somogy
					has_primary_title = title:d_visegrad
					has_primary_title = title:d_bacs
					primary_title = {
						OR = {
							de_jure_liege = title:d_gyor
							de_jure_liege.de_jure_liege = title:d_gyor
							de_jure_liege = title:d_somogy
							de_jure_liege.de_jure_liege = title:d_somogy
							de_jure_liege = title:d_visegrad
							de_jure_liege.de_jure_liege = title:d_visegrad
							de_jure_liege = title:d_bacs
							de_jure_liege.de_jure_liege = title:d_bacs
						}
					}
				}
			}
			set_culture = culture:hungarian 
			if = {
				limit = { any_spouse = { is_landed = no } }
				every_spouse = {
					limit = {
						is_landed = no
					}
					set_culture = culture:hungarian
				}
			}
			every_close_family_member = {
				limit = { is_landed = no }
				custom = all_unlanded_family_members
				set_culture = culture:hungarian
			}
		}

		#Flip Counties
		every_county_in_region = {
			region = slovene_areas
			random = {
				chance = 60
				set_county_culture = culture:slovien
			}
		}

		# Convert my vassals to Hungarian
		every_vassal_or_below = {
			limit = {
				primary_title = {
					OR = {
						de_jure_liege = title:d_nyitra
						de_jure_liege.de_jure_liege = title:d_nyitra
						de_jure_liege = title:d_ungvar
						de_jure_liege.de_jure_liege = title:d_ungvar
					}
				}
			}

			custom = promote_hungarian_settlement_decision_every_vassal_custom
			set_culture = culture:slovien

			# Convert their courtiers as well
			hidden_effect = {
				every_close_family_member = {
					set_culture = culture:slovien
				}
				set_character_faith_with_conversion = faith:catholic
				every_close_family_member = {
					set_character_faith_with_conversion = faith:catholic
				}
			}
		}
	}
	title:k_hungary = {
		every_in_de_jure_hierarchy = {
			custom = promote_hungarian_settlement_decision_every_province_custom
			limit = {
				tier = tier_county
				culture = culture:mogyer
			}
			set_county_culture = culture:hungarian
			add_county_modifier = {
				modifier = hungarian_resettlement_modifier
				years = 100
			}
			custom_tooltip = promote_hungarian_settlement_decision_increased_development
			custom_tooltip = promote_hungarian_settlement_decision_convert_county
			hidden_effect = {
				if = {
					limit = { development_level < 4 }
					change_development_level = 3
				}
				random_list = {
					30 = {
						# Nothing happens
					}
					60 = {
						trigger = {
							NOT = {
								faith = { has_doctrine = special_doctrine_ecumenical_christian }
							}
							any_neighboring_county = {
								faith = { has_doctrine = special_doctrine_ecumenical_christian }
							}
						}
						random_neighboring_county = {
							limit = {
								faith = { has_doctrine = special_doctrine_ecumenical_christian }
							}
							save_scope_as = neighboring_county
						}
						set_county_faith = scope:neighboring_county.faith
					}
				}
			}
		}
	}
}

#revive_magyar_paganism_decision_scripted_effect = {
#	#Change yourself, and any willing vassals/family, over to Magyar Paganism.
#	set_character_faith_with_conversion = faith:magyar_pagan
#	#Gain nickname for your troubles.
#	give_nickname = nick_the_apostate
#	#Magyar_group counties of your old religion may defect back to the old ways.
#	custom_tooltip = revive_magyar_paganism_decision_scripted_effect.county_conversions.tt
#	hidden_effect = {
#		primary_title = {
#									
#			every_in_de_facto_hierarchy = {
#				limit = {
#					tier = tier_county
#					culture = { has_cultural_pillar = heritage_magyar }
#					exists = scope:old_faith
#					religion = scope:old_faith.religion
#				}
#				#Mogyers remember the old ways best, and have a high chance to flip.
#				if = {
#					limit = { culture = culture:mogyer }
#					random = {
#						chance = 70
#						set_county_faith = faith:magyar_pagan
#					}
#				}
#				#Slightly up the chances for the apostate.
#				else_if = {
#					limit = { holder = root }
#					random = {
#						chance = 50
#						set_county_faith = faith:magyar_pagan
#					}
#				}
#				#Other magyar_group cultures still have a moderate chance to flip.
#				else = {
#					random = {
#						chance = 30
#						set_county_faith = faith:magyar_pagan
#					}
#				}
#			}
#		}
#	}
#	#Make flipping counties deliriously happy about the whole affair.
#	primary_title = {
#		every_in_de_facto_hierarchy = {
#			limit = {
#				tier = tier_county
#				faith = faith:magyar_pagan
#			}
#			custom = hungarian_resettlement.every_converted_province
#			add_county_modifier = {
#				modifier = magyar_appreciation_modifier
#				years = 25
#			}
#		}
#	}
#	#Finally, give magyar_pagans a hefty fervour boost, just so that they don't immediately convert back.
#	hidden_effect = {
#		faith:magyar_pagan = {
#			save_temporary_scope_as = magyar_faith
#			change_fervor = {
#				value = 100
#				desc = fervor_gain_magyar_revivalism
#			}
#		}
#	}
#}
#
#restore_dumnonia_decision_scripted_effect = {
#	save_scope_as = founder
#	create_title_and_vassal_change = {
#		type = created
#		save_scope_as = title_change
#		add_claim_on_loss = no
#	}
#	title:k_cornwall = {
#		change_title_holder = {
#			holder = root
#			change = scope:title_change
#		}
#	}
#	resolve_title_and_vassal_change = scope:title_change
#
#	hidden_effect = {
#		title:d_somerset = { save_scope_as = cornwall_somerset }
#		title:d_gloucester = { save_scope_as = cornwall_gloucester }
#		title:d_cornwall = { set_de_jure_liege_title = title:k_cornwall }
#		if = {	#If owned, annex Somerset/Wessex.
#			limit = {
#				title:d_somerset = { holder = root }
#			}
#			title:d_somerset = { set_de_jure_liege_title = title:k_cornwall }
#		}
#		if = {	#If owned, annex Gloucestershire/Hwicce.
#			limit = {
#				title:d_gloucester = { holder = root }
#			}
#			title:d_gloucester = { set_de_jure_liege_title = title:k_cornwall }
#		}
#	}
#	custom_tooltip = restore_dumnonia_decision_effects_de_jure_tt
#}
#
#revive_armenian_empire_decision_scripted_effect = {
#	save_scope_as = founder
#	create_title_and_vassal_change = {
#		type = created
#		save_scope_as = title_change
#		add_claim_on_loss = no
#	}
#	title:e_armenia = {
#		change_title_holder = {
#			holder = root
#			change = scope:title_change
#		}
#	}
#	resolve_title_and_vassal_change = scope:title_change
#
#	hidden_effect = {
#		title:k_armenia = { save_scope_as = armenian_armenia }
#		title:k_georgia = { save_scope_as = armenian_georgia }
#		title:k_daylam = { save_scope_as = armenian_daylam }
#		title:k_jazira = { save_scope_as = armenian_jazira }
#		title:k_syria = { save_scope_as = armenian_syria }
#		title:k_jerusalem = { save_scope_as = armenian_jerusalem }
#		title:k_anatolia = { save_scope_as = armenian_anatolia }
#		title:k_pontus = { save_scope_as = armenian_pontus }
#		title:e_armenia = { save_scope_as = armenian_armenia_empire }
#		title:k_armenia = { set_de_jure_liege_title = title:e_armenia }
#		if = {
#			limit = {
#				title:k_armenia = { is_title_created = yes }
#			}
#			create_title_and_vassal_change = {
#				type = usurped
#				save_scope_as = title_change_2
#				add_claim_on_loss = no
#			}
#			title:k_armenia = {
#				change_title_holder = {
#					holder = root
#					change = scope:title_change_2
#				}
#			}
#			resolve_title_and_vassal_change = scope:title_change_2
#		}
#		else_if = {
#			limit = {
#				title:k_armenia = { is_title_created = no }
#			}
#			create_title_and_vassal_change = {
#				type = created
#				save_scope_as = title_change_2
#				add_claim_on_loss = no
#			}
#			title:k_armenia = {
#				change_title_holder = {
#					holder = root
#					change = scope:title_change_2
#				}
#			}
#			resolve_title_and_vassal_change = scope:title_change_2
#		}
#		if = {	#If any have drifted out, then k_armenia's constituent duchies are flipped back.
#			limit = {
#				title:d_greater_armenia = {
#					NOT = { target_is_de_jure_liege_or_above = title:k_armenia }
#				}
#			}
#			title:d_greater_armenia = { set_de_jure_liege_title = title:k_armenia }
#		}
#		if = {	#If any have drifted out, then k_armenia's constituent duchies are flipped back.
#			limit = {
#				title:d_vaspurakan = {
#					NOT = { target_is_de_jure_liege_or_above = title:k_armenia }
#				}
#			}
#			title:d_vaspurakan = { set_de_jure_liege_title = title:k_armenia }
#		}
#		if = {	#If any have drifted out, then k_armenia's constituent duchies are flipped back.
#			limit = {
#				title:d_mesopotamia = {
#					NOT = { target_is_de_jure_liege_or_above = title:k_armenia }
#				}
#			}
#			title:d_mesopotamia = { set_de_jure_liege_title = title:k_armenia }
#		}
#		if = {	#If owned & de jure has not drifted, annex Daylam & exempt Azerbaijan from de jure flipping to Armenia.
#			limit = {
#				title:k_daylam = { holder = root  }
#				title:d_azerbaijan = {	target_is_de_jure_liege_or_above = title:k_daylam }
#			}
#			title:k_daylam = { set_de_jure_liege_title = title:e_armenia }
#		}
#		else_if = {	#If owned & de jure has drifted, annex Daylam & flip Azerbaijan to Armenia.
#			limit = {
#				title:k_daylam = { holder = root  }
#				NOT = {
#					title:d_azerbaijan = {	target_is_de_jure_liege_or_above = title:k_daylam }
#				}
#			}
#			title:k_daylam = { set_de_jure_liege_title = title:e_armenia }
#			title:d_azerbaijan = { set_de_jure_liege_title = title:k_armenia }
#		}
#		else = {
#			title:d_azerbaijan = { set_de_jure_liege_title = title:k_armenia }
#		}
#		if = {	#If owned & de jure has not drifted, annex Daylam & exempt Shirvan from de jure flipping to Armenia.
#			limit = {
#				title:k_daylam = { holder = root  }
#				title:d_shirvan = {	target_is_de_jure_liege_or_above = title:k_daylam }
#			}
#			title:k_daylam = { set_de_jure_liege_title = title:e_armenia }
#		}
#		else_if = {	#If owned & de jure has drifted, annex Daylam & flip Shirvan to Armenia.
#			limit = {
#				title:k_daylam = { holder = root  }
#				NOT = {
#					title:d_shirvan = {	target_is_de_jure_liege_or_above = title:k_daylam }
#				}
#			}
#			title:k_daylam = { set_de_jure_liege_title = title:e_armenia }
#			title:d_shirvan = { set_de_jure_liege_title = title:k_armenia }
#		}
#		else = {
#			title:d_shirvan = { set_de_jure_liege_title = title:k_armenia }
#		}
#		if = {	#If owned & de jure has not drifted, annex Georgia & exempt ducal Georgia from de jure flipping to Armenia.
#			limit = {
#				title:k_georgia = { holder = root  }
#				title:d_georgia = {	target_is_de_jure_liege_or_above = title:k_georgia }
#			}
#			title:k_georgia = { set_de_jure_liege_title = title:e_armenia }
#		}
#		else_if = {	#If owned & de jure has drifted, annex Georgia & flip ducal Georgia to Armenia.
#			limit = {
#				title:k_georgia = { holder = root  }
#				NOT = {
#					title:d_georgia = {	target_is_de_jure_liege_or_above = title:k_georgia }
#				}
#			}
#			title:k_georgia = { set_de_jure_liege_title = title:e_armenia }
#			title:d_georgia = { set_de_jure_liege_title = title:k_armenia }
#		}
#		else = {
#			title:d_georgia = { set_de_jure_liege_title = title:k_armenia }
#		}
#		if = {	#If owned & de jure has not drifted, annex Anatolia & exempt Cilicia from de jure flipping to Armenia.
#			limit = {
#				title:k_anatolia = { holder = root  }
#				title:d_cilicia = {	target_is_de_jure_liege_or_above = title:k_anatolia }
#			}
#			title:k_anatolia = { set_de_jure_liege_title = title:e_armenia }
#		}
#		else_if = {	#If owned & de jure has drifted, annex Anatolia & flip Cilicia to Armenia.
#			limit = {
#				title:k_anatolia = { holder = root  }
#				NOT = {
#					title:d_cilicia = {	target_is_de_jure_liege_or_above = title:k_anatolia }
#				}
#			}
#			title:k_anatolia = { set_de_jure_liege_title = title:e_armenia }
#			title:d_cilicia = { set_de_jure_liege_title = title:k_armenia }
#		}
#		else = {
#			title:d_cilicia = { set_de_jure_liege_title = title:k_armenia }
#		}
#		if = {	#If owned & de jure has not drifted, annex Jazira & exempt Diyarbakr from de jure flipping to Armenia.
#			limit = {
#				title:k_jazira = { holder = root  }
#				title:d_diyarbakr = {	target_is_de_jure_liege_or_above = title:k_jazira }
#			}
#			title:k_jazira = { set_de_jure_liege_title = title:e_armenia }
#		}
#		else_if = {	#If owned & de jure has drifted, annex Jazira & flip Diyarbakr to Armenia.
#			limit = {
#				title:k_jazira = { holder = root  }
#				NOT = {
#					title:d_diyarbakr = {	target_is_de_jure_liege_or_above = title:k_jazira }
#				}
#			}
#			title:k_jazira = { set_de_jure_liege_title = title:e_armenia }
#			title:d_diyarbakr = { set_de_jure_liege_title = title:k_armenia }
#		}
#		else = {
#			title:d_diyarbakr = { set_de_jure_liege_title = title:k_armenia }
#		}
#		if = {	#If owned & de jure has not drifted, annex Syria & exempt Edessa from de jure flipping to Armenia.
#			limit = {
#				title:k_syria = { holder = root  }
#				title:d_edessa = {	target_is_de_jure_liege_or_above = title:k_syria }
#			}
#			title:k_syria = { set_de_jure_liege_title = title:e_armenia }
#		}
#		else_if = {	#If owned & de jure has drifted, annex Syria & flip Edessa to Armenia.
#			limit = {
#				title:k_syria = { holder = root  }
#				NOT = {
#					title:d_edessa = {	target_is_de_jure_liege_or_above = title:k_syria }
#				}
#			}
#			title:k_syria = { set_de_jure_liege_title = title:e_armenia }
#			title:d_edessa = { set_de_jure_liege_title = title:k_armenia }
#		}
#		else = {
#			title:d_edessa = { set_de_jure_liege_title = title:k_armenia }
#		}
#		if = {	#If owned & de jure has not drifted, annex Syria & exempt Antioch from de jure flipping to Armenia.
#			limit = {
#				title:k_syria = { holder = root  }
#				title:d_antioch = {	target_is_de_jure_liege_or_above = title:k_syria }
#			}
#			title:k_syria = { set_de_jure_liege_title = title:e_armenia }
#		}
#		else_if = {	#If owned & de jure has drifted, annex Syria & flip Antioch to Armenia.
#			limit = {
#				title:k_syria = { holder = root  }
#				NOT = {
#					title:d_antioch = {	target_is_de_jure_liege_or_above = title:k_syria }
#				}
#			}
#			title:k_syria = { set_de_jure_liege_title = title:e_armenia }
#			title:d_antioch = { set_de_jure_liege_title = title:k_armenia }
#		}
#		else = {
#			title:d_antioch = { set_de_jure_liege_title = title:k_armenia }
#		}
#		if = {	#If owned & Kurdistan is already part of Jazira, annex Jazira & exempt Kurdistan from de jure flipping to Armenia.
#			limit = {
#				title:k_jazira = { holder = root  }
#				title:d_kurdistan = { target_is_de_jure_liege_or_above = title:k_jazira }
#			}
#			title:k_jazira = { set_de_jure_liege_title = title:e_armenia }
#		}
#		else_if = {	#If owned & Kurdistan is not part of Jazira, but Jazira is owned entirely, annex Jazira & flip Kurdistan to Jazira, because bordergore.
#			limit = {
#				title:k_jazira = { holder = root  }
#				NOT = {
#					title:d_kurdistan = { target_is_de_jure_liege_or_above = title:k_jazira }
#				}
#			}
#			title:k_jazira = { set_de_jure_liege_title = title:e_armenia }
#			title:d_kurdistan = { set_de_jure_liege_title = title:k_jazira }
#		}
#		else = {
#			title:d_kurdistan = { set_de_jure_liege_title = title:k_armenia }
#		}
#		if = {	#If owned, annex Pontus.
#			limit = {
#				title:k_pontus = { holder = root  }
#			}
#			title:k_pontus = { set_de_jure_liege_title = title:e_armenia }
#		}
#		if = {	#If owned, annex Jerusalem.
#			limit = {
#				title:k_jerusalem = { holder = root  }
#			}
#			title:k_jerusalem = { set_de_jure_liege_title = title:e_armenia }
#		}
#	}
#	custom_tooltip = create_armenian_empire_decision_effects_de_jure_tt_a
#	custom_tooltip = create_armenian_empire_decision_effects_de_jure_tt_b
#}

#This effect gives errors that make no sense in the error log and works perfectly fine
restore_holy_roman_empire_decision_scripted_effect = {
	save_scope_as = founder
	hidden_effect = {
		scope:founder = {
			set_culture = culture:franconian 
			if = {
				limit = { any_spouse = { is_landed = no } }
				every_spouse = {
					limit = {
						is_landed = no
					}
					set_culture = culture:franconian
					set_character_faith_with_conversion = root.faith
				}
			}
			every_close_family_member = {
				limit = {
					NOT = { is_spouse_of = root }
				}
				custom = all_unlanded_family_members
				set_culture = culture:franconian
				set_character_faith_with_conversion = root.faith
			}
		}
	}
	create_title_and_vassal_change = {
		type = created
		save_scope_as = title_change
		add_claim_on_loss = no
	}
	title:e_hre = {
		change_title_holder = {
			holder = root
			change = scope:title_change
		}
	}
	resolve_title_and_vassal_change = scope:title_change
	hidden_effect = { set_primary_title_to = title:e_hre }
	every_held_title = { #Should destroy all other Empires owned at the time.
		limit = {
			tier = tier_empire
			NOT = { this = title:e_hre }
		}
		root = { destroy_title = prev }
	}

	#Papal hook management.
	if = {
		limit = {
			faith.religious_head = {
				exists = this
				opinion = {
					target = root
					value < high_positive_opinion
				}
			}
			OR = {
				has_weak_hook = faith.religious_head
				has_strong_usable_hook = faith.religious_head
			}
		}
		use_hook = faith.religious_head
	}

	every_held_title = { #Should destroy all other Empires owned at the time.
		limit = {
			tier = tier_empire
			NOT = { this = title:e_hre }
		}
		root = { destroy_title = prev }
	}
	destroy_title = title:k_east_francia	#Make Germany inalienable.
	#Don't really want the Emperor holding any Kingdom titles in general
	destroy_title = title:k_bavaria
	destroy_title = title:k_lotharingia
	destroy_title = title:k_bohemia
	#Sort title laws.
	title:e_hre = {
		add_title_law = princely_elective_succession_law
		if = {	#Add Salic law.
			limit = {
				root = {
					OR = {
						has_realm_law = male_preference_law
						has_realm_law = male_only_law
					}
				}
			}
			add_title_law = male_only_law
		}
		if = {	#Ignore Salic law.
			limit = {
				root = { has_realm_law = equal_law }
			}
			add_title_law = equal_law
		}
		if = {	#Invert Salic law. Take that, Clovis, y'big nerd.
			limit = {
				root = {
					OR = {
						has_realm_law = female_preference_law
						has_realm_law = female_only_law
					}
				}
			}
			add_title_law = female_only_law
		}
		custom_tooltip = hre_elector_list_creation_tt
	}

	#Add de jures.
	hidden_effect = {
		title:e_germany = {
			every_in_de_jure_hierarchy = {
				limit = { tier = tier_kingdom }
				set_de_jure_liege_title = title:e_hre
			}
		}
		title:k_france = { set_title_name = k_france }
		title:k_east_francia = { set_title_name = k_germany }
		title:d_meissen = { set_de_jure_liege_title = title:k_east_francia }
		title:d_lausitz = { set_de_jure_liege_title = title:k_east_francia }
		title:k_lotharingia = { set_de_jure_liege_title = title:e_hre }
		title:k_bavaria = { set_de_jure_liege_title = title:e_hre }
		title:k_bohemia = { set_de_jure_liege_title = title:e_hre }
		destroy_title = title:k_moravia
		destroy_title = title:k_sorbia

		title:d_moravia = { set_de_jure_liege_title = title:k_bohemia }
		#Flip Counties
		every_county_in_region = {
			region = czech_areas
			random = {
				chance = 80
				set_county_culture = culture:czech
			}
		}
		every_living_character = {
			limit = { 
				is_landed = yes
				OR = {
					has_primary_title = title:k_bohemia
					has_primary_title = title:d_bohemia
					has_primary_title = title:d_moravia
					primary_title = {
						OR = {
							de_jure_liege = title:d_bohemia
							de_jure_liege.de_jure_liege = title:d_bohemia
							de_jure_liege = title:d_moravia
							de_jure_liege.de_jure_liege = title:d_moravia
						}
					}
				}
			}
			set_culture = culture:czech 
			if = {
				limit = { any_spouse = { is_landed = no } }
				every_spouse = {
					limit = {
						is_landed = no
					}
					set_culture = culture:czech
				}
			}
			every_close_family_member = {
				limit = {
					NOT = { is_spouse_of = root }
				}
				custom = all_unlanded_family_members
				set_culture = culture:czech
			}
		}

		every_held_title = {
			limit = {
				tier = tier_kingdom
				NOT = {	#The Pope retains vague dibs on Italy.
					any_this_title_or_de_jure_above = { this = title:e_italy }
				}
				save_temporary_scope_as = this_title
				root = { completely_controls = scope:this_title }
			}
			set_de_jure_liege_title = title:e_hre
		}
	}
	custom_tooltip = restore_holy_roman_empire_decision_effects_de_jure.tt

	#And add a bit of prestige for the trouble.
	add_prestige = massive_prestige_value
}

found_kingdom_of_bosnia_decision_scripted_effect = {
	create_title_and_vassal_change = {
		type = created
		save_scope_as = title_change
		add_claim_on_loss = no
	}
	title:k_bosnia = {
		change_title_holder = {
			holder = scope:founder
			change = scope:title_change
		}
	}
	resolve_title_and_vassal_change = scope:title_change

	title:d_bosna = { set_de_jure_liege_title = title:k_bosnia }
	title:d_usora = { set_de_jure_liege_title = title:k_bosnia }
}

found_kingdom_of_livonia_decision_scripted_effect = {
	create_title_and_vassal_change = {
		type = created
		save_scope_as = title_change
		add_claim_on_loss = no
	}
	title:k_livonia = {
		change_title_holder = {
			holder = scope:founder
			change = scope:title_change
		}
	}
	resolve_title_and_vassal_change = scope:title_change

	title:d_latgalians = { set_de_jure_liege_title = title:k_livonia }
	title:d_courland = { set_de_jure_liege_title = title:k_livonia }
	title:d_livonia = { set_de_jure_liege_title = title:k_livonia }
	title:d_zemigalia = { set_de_jure_liege_title = title:k_livonia }
	title:d_lettigale = { set_de_jure_liege_title = title:k_livonia }
	if = {
		limit = {
			title:d_esthonia = { holder = root }
		}
		title:d_esthonia = { set_de_jure_liege_title = title:k_livonia }
	}
	if = {
		limit = {
			has_faith = faith:baltic_pagan
			root.culture = { NOT = { has_innovation = innovation_longboats } }
		}
		root.culture = { add_innovation = innovation_longboats }
	}
}

sicilian_parliament_kingdom_split_scripted_effect = { #If the decision is taken when the ruler doesn't hold the entirety of k_sicily, it results in the Naples/Trinacria split. (this is the ruler)
	root = {
		destroy_title = title:k_sicily
	}
	title:d_sicily = {
		set_de_jure_liege_title = title:k_trinacria
	}
	title:d_benevento = {
		set_de_jure_liege_title = title:k_naples
	}
	title:d_capua = {
		set_de_jure_liege_title = title:k_naples
	}
	title:d_apulia = {
		set_de_jure_liege_title = title:k_naples
	}
	title:d_salerno = {
		set_de_jure_liege_title = title:k_naples
	}
	title:d_calabria = {
		set_de_jure_liege_title = title:k_naples
	}
	#MB
	title:d_calabria = {
		set_de_jure_liege_title = title:d_tarent
	}
	title:d_calabria = {
		set_de_jure_liege_title = title:d_bari
	}
	title:d_calabria = {
		set_de_jure_liege_title = title:d_venosa
	}
	title:d_calabria = {
		set_de_jure_liege_title = title:d_atri
	}
	title:d_gaeta = {
		set_de_jure_liege_title = title:k_naples
	}
	title:d_napoli = {
		set_de_jure_liege_title = title:k_naples
	}
}

# Unify Italy
modified_unify_italy_decision_scripted_effect = {
	save_scope_as = founder
	
	capital_county = {
		save_scope_as = capital_county_effect
	}
	
	create_title_and_vassal_change = {
		type = created
		save_scope_as = title_change
		add_claim_on_loss = no
	}
	
	title:e_italy = {
		change_title_holder = {
			holder = root
			change = scope:title_change
		}
	}
	
	resolve_title_and_vassal_change = scope:title_change
	
	# Prestige
	add_prestige = 750
	
	# Also gain a large amount of dynasty prestige.
	dynasty = { add_dynasty_prestige = 500 }
	
	# Add Nickname
	set_nickname_effect = { NICKNAME = nick_the_great }
	
	if = {
		limit = {
			exists = title:e_hre.holder
		}
		title:e_hre.holder = {
			add_opinion = {
				target = root
				modifier = de_imperial_pretender_opinions
			}
		}
	}
	
	if = {
		limit = {
			exists = title:e_byzantium.holder
		}
		title:e_byzantium.holder = {
			add_opinion = {
				target = root
				modifier = de_imperial_pretender_opinions
			}
		}
	}
	
	# Gain Next Level of Crown Authority
	root = {
		if = {
			limit = {
				has_realm_law = crown_authority_0
			}
			add_realm_law_skip_effects = crown_authority_1
		}
		else_if = {
			limit = {
				has_realm_law = crown_authority_1
			}
			add_realm_law_skip_effects = crown_authority_2
		}
		else_if = {
			limit = {
				has_realm_law = crown_authority_2
			}
			add_realm_law_skip_effects = crown_authority_3
		}
	}

	#Sort title laws.
	# title:e_italy = {
	# 	if = {	#Add Salic law.
	# 		limit = {
	# 			root = {
	# 				OR = {
	# 					has_realm_law = male_preference_law
	# 					has_realm_law = male_only_law
	# 				}
	# 			}
	# 		}
	# 		add_title_law = male_only_law
	# 	}
	# 	if = {	#Ignore Salic law.
	# 		limit = {
	# 			root = { has_realm_law = equal_law }
	# 		}
	# 		add_title_law = equal_law
	# 	}
	# 	if = {	#Invert Salic law. Take that, Clovis, y'big nerd.
	# 		limit = {
	# 			root = {
	# 				OR = {
	# 					has_realm_law = female_preference_law
	# 					has_realm_law = female_only_law
	# 				}
	# 			}
	# 		}
	# 		add_title_law = female_only_law
	# 	}
	# }

	hidden_effect = {
		title:d_istria = { # Bite Croatia.
			set_de_jure_liege_title = title:k_italy
		}
		title:d_krain = {
			set_de_jure_liege_title = title:k_italy
		}
		title:d_tyrol = {
			set_de_jure_liege_title = title:k_italy
		}
		title:d_carinthia = {
			set_de_jure_liege_title = title:k_italy
		}
		title:k_sicily = { # Then shift all Kingdoms.
			set_de_jure_liege_title = title:e_italy
		}
		title:k_romagna = {
			set_de_jure_liege_title = title:e_italy
		}
		title:k_sardinia = {
			set_de_jure_liege_title = title:e_italy
		}
		title:k_italy = {
			set_de_jure_liege_title = title:e_italy
		}
		title:k_venice = {
			set_de_jure_liege_title = title:e_italy
		}
		title:k_croatia = {
			set_de_jure_liege_title = title:e_italy
		}
		title:k_serbia = {
			set_de_jure_liege_title = title:e_italy
		}
	}
	
}
